"use strict";(Object("undefined"!=typeof self?self:this).webpackChunkApp=Object("undefined"!=typeof self?self:this).webpackChunkApp||[]).push([[114],{852:(e,t,i)=>{i.d(t,{k:()=>r});class r{constructor(){this.baseUrl="",this.timeout=1e4,this.defaultHeaders={}}setBaseUrl(e){this.baseUrl=e}setTimeout(e){this.timeout=e}setDefaultHeaders(e){this.defaultHeaders={...this.defaultHeaders,...e}}setHeader(e,t){this.defaultHeaders[e]=t}async request(e,t,i=null,r={}){const s=t.startsWith("http")?t:this.baseUrl+t,n={method:e.toUpperCase(),headers:{...this.defaultHeaders,...r.headers},...r};!i||"POST"!==e.toUpperCase()&&"PUT"!==e.toUpperCase()&&"PATCH"!==e.toUpperCase()||("application/json"===n.headers["Content-Type"]?n.body=JSON.stringify(i):n.body=i);try{const e=new AbortController,t=setTimeout(()=>e.abort(),this.timeout),i=await fetch(s,{...n,signal:e.signal});clearTimeout(t);const r=await i.json().catch(()=>({}));return{status:i.ok,statusCode:i.status,data:r,headers:i.headers}}catch(e){if("AbortError"===e.name)throw new Error("Request timeout");throw e}}async get(e,t={}){return this.request("GET",e,null,t)}async post(e,t=null,i={}){return this.request("POST",e,t,i)}async put(e,t=null,i={}){return this.request("PUT",e,t,i)}async patch(e,t=null,i={}){return this.request("PATCH",e,t,i)}async delete(e,t={}){return this.request("DELETE",e,null,t)}}},3696:(e,t,i)=>{i.d(t,{Ay:()=>r});const r=new class{constructor(e){this.config={level:"info",enabled:!1,console:!0,remote:!1},e&&this.setConfig(e)}setConfig(e){this.config={...this.config,...e}}getConfig(){return this.config}consoleLog(e,...t){if(this.config.console&&this.config.enabled)return console[e].apply(console,t)}log(...e){return this.consoleLog("log",...e)}warn(...e){return this.consoleLog("warn",...e)}error(...e){return this.consoleLog("error",...e)}info(...e){return this.consoleLog("info",...e)}debug(...e){return this.consoleLog("debug",...e)}}({level:"info",enabled:!0,console:!0,remote:!1})},3994:(e,t,i)=>{i.d(t,{S:()=>ee});const r={"meta:title":[{tag:"title",selector:"title",attribute:"@content",attrs:{}},{tag:"meta",selector:"meta[name='title']",attribute:"content",attrs:{name:"title"}}],"meta:description":[{tag:"meta",selector:"meta[name='description']",attribute:"content",attrs:{name:"description"}}],"meta:keywords":[{tag:"meta",selector:"meta[name='keywords']",attribute:"content",attrs:{name:"keywords"}}],"link:meta:canonical":[{tag:"link",selector:"link[rel='canonical']",attribute:"href",attrs:{rel:"canonical"}}],"meta:robots":[{tag:"meta",selector:"meta[name='robots']",attribute:"content",attrs:{name:"robots"}}],"meta:author":[{tag:"meta",selector:"meta[name='author']",attribute:"content",attrs:{name:"author"}}],"meta:image":[{tag:"meta",selector:"meta[name='image']",attribute:"content",attrs:{name:"image"}}],"meta:og:image":[{tag:"meta",selector:"meta[property='og:image']",attribute:"content",attrs:{property:"og:image"}}],"meta:og:title":[{tag:"meta",selector:"meta[property='og:title']",attribute:"content",attrs:{property:"og:title"}}],"meta:og:description":[{tag:"meta",selector:"meta[property='og:description']",attribute:"content",attrs:{property:"og:description"}}],"meta:og:type":[{tag:"meta",selector:"meta[property='og:type']",attribute:"content",attrs:{property:"og:type"}}],"meta:og:url":[{tag:"meta",selector:"meta[property='og:url']",attribute:"content",attrs:{property:"og:url"}}],"meta:og:site_name":[{tag:"meta",selector:"meta[property='og:site_name']",attribute:"content",attrs:{property:"og:site_name"}}],"meta:og:locale":[{tag:"meta",selector:"meta[property='og:locale']",attribute:"content",attrs:{property:"og:locale"}}],"meta:article:published_time":[{tag:"meta",selector:"meta[property='article:published_time']",attribute:"content",attrs:{property:"article:published_time"}}],"meta:article:modified_time":[{tag:"meta",selector:"meta[property='article:modified_time']",attribute:"content",attrs:{property:"article:modified_time"}}],"meta:article:section":[{tag:"meta",selector:"meta[property='article:section']",attribute:"content",attrs:{property:"article:section"}}],"meta:article:tag":[{tag:"meta",selector:"meta[property='article:tag']",attribute:"content",attrs:{property:"article:tag"}}],"meta:article:author":[{tag:"meta",selector:"meta[property='article:author']",attribute:"content",attrs:{property:"article:author"}}],"meta:article:publisher":[{tag:"meta",selector:"meta[property='article:publisher']",attribute:"content",attrs:{property:"article:publisher"}}],"meta:article:image":[{tag:"meta",selector:"meta[property='article:image']",attribute:"content",attrs:{property:"article:image"}}],"meta:og:image:width":[{tag:"meta",selector:"meta[property='og:image:width']",attribute:"content",attrs:{property:"og:image:width"}}],"meta:og:image:height":[{tag:"meta",selector:"meta[property='og:image:height']",attribute:"content",attrs:{property:"og:image:height"}}],"meta:twitter:card":[{tag:"meta",selector:"meta[name='twitter:card']",attribute:"content",attrs:{name:"twitter:card"}}],"meta:twitter:label1":[{tag:"meta",selector:"meta[name='twitter:label1']",attribute:"content",attrs:{name:"twitter:label1"}}],"meta:twitter:label2":[{tag:"meta",selector:"meta[name='twitter:label2']",attribute:"content",attrs:{name:"twitter:label2"}}],"twitter:data1":[{tag:"meta",selector:"meta[name='twitter:data1']",attribute:"content",attrs:{name:"twitter:data1"}}],"twitter:data2":[{tag:"meta",selector:"meta[name='twitter:data2']",attribute:"content",attrs:{name:"twitter:data2"}}],"link:rel:shortlink":[{tag:"meta",selector:"meta[name='rel:shortlink']",attribute:"content",attrs:{rel:"shortlink"}}],"link:rel:alternate":[{tag:"meta",selector:"meta[name='rel:alternate']",attribute:"content",attrs:{rel:"alternate"}}]};var s=i(7983),n=i(2244),a=i(598),o=i(4117),l=i(1621),h=i(1900),c=i(5430),u=i(3606),d=i(839),p=i(6263),g=i(5952),f=i(1730),_=i(8426),m=i(9566),w=i(2796),E=i(8107),y=i(6891),S=i(7187),b=i(8600),A=i(568),v=i(4179),V=i(3639),C=i(2647),T=i(6618),I=i(76),D=i(1317),R=i(6265),$=i(1438),N=i(8448),O=i(9667),U=i(7615),P=i(7536),k=i(2383),L=i(5691),x=i(7065),M=i(4645),W=i(4465),j=i(6896),H=i(6650);const K={"web.test-viewtype-component":s.P,"web.test-wrapper":n.u,"web.test-viewtype":a.y,"web.await":o.T,"web.user-detail":l.H,"web.test-viewtype-layout":h.m,"web.about":c.E,"web.simple-home":u.q,"web.users":d.j,"web.fetch":p.J,"web.test-viewtype-template":g.q,"web.test-subscribe-state":f.S,"web.test-about":_.c,"web.test-prerender":m.i,"web.home":w._,"web.contact":E.b,"web.test-fetch":y.L,"web.test":S.j,"admin.dashboard":b.i,"layouts.test-layout":A.G,"layouts.base":v.J,"layouts.base-with-view-id":V.r,"layouts.admin":C.l,"partials.test-partial":T.G,"partials.footer":I.w,"partials.data-example":D.z,"custom.test-setup":R.z,"custom.test":$.I,"base.html-document":N.I,"test.test-updateStateByKey":O.Z,"test.test-subscribe-new-approach":U.R,"test.compiler-test":P.s,"test.test-simple-usestate":k.R,"test.test-subscribe-array-state":L.b,"test.test-onyield-fixed":x.z,"test.test-updateStateByKey2":M.t,"templates.ga-js":W.$,"templates.simple":j.G,"templates.test":H.a};var B=i(499),F=i(4476),G=i(5276),Y=i(7611),q=i(3696),Q=i(6143);class z{static instance=null;static privateProperties=["__key","__isSupport","__data","__listeners","__eventQueue","__isUpdating","instance","set","get","remove","clear","getAll","has","getAllKeys","size","isEmpty","getInfo","debug","export","import","backup","restore","getStorageUsage","isStorageFull","setKey","getKey","support","__loadData","__updateData","emit","on","off","removeAllListeners","getEvents","getListenerCount","getTTLInfo","cleanExpired","enableEncryption","__generateEncryptionKey","__encrypt","__decrypt","__isExpired","__cleanExpiredData","__createDynamicProperty","__removeDynamicProperty"];dynamicProperties=[];constructor(e="onejs_storage"){this.__key=e||"onejs_storage",this.__isSupport="undefined"!=typeof Storage,this.__data={},this.__listeners=new Map,this.__eventQueue=[],this.__isUpdating=!1,this.encryptionKey=null,this.useEncryption=!1,this.__isSupport&&this.__loadData()}static getInstance(e){return z.instance||(z.instance=new z(e)),z.instance}setKey(e){if("string"!=typeof e||!e.trim())throw new Error("Storage key must be a non-empty string");return this.__key=e,this.__loadData(),this}getKey(){return this.__key}support(){return this.__isSupport}enableEncryption(e=!0,t=null){this.useEncryption=e,this.encryptionKey=e&&!t?this.__generateEncryptionKey():e&&t?t:null,q.Ay.log("ðŸ”§ StorageService: Encryption "+(e?"enabled":"disabled"))}set(e,t,i=null){if(!this.__isSupport)return!1;if(null==e)throw new Error("Key cannot be null or undefined");if("object"==typeof e&&null!==e){let t=!0;return Object.keys(e).forEach(r=>{const s=e[r];this.set(r,s,i)||(t=!1)}),t}if("string"!=typeof e&&"number"!=typeof e)throw new Error("Key must be a string when setting single value");if(i&&("number"!=typeof i||i<=0))throw new Error("TTL must be a positive number or null");const r=this.__data[e],s={value:t,timestamp:Date.now()};null!==i&&(s.ttl=1e3*i),this.__data[e]=s;try{return this.__updateData(),q.Ay.log(`ðŸ’¾ StorageService: Set ${e}:`,t,i?`(TTL: ${i}ms)`:"(no TTL)"),this.__createDynamicProperty(e,i),this.emit(`set:${e}`,{key:e,value:t,oldValue:r,ttl:i}),this.emit("set",{key:e,value:t,oldValue:r,ttl:i}),!0}catch(t){throw this.__data[e]=r,t}}get(e,t=null){if(!this.__isSupport)return t;if("string"!=typeof e)throw new Error("Key must be a string");if(void 0===this.__data[e])return t;const i=this.__data[e];return i&&"object"==typeof i&&"value"in i?this.__isExpired(i)?(q.Ay.log(`â° StorageService: Key ${e} has expired, removing...`),this.remove(e),t):(q.Ay.log(`ðŸ“– StorageService: Retrieved ${e}:`,i.value),i.value):(q.Ay.log(`ðŸ“– StorageService: Retrieved ${e}:`,i),i)}remove(e){if(!this.__isSupport)return!1;if("string"!=typeof e)throw new Error("Key must be a string");if(0===Object.keys(this.__data).length||void 0===this.__data[e])return!1;const t=this.__data[e];delete this.__data[e];try{return this.__updateData(),q.Ay.log("ðŸ—‘ï¸ StorageService: Removed",e),this.emit("remove",{key:e,oldValue:t}),this.emit(`remove:${e}`,{key:e,oldValue:t}),this.__removeDynamicProperty(e),!0}catch(i){throw this.__data[e]=t,i}}clear(){const e={...this.__data};if(this.__data={},this.dynamicProperties){for(const e of this.dynamicProperties)this.__removeDynamicProperty(e);this.dynamicProperties=[]}try{this.__updateData(),q.Ay.log("ðŸ§¹ StorageService: Cleared all data"),this.emit("clear",{oldData:e})}catch(t){throw this.__data=e,t}}getAll(){this.__cleanExpiredData();const e={};for(const[t,i]of Object.entries(this.__data))e[t]=i&&"object"==typeof i&&"value"in i?i.value:i;return e}has(e){if("string"!=typeof e)throw new Error("Key must be a string");if(void 0===this.__data[e])return!1;const t=this.__data[e];return!t||"object"!=typeof t||!("value"in t)||!this.__isExpired(t)}getAllKeys(){return this.__cleanExpiredData(),Object.keys(this.__data)}size(){return this.__cleanExpiredData(),Object.keys(this.__data).length}isEmpty(){return 0===this.size()}getInfo(){const e=this.__cleanExpiredData();return{key:this.__key,isSupport:this.__isSupport,size:this.size(),keys:this.getAllKeys(),isEmpty:this.isEmpty(),events:this.getEvents(),totalListeners:Array.from(this.__listeners.values()).reduce((e,t)=>e+t.length,0),isUpdating:this.__isUpdating,useEncryption:this.useEncryption,hasEncryptionKey:!!this.encryptionKey,expiredRemoved:e,dynamicProperties:this.dynamicProperties?this.dynamicProperties.length:0}}debug(){q.Ay.log("ðŸ” StorageService Debug:",this.getInfo()),q.Ay.log("ðŸ“‹ TTL Information:");for(const[e,t]of Object.entries(this.__data))if(t&&"object"==typeof t&&"value"in t){const i=this.__isExpired(t),r=(t.ttl,t.ttl?Math.max(0,t.timestamp+t.ttl-Date.now()):null);q.Ay.log(`  ${e}: ${i?"EXPIRED":"VALID"}${t.ttl?` (TTL: ${t.ttl}ms, Remaining: ${r}ms)`:" (no TTL)"}`)}else q.Ay.log(`  ${e}: LEGACY (no TTL)`);q.Ay.log("ðŸ”§ Dynamic Properties:",this.dynamicProperties||[])}getTTLInfo(e){if("string"!=typeof e)throw new Error("Key must be a string");if(void 0===this.__data[e])return null;const t=this.__data[e];if(t&&"object"==typeof t&&"value"in t){const e=this.__isExpired(t),i=t.ttl?Math.max(0,t.timestamp+t.ttl-Date.now()):null;return{hasTTL:!!t.ttl,ttl:t.ttl,timestamp:t.timestamp,isExpired:e,remaining:i,expiryTime:t.ttl?t.timestamp+t.ttl:null}}return null}cleanExpired(){return this.__cleanExpiredData()}export(){return JSON.stringify(this.getAll(),null,2)}import(e){if("string"!=typeof e)throw new Error("JSON string must be a string");try{const t=JSON.parse(e),i={...this.__data};this.__data={};for(const[e,i]of Object.entries(t))this.__data[e]={value:i,timestamp:Date.now()};return this.__updateData(),q.Ay.log("ðŸ“¥ StorageService: Imported data successfully"),this.emit("import",{oldData:i,newData:t}),!0}catch(e){return q.Ay.error("âŒ StorageService: Failed to import data:",e),!1}}backup(){return{timestamp:Date.now(),key:this.__key,data:{...this.__data}}}restore(e){if(!e||"object"!=typeof e)throw new Error("Backup must be a valid object");if(!e.data)return q.Ay.error("âŒ StorageService: Invalid backup data"),!1;const t={...this.__data};this.__data={...e.data};try{return this.__updateData(),q.Ay.log("ðŸ“¤ StorageService: Restored from backup:",e.timestamp),this.emit("restore",{oldData:t,newData:e.data,backup:e}),!0}catch(e){throw this.__data=t,e}}getStorageUsage(){if(!this.__isSupport)return 0;try{const e=localStorage.getItem(this.__key);return e?new Blob([e]).size:0}catch(e){return q.Ay.error("âŒ StorageService: Failed to get storage usage:",e),0}}isStorageFull(){try{const e="__storage_test__",t="x".repeat(1024);return localStorage.setItem(e,t),localStorage.removeItem(e),!1}catch(e){return!0}}on(e,t){if("string"!=typeof e||!e.trim())throw new Error("Event name must be a non-empty string");if("function"!=typeof t)throw new Error("Callback must be a function");return this.__listeners.has(e)||this.__listeners.set(e,[]),this.__listeners.get(e).push(t),q.Ay.log(`ðŸŽ§ StorageService: Added listener for event: ${e}`),()=>this.off(e,t)}off(e,t){if(!this.__listeners.has(e))return;const i=this.__listeners.get(e),r=i.indexOf(t);r>-1&&(i.splice(r,1),q.Ay.log(`ðŸŽ§ StorageService: Removed listener for event: ${e}`))}removeAllListeners(e){e?(this.__listeners.delete(e),q.Ay.log(`ðŸŽ§ StorageService: Removed all listeners for event: ${e}`)):(this.__listeners.clear(),q.Ay.log("ðŸŽ§ StorageService: Removed all listeners"))}getEvents(){return Array.from(this.__listeners.keys())}getListenerCount(e){return this.__listeners.has(e)?this.__listeners.get(e).length:0}__generateEncryptionKey(){const e=new Uint8Array(32);return crypto.getRandomValues(e),Array.from(e,e=>e.toString(16).padStart(2,"0")).join("")}__encrypt(e){if(!this.useEncryption||!this.encryptionKey)return e;try{let t="";for(let i=0;i<e.length;i++){const r=e.charCodeAt(i)^this.encryptionKey.charCodeAt(i%this.encryptionKey.length);t+=String.fromCharCode(r)}return btoa(t)}catch(t){return console.error("âŒ StorageService: Encryption failed:",t),e}}__decrypt(e){if(!this.useEncryption||!this.encryptionKey)return e;try{const t=atob(e);let i="";for(let e=0;e<t.length;e++){const r=t.charCodeAt(e)^this.encryptionKey.charCodeAt(e%this.encryptionKey.length);i+=String.fromCharCode(r)}return i}catch(t){return console.error("âŒ StorageService: Decryption failed:",t),e}}__isExpired(e){return!!(e&&e.timestamp&&e.ttl)&&Date.now()>e.timestamp+e.ttl}__cleanExpiredData(){let e=0;const t=[];for(const[e,i]of Object.entries(this.__data))this.__isExpired(i)&&t.push(e);for(const i of t)delete this.__data[i],e++,q.Ay.log(`ðŸ—‘ï¸ StorageService: Removed expired key: ${i}`);return e>0&&this.__updateData(),e}__loadData(){if(this.__isSupport)try{const e=localStorage.getItem(this.__key);if(e){const t=this.__decrypt(e);this.__data=JSON.parse(t),this.__cleanExpiredData()}}catch(e){console.error("âŒ StorageService: Failed to load data:",e),this.__data={}}}__updateData(){if(this.__isSupport&&!this.__isUpdating){this.__isUpdating=!0;try{const e=JSON.stringify(this.__data),t=this.__encrypt(e);localStorage.setItem(this.__key,t),q.Ay.log("ðŸ’¾ StorageService: Updated data for key:",this.__key)}catch(e){throw q.Ay.error("âŒ StorageService: Failed to update data:",e),e}finally{this.__isUpdating=!1}}}emit(e,t){this.__listeners.has(e)&&this.__listeners.get(e).forEach(i=>{try{i(t)}catch(t){console.error(`âŒ StorageService: Error in event listener for ${e}:`,t)}})}__createDynamicProperty(e,t){try{z.privateProperties.includes(e)||this.dynamicProperties.includes(e)||(this.dynamicProperties.push(e),Object.defineProperty(this,e,{set:i=>this.set(e,i,t),get:()=>this.get(e),configurable:!0}))}catch(e){q.Ay.error("âŒ StorageService: Failed to create dynamic property:",e)}}__removeDynamicProperty(e){try{this.dynamicProperties&&this.dynamicProperties.includes(e)&&(delete this[e],this.dynamicProperties=this.dynamicProperties.filter(t=>t!==e))}catch(e){q.Ay.error("âŒ StorageService: Failed to remove dynamic property:",e)}}}z.getInstance("onejs_storage");var J=i(8544);class X{constructor(e){const{instances:t,indexMap:i}=this.parseViewData(e);this.instances=t,this.indexMap=i,this.index=0,this.maxIndex=i.length-1}parseViewData(e){let t=e.instances||{};const i=new Map,r=Object.keys(t);return r.forEach(e=>{i.set(e,t[e])}),{instances:i,indexMap:r}}get(e=null){return null===e&&(e=this.index),this.index=e,this.instances.get(this.indexMap[e])??null}next(){return this.index++,this.get(this.index)}prev(){return this.index--,this.get(this.index)}getById(e){return this.instances.get(e)??null}scan(){let e=this.index;return this.index++,this.get(e)||(this.index--,null)}}class Z{constructor(e){this.views=new Map,this.setViews(e)}setViews(e){"object"==typeof e&&e&&0!==Object.keys(e).length&&Object.keys(e).forEach(t=>{this.views.set(t,new X(e[t]))})}get(e){return this.views.get(e)??null}scan(e){return this.get(e)?.scan()??null}getInstance(e,t){return this.get(e)?.getById(t)??null}}class ee{constructor(e=null){this.App=e,this.markupService=Q.Fj,this.storageService=z.getInstance("onejs_view_data"),this.container=null,this.stateChangeListeners={},this.currentMasterView=null,this.Engine=F.I,this.State=G.P,this.templates=K,this._sections={},this._changedSections=[],this._stacks={},this.scanMode=!1,this._once={},this.vitualContainer=document.createElement("div"),this.vitualContainer.setAttribute("id","data-vitual-container"),this.vitualContainer.style.display="none",this.VIEW_MOUNTED_QUEUE=[],this.CURRENT_SUPER_VIEW=null,this.CURRENT_SUPER_VIEW_PATH=null,this.CURRENT_SUPER_VIEW_MOUNTED=!1,this.CURRENT_VIEW=null,this.CURRENT_VIEW_PATH=null,this.CURRENT_VIEW_MOUNTED=!1,this.SUPER_VIEW_STACK=[],this.ALL_VIEW_STACK=[],this.PAGE_VIEW=null,this.renderTimes=-1,this.cachedViews={},this.serverRenderData={},this.viewMap=new Map,this.cachedPageData=new Map,this.wrapperConfig={},this.listeners={},this.ssrData={},this.ssrViewManager=new Z,this.cachedPageView=new Map,this.cachedTimes=600,this.SEO={tags:r,updateItem:function(e,t){const i=this.tags[e];return!(!i||0==i.length||(i.forEach(e=>{let i=document.querySelector(e.selector);i||(i=document.createElement(e.tag),e.attrs&&Object.entries(e.attrs).forEach(([e,t])=>{i.setAttribute(e,t)}),document.head.appendChild(i)),e.attribute&&("@content"==e.attribute?i.textContent=t:i.setAttribute(e.attribute,t))}),0))}}}setApp(e){this.App=e}setContainer(e){this.container=e}init(e={}){this._sections={},this._stacks={},this._once={},this._changedSections=[],this.templates||(this.templates=K),this._currentScope="web",this.ssrData=e?.ssrData||{},this.ssrViewManager.setViews(this.ssrData)}getView(e){return this.templates[e]||null}loadView(e,t={},i=""){this.templates[e]&&this.clearOldRendering(),this.renderTimes++;let r=null;this.CURRENT_SUPER_VIEW_MOUNTED=!1;try{let s=!1;if(this.cachedTimes>0){let r=e.replace(".","_")+"_"+i?.replace(/\//g,"_");const n=this.storageService.get(r);n&&(t={...t,...n},s=!0)}let n=this.view(e,s?{...t}:null);if(!n)return r=`App.View.loadView: View '${e}' not found`,{error:`App.View.loadView: View '${e}' not found`,html:null,superView:null,isSuperView:!1,needInsert:!1};if(i&&(n.urlPath=i),this.cachedTimes>0&&this.PAGE_VIEW instanceof F.I){const e=this.PAGE_VIEW.data;let t=this.PAGE_VIEW.path.replace(".","_")+"_"+this.PAGE_VIEW.urlPath?.replace(/\//g,"_");this.storageService.set(t,e,3600)}let a,o=null,l=null,h=(n.path,n),c=0;do{try{n.hasSuperView?(this.ALL_VIEW_STACK.unshift(n),l=n.superViewPath,a=this.renderView(n),n=a,n.setIsSuperView(!0),n&&"object"==typeof n&&(o=n,h=n)):n.isSuperView?(l!==n.path&&(this.SUPER_VIEW_STACK.unshift(n),l=n.path),o=n,n.hasSuperView?(a=this.renderView(n,c>0?n.data:null),n=a,n.setIsSuperView(!0),n&&"object"==typeof n&&(o=n,l=n.path,h=n)):a=""):(this.ALL_VIEW_STACK.unshift(n),a=this.renderView(n,c>0?n.data:null),h=n)}catch(t){return r=`App.View.loadView: Error rendering view '${e}':`+t.message,console.error("ðŸ” App.View.loadView error:",t),""}c++}while(a&&"object"==typeof a&&a instanceof F.I);try{let e=a;const t=!(l&&l===this.CURRENT_SUPER_VIEW_PATH);return l&&(t?(this.CURRENT_SUPER_VIEW_PATH=l,this.CURRENT_SUPER_VIEW=o,e=o.render()):this.CURRENT_SUPER_VIEW_MOUNTED=!0),{html:e,isSuperView:!!l,needInsert:t,superView:o,ultraView:h,error:null}}catch(e){r="App.View.loadView: Error updating DOM:"}}catch(t){r=`App.View.loadView: Critical error loading view '${e}':`}return{html:null,needInsert:!1,superView:null,ultraView:null,isSuperView:!1,error:r}}scanView(e,t=null){this.templates[e]&&this.clearOldRendering(),this.renderTimes++;let i=null;this.CURRENT_SUPER_VIEW_MOUNTED=!1;try{const r=this.ssrViewManager.scan(e);if(!r)return i=`App.View.scanView: View '${e}' not found`,{error:`App.View.scanView: View '${e}' not found`,html:null,superView:null,isSuperView:!1,needInsert:!1};const s=r.data;s.__SSR_VIEW_ID__=r.viewId;let n=this.view(e,s);if(!n)return i=`App.View.loadView: View '${e}' not found`,{error:`App.View.loadView: View '${e}' not found`,html:null,superView:null,isSuperView:!1,needInsert:!1};t&&t.$urlPath&&(n.urlPath=t.$urlPath);let a,o=null,l=null,h=(n.path,n);this.PAGE_VIEW=n,n.__scan(r);let c=0;do{try{if(n.hasSuperView){if(this.ALL_VIEW_STACK.unshift(n),l=n.superViewPath,a=this.scanRenderedView(n),n=a,n.setIsSuperView(!0),n&&"object"==typeof n&&(o=n,h=n,!n.isScanned)){const e=this.ssrViewManager.scan(l);e&&o.__scan(e)}}else if(n.isSuperView)if(l!==n.path&&(this.SUPER_VIEW_STACK.unshift(n),l=n.path,h=n),o=n,h=n,n.hasSuperView){if(a=this.scanRenderedView(n),n=a,n.setIsSuperView(!0),n&&"object"==typeof n&&(o=n,l=n.path,h=n,!n.isScanned)){const e=this.ssrViewManager.scan(l);e&&o.__scan(e)}}else a="";else this.ALL_VIEW_STACK.unshift(n),this.PAGE_VIEW=n,a=this.scanRenderedView(n),h=n}catch(t){return i=`App.View.scanView: Error rendering view '${e}':`,console.error("ðŸ” App.View.scanView error:",t),""}c++}while(a&&"object"==typeof a&&a.constructor===this.Engine);try{let e=a;const t=!(l&&l===this.CURRENT_SUPER_VIEW_PATH);return l&&(t?(this.CURRENT_SUPER_VIEW_PATH=l,this.CURRENT_SUPER_VIEW=o,this.CURRENT_SUPER_VIEW_MOUNTED=!1,e=o.virtualRender(),console.log("ðŸ” App.View.scanView render super view:",e)):(console.log("ðŸ” App.View.scanView need insert super view:",l),this.CURRENT_SUPER_VIEW_MOUNTED=!0)),this.mountAllViewsFromStack(this.renderTimes).then(()=>{q.Ay.log("âœ… View.scanView: All views mounted successfully in bottom-up order")}).catch(e=>{q.Ay.error("âŒ View.scanView: Error mounting views:",e)}),{html:e,isSuperView:!!l,needInsert:t,superView:o,ultraView:h,error:null}}catch(e){i="App.View.scanView: Error updating DOM:"+e.message}}catch(t){i=`App.View.scanView: Critical error loading view '${e}':`+t.message}return{html:null,needInsert:!1,superView:null,isSuperView:!1,ultraView:null,error:i}}mountView(e,t={},i=null){try{let r=this.CURRENT_SUPER_VIEW;r&&r instanceof F.I&&r.unmounted();const s=this.loadView(e,t,i?.$urlPath||"");if(s.error)return void console.error("View rendering error:",s.error);if(console.log("View rendered successfully:",s),s.needInsert&&s.html){const e=this.container||document.querySelector("#app-root")||document.querySelector("#app")||document.body,t=s.html;e&&J.A.setHTML(e,t)}else console.log("Router: Not updating DOM - needInsert:",s.needInsert,"html:",!!s.html);this.emitChangedSections&&this.emitChangedSections(),s.ultraView&&s.ultraView instanceof F.I&&s.ultraView.mounted(),this.CURRENT_SUPER_VIEW_MOUNTED=!0}catch(e){console.error("Error rendering view:",e)}}mountViewScan(e,t={},i=null){const r=this.scanView(e);r.error?console.error("âŒ Router.hydrateViews: Scan error:",r.error):(r.ultraView&&r.ultraView instanceof F.I&&r.ultraView.mounted(),this.CURRENT_SUPER_VIEW_MOUNTED=!0,this._isHydrated=!0)}mountContent(e){const t=this.container||document.querySelector("#app-root")||document.querySelector("#app")||document.body;t&&J.A.setHTML(t,e)}on(e,t){return"string"==typeof e&&""!==e&&"function"==typeof t&&(this.listeners[e]||(this.listeners[e]=[]),void this.listeners[e].push(t))}off(e,t){return"string"==typeof e&&""!==e&&"function"==typeof t&&void(this.listeners[e]&&(this.listeners[e]=this.listeners[e].filter(e=>e!==t)))}emit(e,...t){if("string"!=typeof e||""===e)return!1;this.listeners[e]&&this.listeners[e].forEach(e=>e(...t))}generateViewId(){return(0,B.bD)()}execute(e,t=""){try{const i=e();return void 0!==i?i:t}catch(e){return q.Ay.error("App.execute error:",e),t}}evaluate(e,t=""){try{const i=e();return void 0!==i?i:t}catch(e){return q.Ay.error("App.evaluate error:",e),t}}escString(e){return null==e?"":String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}text(e){return{loading:"Loading...",error:"Error occurred",not_found:"Not found",unauthorized:"Unauthorized"}[e]||e}setSuperViewPath(e){this.CURRENT_SUPER_VIEW_PATH=e}addViewEngine(e,t){void 0===this.VIEW_MOUNTED_QUEUE[e]&&(this.VIEW_MOUNTED_QUEUE[e]=[]),this.VIEW_MOUNTED_QUEUE[e].push(t)}callViewEngineMounted(e,t){}async mountAllViewsBottomUp(e){if(!this.VIEW_MOUNTED_QUEUE[e]||!this.VIEW_MOUNTED_QUEUE[e].length)return void q.Ay.warn(`âš ï¸ View.mountAllViewsBottomUp: No views in queue for renderTimes=${e}`);this.CURRENT_SUPER_VIEW_MOUNTED||(q.Ay.log("â³ View.mountAllViewsBottomUp: Waiting for super view to be mounted..."),await new Promise(e=>{const t=setInterval(()=>{this.CURRENT_SUPER_VIEW_MOUNTED&&(clearInterval(t),e())},50)}));const t=this.VIEW_MOUNTED_QUEUE[e];q.Ay.log(`ðŸ“‹ View.mountAllViewsBottomUp: Processing ${t.length} views`);for(let e=t.length-1;e>=0;e--){const i=t[e];try{"function"==typeof i.beforeMount&&i.beforeMount(),"function"==typeof i.mounted&&i.mounted(),q.Ay.log(`âœ… View.mountAllViewsBottomUp: Successfully mounted ${i.path}`)}catch(e){q.Ay.error(`âŒ View.mountAllViewsBottomUp: Error mounting ${i.path}:`,e)}}this.VIEW_MOUNTED_QUEUE[e]=[]}async mountAllViewsFromStack(e){if(this.VIEW_MOUNTED_QUEUE[e]&&this.VIEW_MOUNTED_QUEUE[e].length){if(this.CURRENT_SUPER_VIEW_MOUNTED||(q.Ay.log("â³ View.mountAllViewsFromStack: Waiting for super view..."),await new Promise(e=>{const t=setInterval(()=>{this.CURRENT_SUPER_VIEW_MOUNTED&&(clearInterval(t),e())},50)})),this.ALL_VIEW_STACK&&this.ALL_VIEW_STACK.length>0){const e=this.SUPER_VIEW_STACK||[];for(let t=e.length-1;t>=0;t--){const i=e[t];try{"function"==typeof i.beforeMount&&i.beforeMount(),"function"==typeof i.mounted&&i.mounted()}catch(e){q.Ay.error(`âŒ Error mounting super view ${i.path}:`,e)}}for(let t=this.ALL_VIEW_STACK.length-1;t>=0;t--){const i=this.ALL_VIEW_STACK[t];if(!e.includes(i))try{"function"==typeof i.beforeMount&&i.beforeMount(),"function"==typeof i.mounted&&i.mounted()}catch(e){q.Ay.error(`âŒ Error mounting view ${i.path}:`,e)}}this.ALL_VIEW_STACK=[],this.SUPER_VIEW_STACK=[]}else await this.mountAllViewsBottomUp(e);this.VIEW_MOUNTED_QUEUE[e]=[]}else q.Ay.warn("âš ï¸ View.mountAllViewsFromStack: No views in queue")}templateToDom(e){const t=document.createElement("template");return t.innerHTML=e,t.content.firstChild}include(e,t={}){try{return this.view(e,{...t},!1)}catch(t){return console.error(`App.View.include error for '${e}':`,t),""}}includeIf(e,t={}){try{return this.exists(e)?this.include(e,t):null}catch(t){return console.error(`App.View.includeIf error for '${e}':`,t),null}}extendView(e,t={}){try{const i=this.view(e,(0,B.vI)(t)?t:null,!0);return i?(this.cachedViews[e]=i,this.cachedViews[e]):null}catch(e){return null}}registerSubscribe(e,t,i=""){let r="";const s=[];if("string"==typeof e)r+=` ${e}="${this.yieldContent(t,i)}"`,s.push(`${e}:${t}`);else if("object"==typeof e){const t=Object.keys(e);for(const n of t)"#content"===n.toLowerCase()?r+=` ${Y.a.KEYS.YIELD_CONTENT}="${e[n]}"`:"#children"===n.toLowerCase()?r+=` ${Y.a.KEYS.YIELD_CHILDREN}="${e[n]}"`:(r+=` ${n}="${this.yieldContent(e[n],i)}"`,s.push(`${n}:${e[n]}`))}return r+=` ${Y.a.KEYS.YIELD_ATTR}="${s.join(",")}"`,r}exists(e){return!(!this.templates||!this.templates[e])}renderOrScanView(e,t=null,i="csr"){let r=null;const s=this.renderTimes,n="ssr"===i?"virtualRender":"render",a="ssr"===i?"virtualPrerender":"prerender";if(!e.hasAwaitData&&!e.hasFetchData)return t&&e.updateVariableData({...t}),r=e[n](),r;const o=e.hasPrerender;return o||(t&&e.updateVariableData(t),r=e[n]()),e.hasAwaitData?(o&&(r=e[a]()),"csr"===i?this.App.API.getURIDAta().then(t=>{e.updateVariableData(t),e[n]()}):(r=e[n](),addToQueue&&this.callViewEngineMounted(s,e.id))):e.hasFetchData&&(o&&(r=e[a]()),"csr"===i?(e.fetch,this.App.API.getURIDAta().then(t=>{e.updateVariableData(t),e[n](),addToQueue&&this.callViewEngineMounted(s,e.id)})):(r=e[n](),addToQueue&&this.callViewEngineMounted(s,e.id))),r}renderView(e,t=null){return this.renderOrScanView(e,t,"csr")}scanRenderedView(e,t=null){return this.renderOrScanView(e,t,"ssr")}view(e,t=null,i=!1){try{if(i&&this.cachedViews[e]){const i=this.cachedViews[e];return i.reset(),t&&i.updateVariableData({...t}),i}if(!this.templates[e])return console.warn(`App.View.view: View '${e}' not found in scope '${scope}'`),null;if("function"!=typeof this.templates[e])return console.warn(`App.View.view: View '${e}' render function is not valid`),null;const r=(0,this.templates[e])(t?{...t}:{},{App:this.App,View:this});return r?(r.setApp(this.App),this.cachedViews[e]=r,r):(console.error(`App.View.view: View config not found for '${e}' in scope '${scope}'`),null)}catch(t){return console.error(`App.View.view: Critical error loading view '${e}':`,t),null}}clearOldRendering(){const e=this.renderTimes;if(e>3){const t=e-3;if(this.VIEW_MOUNTED_QUEUE[t]){const e=this.VIEW_MOUNTED_QUEUE[t];Array.isArray(e)&&e.forEach(e=>{e&&"object"==typeof e&&this.unmountView(e)}),delete this.VIEW_MOUNTED_QUEUE[t]}}const t=Object.keys(this.cachedViews);t.length>50&&t.slice(0,t.length-50).forEach(e=>{const t=this.cachedViews[e];t&&this.unmountView(t),delete this.cachedViews[e]}),this.ALL_VIEW_STACK=[],this.SUPER_VIEW_STACK=[],this.PAGE_VIEW=null,this.clearOrphanedEventData()}unmountView(e){if(!e||"object"!=typeof e)return q.Ay.warn("âš ï¸ View.unmountView: Invalid view object"),!1;try{return q.Ay.log(`ðŸ—‘ï¸ View.unmountView: Unmounting view ${e.id} (${e.path})`),"function"==typeof e.beforeUnmount&&e.beforeUnmount(),"function"==typeof e.removeEvents&&e.removeEvents(),this.viewMap.has(e.id)&&this.viewMap.delete(e.id),"function"==typeof e.unmounted&&e.unmounted(),"function"==typeof e.destroy&&e.destroy(),q.Ay.log(`âœ… View.unmountView: View ${e.id} unmounted successfully`),!0}catch(t){return q.Ay.error(`âŒ View.unmountView: Error unmounting view ${e.id}:`,t),!1}}resetView(){q.Ay.log("ðŸ”„ View.resetView: Resetting view stacks"),this.SUPER_VIEW_STACK=[],this.ALL_VIEW_STACK=[],this.PAGE_VIEW=null}clearOrphanedEventData(){q.Ay.log("ðŸ—‘ï¸ View.clearOrphanedEventData: Cleaning up orphaned event handlers"),Object.values(this.cachedViews).forEach(e=>{e&&"function"==typeof e.clearOrphanedEventData&&e.clearOrphanedEventData()}),[...this.ALL_VIEW_STACK,...this.SUPER_VIEW_STACK].forEach(e=>{e&&"function"==typeof e.clearOrphanedEventData&&e.clearOrphanedEventData()}),this.CURRENT_VIEW&&"function"==typeof this.CURRENT_VIEW.clearOrphanedEventData&&this.CURRENT_VIEW.clearOrphanedEventData(),this.CURRENT_SUPER_VIEW&&"function"==typeof this.CURRENT_SUPER_VIEW.clearOrphanedEventData&&this.CURRENT_SUPER_VIEW.clearOrphanedEventData()}section(e,t,i="string"){let r=this._sections[e];this._sections[e]=t,r!==t&&this._changedSections.push(e)}yield(e,t=""){return this._sections[e]||t}yieldContent(e,t=""){return this._sections[e]||t}renderSections(){let e="";for(const[t,i]of Object.entries(this._sections))e+=i;return e}hasSection(e){return e in this._sections}getChangedSections(){return this._changedSections}resetChangedSections(){this._changedSections=[]}isChangedSection(e){return this._changedSections.includes(e)}emitChangedSections(){this._changedSections.forEach(e=>{if(this.SEO.updateItem(e,this._sections[e]))return;const t=e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");document.querySelectorAll(`[data-yield-subscribe-key*="${t}"]`).forEach(t=>{const i=t.getAttribute("data-yield-subscribe-key"),r=t.getAttribute("data-yield-subscribe-target"),s=t.getAttribute("data-yield-subscribe-attr");if(i&&i.includes(e)){const i=this._sections[e]||"";"content"===r||"children"===r?t.innerHTML=i:"attr"===r||"attribute"===r?s&&t.setAttribute(s,i):t.innerHTML=i}}),document.querySelectorAll("[data-yield-attr]").forEach(t=>{const i=t.getAttribute("data-yield-attr");i&&i.includes(e)&&i.split(",").forEach(i=>{let r=i.split(":"),s=r.shift(),n=r.join(":");if(n&&n.trim()===e){const i=this._sections[e]||"";t.setAttribute(s.trim(),i)}})}),e.split(":").length<=1&&document.querySelectorAll(`[data-yield-${t}]`).forEach(t=>{const i=this._sections[e]||"";t.innerHTML=i}),document.querySelectorAll(`[data-yield-content="${t}"]`).forEach(t=>{t.innerHTML=this._sections[e]||""}),document.querySelectorAll(`[data-yield-children="${t}"]`).forEach(t=>{t.innerHTML=this._sections[e]||""})}),this.resetChangedSections()}loadServerData(e={}){}push(e,t){this._stacks[e]||(this._stacks[e]=[]),this._stacks[e].push(t)}stack(e){return this._stacks[e]?this._stacks[e].join(""):""}once(e){const t=this._hashContent(e);return this._once[t]?"":(this._once[t]=!0,e)}_hashContent(e){let t=0;if(0===e.length)return t.toString();for(let i=0;i<e.length;i++)t=(t<<5)-t+e.charCodeAt(i),t&=t;return t.toString()}isAuth(e=null){return!1}can(e,t=null){return!1}hasError(e){return!1}firstError(e){return""}csrfToken(){return""}foreach(e,t){if(!e)return"";let i="";return Array.isArray(e)?e.forEach((e,r)=>{i+=t(e,r)}):"object"==typeof e&&Object.entries(e).forEach(([e,r])=>{i+=t(r,e)}),i}route(e,t={}){return this.App.Router.getURL(e,t)}}},4064:(e,t,i)=>{i.d(t,{H:()=>r}),i(499);class r{constructor(e=null){this.App=e}setApp(e){this.App=e}trim(e,t=" "){if("string"!=typeof e)return e;const i=new RegExp(`^${t}+|${t}+$`,"g");return e.replace(i,"")}isHtmlString(e){return"string"==typeof e&&/<[a-z][\s\S]*>/i.test(e)}substr(e,t,i){return"string"!=typeof e?e:e.substring(t,i)}strtolower(e){return"string"!=typeof e?e:e.toLowerCase()}strtoupper(e){return"string"!=typeof e?e:e.toUpperCase()}formatDate(e,t="YYYY-MM-DD"){const i=new Date(e);if(isNaN(i.getTime()))return"";const r=i.getFullYear(),s=String(i.getMonth()+1).padStart(2,"0"),n=String(i.getDate()).padStart(2,"0"),a=String(i.getHours()).padStart(2,"0"),o=String(i.getMinutes()).padStart(2,"0"),l=String(i.getSeconds()).padStart(2,"0");return t.replace("YYYY",r).replace("MM",s).replace("DD",n).replace("HH",a).replace("mm",o).replace("ss",l)}formatNumber(e,t={}){if("number"!=typeof e||isNaN(e))return"0";const{decimals:i=2,thousandsSeparator:r=",",decimalSeparator:s=".",prefix:n="",suffix:a=""}=t,o=e.toFixed(i).split(".");return o[0]=o[0].replace(/\B(?=(\d{3})+(?!\d))/g,r),n+o.join(s)+a}formatCurrency(e,t="USD"){return({USD:"$",EUR:"â‚¬",GBP:"Â£",JPY:"Â¥",VND:"â‚«"}[t]||t)+this.formatNumber(e,{decimals:2})}truncate(e,t=100,i="..."){return"string"!=typeof e||e.length<=t?e:e.substring(0,t).trim()+i}randomString(e=8){let t="";for(let i=0;i<e;i++)t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(Math.floor(62*Math.random()));return t}deepClone(e){if(null===e||"object"!=typeof e)return e;if(e instanceof Date)return new Date(e.getTime());if(e instanceof Array)return e.map(e=>this.deepClone(e));if("object"==typeof e){const t={};return Object.keys(e).forEach(i=>{t[i]=this.deepClone(e[i])}),t}return e}debounce(e,t){let i;return function(...r){clearTimeout(i),i=setTimeout(()=>{clearTimeout(i),e(...r)},t)}}throttle(e,t){let i;return function(...r){i||(e.apply(this,r),i=!0,setTimeout(()=>i=!1,t))}}getSEOTagConfig(){return{title:[{tag:"title",selector:"title",attribute:"@content"}],description:[{tag:"meta",selector:'meta[name="description"]',attrs:{name:"description"},attribute:"content"}],keywords:[{tag:"meta",selector:'meta[name="keywords"]',attrs:{name:"keywords"},attribute:"content"}],ogTitle:[{tag:"meta",selector:'meta[property="og:title"]',attrs:{property:"og:title"},attribute:"content"}],ogDescription:[{tag:"meta",selector:'meta[property="og:description"]',attrs:{property:"og:description"},attribute:"content"}],ogImage:[{tag:"meta",selector:'meta[property="og:image"]',attrs:{property:"og:image"},attribute:"content"}]}}updateSEOItem(e,t){const i=this.SEO.tags[e];return!(!i||0===i.length||(i.forEach(e=>{let i=document.querySelector(e.selector);i||(i=document.createElement(e.tag),e.attrs&&Object.entries(e.attrs).forEach(([e,t])=>{i.setAttribute(e,t)}),document.head.appendChild(i)),e.attribute&&("@content"===e.attribute?i.textContent=t:i.setAttribute(e.attribute,t))}),0))}updateTitle(e){this.updateSEOItem("title",e)}updateDescription(e){this.updateSEOItem("description",e)}updateKeywords(e){this.updateSEOItem("keywords",e)}updateOGTitle(e){this.updateSEOItem("ogTitle",e)}updateOGDescription(e){this.updateSEOItem("ogDescription",e)}updateOGImage(e){this.updateSEOItem("ogImage",e)}getUrlParams(e=window.location.href){const t={};return new URL(e).searchParams.forEach((e,i)=>{t[i]=e}),t}buildUrl(e,t={}){const i=new URL(e);return Object.entries(t).forEach(([e,t])=>{null!=t&&i.searchParams.set(e,t)}),i.toString()}isInViewport(e){const t=e.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)}scrollTo(e,t={}){const i="string"==typeof e?document.querySelector(e):e;if(!i)return;const{behavior:r="smooth",block:s="start",inline:n="nearest",offset:a=0}=t,o=i.offsetTop-a;window.scrollTo({top:o,behavior:r})}async copyToClipboard(e){try{return await navigator.clipboard.writeText(e),!0}catch(e){return console.error("Failed to copy to clipboard:",e),!1}}downloadFile(e,t,i="text/plain"){const r=new Blob([e],{type:i}),s=URL.createObjectURL(r),n=document.createElement("a");n.href=s,n.download=t,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(s)}getDeviceType(){const e=window.innerWidth;return e<768?"mobile":e<1024?"tablet":"desktop"}count(e){return Array.isArray(e)?e.length:"object"==typeof e&&null!==e?Object.keys(e).length:0}isNull(e){return null===e}isArray(e){return Array.isArray(e)}isString(e){return"string"==typeof e}isNumeric(e){return!isNaN(parseFloat(e))&&isFinite(e)}now(){const e=new Date;return{format:function(t){if(!t)return e.toISOString();const i=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0"),n=String(e.getHours()).padStart(2,"0"),a=String(e.getMinutes()).padStart(2,"0"),o=String(e.getSeconds()).padStart(2,"0");return t.replace("Y",i).replace("m",r).replace("d",s).replace("H",n).replace("i",a).replace("s",o)},getTime:function(){return e.getTime()},toString:function(){return e.toString()}}}today(){return new Date}date(e,t="Y-m-d H:i:s"){return new Date(e).toISOString().slice(0,19).replace("T"," ")}env(e,t=null){return t}ucfirst(e){return"string"!=typeof e||0===e.length?e:e.charAt(0).toUpperCase()+e.slice(1)}lcfirst(e){return"string"!=typeof e||0===e.length?e:e.charAt(0).toLowerCase()+e.slice(1)}str_replace(e,t,i){if(Array.isArray(e)){let r=i;return e.forEach((e,i)=>{const s=Array.isArray(t)?void 0!==t[i]?t[i]:"":t;r=r.split(e).join(s)}),r}return i.split(e).join(t)}explode(e,t){return"string"!=typeof t||"string"!=typeof e?[]:t.split(e)}implode(e,t){return Array.isArray(t)?t.join(e):""}in_array(e,t){return!!Array.isArray(t)&&t.includes(e)}array_unique(e){return Array.isArray(e)?Array.from(new Set(e)):[]}array_merge(...e){return[].concat(...e)}is_array(e){return Array.isArray(e)}is_string(e){return"string"==typeof e}is_numeric(e){return!isNaN(parseFloat(e))&&isFinite(e)}empty(e){return null==e||"string"==typeof e&&""===e.trim()||!(!Array.isArray(e)||0!==e.length)||"object"==typeof e&&!Array.isArray(e)&&0===Object.keys(e).length||!1===e||0===e}isset(e){return null!=e}json_encode(e){return JSON.stringify(e)}json_decode(e){return JSON.parse(e)}isMobile(){return"mobile"===this.getDeviceType()}isTablet(){return"tablet"===this.getDeviceType()}isDesktop(){return"desktop"===this.getDeviceType()}}},4476:(e,t,i)=>{i.d(t,{I:()=>c});var r=i(499),s=i(6143),n=i(8544),a=i(5276);class o{constructor({App:e,engine:t,stateKeys:i=[],renderBlock:s=()=>"",scanMode:n=!1,renderID:a=""}){this.App=e,this.engine=t,this.states=t.states,this.stateKeys=i,this.renderBlock=s,this.scanMode=n,this.id=a||(0,r.bD)(),this.isRendered=!1,this.openTag=null,this.closeTag=null,this.refElements=[],this.subscribes=[],this.isMounted=!1,this.isScanned=!1,this.markup=null}mounted(){this.isMounted||(this.isMounted=!0,this.scan(),this.stateKeys.length>0&&this.stateKeys.forEach(e=>{const t=this.states.__subscribe(e,()=>{console.log(`FollowingBlock [id=${this.id}] detected change in state "${e}", renewing...`),this.renew()});this.subscribes.push(t)}))}unmounted(){this.isMounted=!1,this.subscribes.length>0&&(this.subscribes.forEach(e=>{e()}),this.subscribes=[])}placeholder(){return`\x3c!-- [one:placeholder ref="following" id="${this.id}"] --\x3e\x3c!-- [/one:placeholder] --\x3e`}render(){return`\x3c!-- [one:follow type="state" id="${this.id}" following="${this.stateKeys.join(",")}"] viewid="${this.id}" --\x3e${this.renderBlock()}\x3c!-- [/one:follow] --\x3e`}rerender(){return this.renderBlock()}renew(){this.engine.onFollowUpdating();try{this.unmounted(),this.clear(),this.closeTag&&this.closeTag.parentNode&&(n.A.before(this.closeTag,this.rerender()),this.mounted())}catch(e){console.error("FollowingBlock renew error:",e)}this.engine.onFollowUpdated()}destroy(){this.unmounted(),this.clear()}scan(){console.log(`FollowingBlock [id=${this.id}] scanning...`),this.markup?(this.refElements=[],this.markup.__scan(),this.refElements=this.markup.nodes.slice()):(this.markup=s.Ay.first("follow",{id:this.id},{},!1),this.openTag=this.markup.openTag,this.closeTag=this.markup.closeTag,this.refElements=this.markup.nodes.slice()),this.isScanned=!0}clear(){this.refElements.forEach(e=>{e.parentNode&&e.parentNode.removeChild(e)}),this.refElements=[]}}var l=i(3696),h=i(7611);class c{constructor(e,t){this.App=null,this.isSuperView=!1,this._emptyFn=()=>{},this.id=null,this.init=this._emptyFn,this.parent=null,this.children=[],this.superView=null,this.superViewPath=null,this.superViewId=null,this.hasSuperView=!1,this.originalViewPath=null,this.originalViewId=null,this.originalView=null,this.hasAwaitData=!1,this.hasFetchData=!1,this.fetch={},this.usesVars=!1,this.hasSections=!1,this.renderLongSections=[],this.hasSectionPreload=!1,this.hasPrerender=!1,this.sections={},this.addCSS=this._emptyFn,this.removeCSS=this._emptyFn,this.resources=[],this.userDefined={},this.events={},this.eventHandlers={},this.data={},this.states={},this.urlPath="",this.isInitlized=!1,this.wrapperConfig={enable:!1,tag:null,follow:!0,attributes:{},..."object"==typeof t?.wrapperConfig?t.wrapperConfig:{}},this.templateEngine=null,this.path=e,this.config=t||{},this.wrapTag=null,this.followingBlocks=new Map,this.followingConfig=[],this.followingIndex=0,this.followingScanIndex=0,this.followingIDs=[],this.followingPrerenderIDs=[],this.followingRenderIDs=[],this.subscribeStates=!0,this.childrenConfig=[],this.childrenIndex=0,this.refreshChildrenIndex=0,this.isRendering=!1,this.isRendered=!1,this.isMounted=!1,this.isDestroyed=!1,this.isScanned=!1,this.isReady=!1,this.markup=null,this.refElements=[],this.eventListenerStatus=!1,this.eventListeners=[],this.eventQuickHandles=[],this.isVirtualRendering=!1,this.cachedSections={},this.renderedContent=null,this.__scope=null,this.isRefreshing=!1,this.changeStateQueueCount=0,this.changedStateKeys=new Set,this._stateChangePending=!1,this.loopContext=null,this.isCommitedConstructorData=!1}setup(e,t){return this.isInitlized||(this.path=e,this.config=t||{},this.initialize()),this}initialize(){if(this.isInitlized)return;this.isInitlized=!0;const e=this.config;this.id=e.viewId||(0,r.bD)(),(0,r.DI)(e,"viewId"),this.init=e.init||this._emptyFn,(0,r.DI)(e,"init"),this.addCSS=e.addCSS||this._emptyFn,(0,r.DI)(e,"addCSS"),this.removeCSS=e.removeCSS||this._emptyFn,(0,r.DI)(e,"removeCSS"),this.states=e.states||new a.P(this),(0,r.DI)(e,"states"),this.superViewPath=e.superViewPath||e.superView,(0,r.DI)(e,"superViewPath"),(0,r.DI)(e,"superView"),this.hasSuperView=e.hasSuperView,(0,r.DI)(e,"hasSuperView"),this.hasAwaitData=e.hasAwaitData,(0,r.DI)(e,"hasAwaitData"),this.hasFetchData=e.hasFetchData,(0,r.DI)(e,"hasFetchData"),this.fetch=e.fetch,(0,r.DI)(e,"fetch"),this.usesVars=e.usesVars,(0,r.DI)(e,"usesVars"),this.hasSections=e.hasSections,(0,r.DI)(e,"hasSections"),this.hasSectionPreload=e.hasSectionPreload,(0,r.DI)(e,"hasSectionPreload"),this.renderLongSections=e.renderLongSections||[],(0,r.DI)(e,"renderLongSections"),this.hasPrerender=e.hasPrerender,(0,r.DI)(e,"hasPrerender"),this.sections=e.sections,(0,r.DI)(e,"sections"),this.wrapperConfig={...this.wrapperConfig,..."object"==typeof e.wrapperConfig?e.wrapperConfig:{}},(0,r.DI)(e,"wrapperConfig"),this.resources=e.resources,(0,r.DI)(e,"resources"),this.userDefined=e.userDefined,(0,r.DI)(e,"userDefined"),this.master=null,this.children=[],this.events={},this.eventHandlers={},this.processDefinedProperties(e),e&&e.data&&"object"==typeof e.data&&e.data.__SSR_VIEW_ID__&&(e.data.__SSR_VIEW_ID__=null,(0,r.DI)(e.data,"__SSR_VIEW_ID__")),this.data={...this.data||{},...e.data||{}},this.commitConstructorData()}processDefinedProperties(e){let t={},i={};e.__props__&&e.__props__.length>0&&e.__props__.forEach(r=>{"function"==typeof e[r]?i[r]=e[r].bind(this):void 0!==e[r]&&(t[r]=e[r])}),this.userDefined&&Object.entries(this.userDefined).forEach(([e,r])=>{h.p.includes(e)||("function"==typeof r?i[e]=r.bind(this):t[e]=r)}),(0,r.uH)(this,t,{writable:!0,configurable:!0,enumerable:!0}),(0,r.Im)(this,i)}setScope(e){this.__scope=e}loadServerData(e={}){const[t,i]=e,r="function"==typeof this.config.loadServerData?this.config.loadServerData.apply(this,[{...this.App.View.data,...this.data,..._data}]):this.config.loadServerData;return"object"==typeof r&&(r.constructor,this.constructor),r}commitConstructorData(){hasData(this.data)&&"function"==typeof this.config.commitConstructorData&&this.config.commitConstructorData.apply(this,[{...this.App.View.data,...this.data}]),this.isCommitedConstructorData=!0}addEventConfig(e,t){if("string"!=typeof e||""===e)return;if("object"!=typeof t||null===t)return;let i=(0,r.bD)();return this.addEventStack(e,i,t)}render(e={}){let t=this.followingIDs.length;this.data={...this.data,...e};const i=this.config.render.apply(this,[{...this.App.View.data,...this.data}]);return this.renderedContent=i,this.followingIDs.length>=t&&this.followingRenderIDs.push(...this.followingIDs.slice(t)),"string"==typeof i&&""!==i.trim()&&this.isHtmlString(i)&&(this.renderedContent=this.addXRefViewToRootElements(i)),this.renderedContent}virtualRender(e={}){this.isVirtualRendering=!0;let t=this.followingIDs.length;this.data={...this.data,...e};const i=this.config.virtualRender.apply(this,[{...this.App.View.data,...this.data}]);return this.followingIDs.length>=t&&this.followingRenderIDs.push(...this.followingIDs.slice(t)),this.isVirtualRendering=!1,i}prerender(e={}){let t=this.followingIDs.length;this.data={...this.data,...e};const i=this.config.prerender.apply(this,[{...this.App.View.data,...this.data}]);return this.followingIDs.length>=t&&this.followingPrerenderIDs.push(...this.followingIDs.slice(t)),"string"==typeof i&&""!==i.trim()&&this.isHtmlString(i)?this.addXRefViewToRootElements(i):i}virtualPrerender(e={}){this.isVirtualRendering=!0;let t=this.followingIDs.length;this.data={...this.data,...e};const i=this.config.virtualPrerender.apply(this,[{...this.App.View.data,...this.data}]);return this.followingIDs.length>=t&&this.followingPrerenderIDs.push(...this.followingIDs.slice(t)),this.isVirtualRendering=!1,i}replaceView(e){if(this.isHtmlString(e)){const t=document.createElement("div");t.innerHTML=e;const i=t.content,r=document.querySelectorAll(`[x-ref-view="${this.id}"]`);for(let e=r.length-1;e>0;e--){const t=r[e],s=i.childNodes[e];t.parentNode.replaceChild(s,t)}const s=r[0];return s.parentNode.replaceChild(i,s),!0}return!1}beforeCreate(){"function"==typeof this.userDefined.beforeCreate&&this.userDefined.beforeCreate.call(this)}created(){"function"==typeof this.userDefined.created&&this.userDefined.created.call(this)}beforeUpdate(){"function"==typeof this.userDefined.beforeUpdate&&this.userDefined.beforeUpdate.call(this)}updated(){"function"==typeof this.userDefined.updated&&this.userDefined.updated.call(this)}beforeInit(){"function"==typeof this.userDefined.beforeInit&&this.userDefined.beforeInit.call(this)}init(){"function"==typeof this.userDefined.init&&this.userDefined.init.call(this)}afterInit(){"function"==typeof this.userDefined.afterInit&&this.userDefined.afterInit.call(this)}beforeDestroy(){"function"==typeof this.userDefined.beforeDestroy&&this.userDefined.beforeDestroy.call(this)}destroyed(){"function"==typeof this.userDefined.destroyed&&this.userDefined.destroyed.call(this)}beforeMount(){"function"==typeof this.userDefined.beforeMount&&this.userDefined.beforeMount.call(this)}mounted(){this.isMounted||("function"==typeof this.userDefined.mounted&&this.userDefined.mounted.call(this),this.startEventListener(),this.isMounted=!0),this.originalView&&this.originalView instanceof c&&this.originalView.onSuperViewMounted(),this.children&&this.children.length>0&&this.children.forEach(e=>{e&&e instanceof c&&e.onParentMounted()}),this.followingBlocks&&this.followingBlocks.size>0&&this.followingBlocks.forEach(e=>{e.mounted()})}beforeUnmount(){"function"==typeof this.userDefined.beforeUnmounted&&this.userDefined.beforeUnmounted.call(this)}unmounted(){this.isMounted&&("function"==typeof this.userDefined.unmounted&&this.userDefined.unmounted.call(this),this.stopEventListener(),this.isMounted=!1),this.originalView&&this.originalView instanceof c&&this.originalView.onSuperViewUnmounted(),this.children&&this.children.length>0&&this.children.forEach(e=>{e&&e instanceof c&&e.onParentUnmounted()}),this.followingBlocks&&this.followingBlocks.size>0&&this.followingBlocks.forEach(e=>{e.unmounted()})}destroy(){this.isDestroyed=!0,this._stateChangePending=!1,this.changedStateKeys&&this.changedStateKeys.clear(),this.changeStateQueueCount=0,this.unmounted(),this.originalView&&this.originalView instanceof c&&this.originalView.destroy(),this.children&&this.children.length>0&&this.children.forEach(e=>e.destroy()),this.followingBlocks&&this.followingBlocks.size>0&&(this.followingBlocks.forEach(e=>e.destroy()),this.followingBlocks.clear()),this.refElements&&this.refElements.length>0&&(this.refElements.forEach(e=>e.parentNode&&e.parentNode.removeChild(e)),this.refElements=[])}refresh(){this.isRefreshing=!0,this.parent&&this.parent instanceof c&&this.parent.refresh()}onSuperViewMounted(){this.mounted()}onSuperViewUnmounted(){}onParentMounted(){this.mounted()}onParentUnmounted(){}addXRefViewToRootElements(e){const t=document.createElement("div");return t.innerHTML=e,Array.from(t.children).forEach(e=>{e.setAttribute("x-ref-view",this.id)}),t.innerHTML}isHtmlString(e){return/<[a-z][\s\S]*>/i.test(e)}renderPlaceholder(){return`<div class="${h.a.className("placeholder")}" ${h.a.KEYS.VIEW_ID}="${this.id}"></div>`}showError(e){return this.isSuperView?`<div class="${h.a.className("ERROR_VIEW")}">${e}</div>`:(this.hasSuperView,this.renderLongSections.length>0?this.renderLongSections.map(t=>this.App.View.section(t,`<div class="${h.a.className("section-error")}" ${h.a.KEYS.VIEW_SECTION_REF}="${this.id}">${e}</div>`,"html")).join(""):`<div class="${h.a.className("ERROR_VIEW")}" ${h.a.KEYS.VIEW_ID}="${this.id}">${e}</div>`)}showErrorScan(e){return null}resetOriginalView(){this.originalView&&this.originalView instanceof c&&this.originalView.destroy()}ejectOriginalView(){this.originalView&&this.originalView instanceof c&&(this.originalView=null,this.originalViewId=null,this.originalViewPath=null)}remove(){return this.master?.removeChild(this),this.children.forEach(e=>e.remove()),this.master=null,this.children=[],this}insertResources(){this.resources.forEach(e=>{if(document.querySelector(`[data-resource-uuid="${e.uuid}"]`))return;const t=document.createElement(e.tag);Object.entries(e.attrs).forEach(([e,i])=>{t.setAttribute(e,i)}),t.setAttribute("data-resource-uuid",e.uuid),"script"===e.tag?document.body.appendChild(t):("link"===e.tag||"style"===e.tag)&&document.head.appendChild(t),document.head.appendChild(t)})}removeResources(){this.resources.forEach(e=>{const t=document.querySelector(`[data-resource-uuid="${e.uuid}"]`);t&&t.remove()})}__showError(e){return l.Ay.error(`ViewEngine Error [${this.path}]: ${e}`),this.showError(e)}__section(e,t,i){return this.cachedSections[e]=t,this.App.View.section(e,t,i)}__yield(e,t=""){return this.App.View.yield(e,t)}__yieldContent(e,t=""){return this.App.View.yieldContent(e,t)}__include(e,t={}){const i=this.data?this.data:{};i.__SSR_VIEW_ID__&&(i.__SSR_VIEW_ID__=null,delete i.__SSR_VIEW_ID__);const r=this.App.View.include(e,{...i,...t});return r?(r.setParent(this),this.addChild(r,t),r):null}__includeif(e,t={}){return this.App.View.exists(e)?this.__include(e,t):null}__includewhen(e,t,i={}){return e?this.__include(t,i):null}__extends(e,t={}){const i=this.data?this.data:{};i.__SSR_VIEW_ID__&&(i.__SSR_VIEW_ID__=null,delete i.__SSR_VIEW_ID__);const r=this.App.View.extendView(e,{...i,...t});return r?(this.superViewPath=e,this.setSuperView(r),r.setOriginalView(this),r):null}__setLoopContext(e){let t=this.loopContext;return this.loopContext=new LoopContext(t),this.loopContext.setCount(e),this.loopContext}__resetLoopContext(){if(this.loopContext&&this.loopContext.parent){let e=this.loopContext.parent;this.loopContext.parent=null,Object.freeze(this.loopContext),this.loopContext=e}else this.loopContext?(Object.freeze(this.loopContext),this.loopContext=null):this.loopContext=null;return this.loopContext}__foreach(e,t){if(!e)return"";if(!e||"object"!=typeof e||Array.isArray(e))return"";let i="";if(Array.isArray(e)){let r=this.__setupLoopContext(e);r.setType("increment"),e.forEach((e,s)=>{r.setCurrentTimes(s),i+=t(e,s,s,r)}),this.__resetLoopContext()}else{let r=Object.keys(e).length,s=this.__setupLoopContext(r);s.setType("increment"),Object.entries(e).forEach(([e,r])=>{s.setCurrentTimes(index),i+=t(r,e,index,s),index++}),this.__resetLoopContext()}return i}__scan(e){if(this.isScanned)return;this.isScanned=!0;const{viewId:t,data:i,events:r,following:s,children:n,parent:a}=e;if(i&&"object"==typeof i&&this.updateVariableData(i),"string"!=typeof t||""===t)return l.Ay.warn("âš ï¸ ViewEngine.__scan: Invalid viewId",t),null;l.Ay.log(`ðŸ” ViewEngine.__scan: Scanning view ${this.path} (${t})`),this.__scanDOMElements(t),r&&"object"==typeof r&&this.__attachEventHandlers(r,t),s&&s.length>0&&this.__setupFollowingBlocks(s,t),n&&n.length>0&&this.__storeChildrenReferences(n),l.Ay.log(`âœ… ViewEngine.__scan: Scan complete for ${this.path} (${t})`)}__scanDOMElements(e){if(this.hasSuperView)l.Ay.log(`âœ… ViewEngine.__scanDOMElements: Skipping element scan for ${this.path} (${e}) due to super view`);else{if(this.wrapperConfig.enable)if(this.wrapperConfig.tag){let t=document.querySelectorAll(`${this.wrapperConfig.tag}[data-wrap-view="${this.path}"][${h.a.KEYS.VIEW_WRAPPER}="${e}"]`);t.length>0&&(this.refElements=Array.from(t).map(t=>(t.setAttribute("x-ref-view",e),t)),l.Ay.log(`âœ… ViewEngine.__scanDOMElements: Found ${t.length} custom wrapper elements`))}else{const t=s.Ay.first("view",{name:this.path,id:e});t&&(this.markup=t,this.refElements=t.nodes.filter(e=>e.nodeType===Node.ELEMENT_NODE),l.Ay.log(`âœ… ViewEngine.__scanDOMElements: Found view boundary with ${this.refElements.length} elements`))}else{let t=document.querySelectorAll(`[data-view-wrapper="${e}"]`);t.length>0&&(this.refElements=Array.from(t).map(t=>(t.setAttribute("x-ref-view",e),t)),l.Ay.log(`âœ… ViewEngine.__scanDOMElements: Found ${t.length} standard wrapper elements`))}this.refElements&&0!==this.refElements.length||l.Ay.warn(`âš ï¸ ViewEngine.__scanDOMElements: No elements found for ${this.path} (${e})`)}}__attachEventHandlers(e,t){this.events=e}__setupFollowingBlocks(e,t){e.forEach(e=>{const{id:t,stateKeys:i}=e;this.followingConfig.push({id:t,stateKeys:i})}),l.Ay.log(`âœ… ViewEngine.__setupFollowingBlocks: Setup ${e.length} following blocks`)}__rerenderFollowBlock(e,t){l.Ay.log(`ðŸ”„ ViewEngine.__rerenderFollowBlock: Re-rendering follow block ${e}`)}__storeChildrenReferences(e){e.forEach(e=>{const{name:t,id:i}=e;this.childrenConfig.push({name:t,id:i})})}__sectionScan(e,t,i){return this.cachedSections[e]=t,null}__includeScan(e,t={}){const i=this.childrenConfig[this.childrenIndex];if(!i||i.name!==e)return null;this.childrenIndex++;const r=this.App.View.ssrViewManager.getInstance(i.name,i.id);if(!r)return null;const s={...t,...r.data,__SSR_VIEW_ID__:i.id},n=this.__include(i.name,s);return n?(n.__scan(r),n):null}__includeifScan(e,t={}){return this.App.View.exists(e)?this.__includeScan(e,t):null}__includewhenScan(e,t,i={}){return e?this.__include(t,i):null}__extendsScan(e,t={}){if(!this.App.View.exists(e))return null;let i=null,r=this.childrenConfig.find((t,i)=>t.name===e&&i==this.childrenConfig.length-1);if(i=r?this.App.View.ssrViewManager.getInstance(r.name,r.id):this.App.View.ssrViewManager.scan(e),!i)return null;const s={...t,...i.data,__SSR_VIEW_ID__:i.viewId},n=this.__extends(e,s);return n?(n.__scan(i),n):null}__showErrorScan(e){return l.Ay.error(`ViewEngine Scan Error [${this.path}]: ${e}`),null}__foreachScan(e,t){return null}__execute(...e){return this.App.View.execute(...e)}subscribeScan(...e){}__subscribe(...e){return this.subscribe(...e)}__subscribeScan(...e){return this.subscribeScan(...e)}__text(...e){return this.App.View.text(...e)}__textScan(...e){return""}addEventStack(e,t,i){if("string"==typeof t&&""!==t&&"object"==typeof i&&null!==i)return void 0===this.events[e]&&(this.events[e]={}),void 0===this.events[e][t]&&(this.events[e][t]=[]),this.events[e][t].push(...i),` data-${e}-id="${t}"`}addEventStackScan(e,t,i){return this.addEventStack(e,t,i)}addEventConfigScan(e,t){}__addEventConfig(e,t){return this.addEventConfig(e,t)}__addEventConfigScan(e,t){return this.addEventConfigScan(e,t)}__addEventQuickHandle(e,t){return this.addEventQuickHandle(e,t)}__addEventQuickHandleScan(e,t){return this.addEventQuickHandleScan(e,t)}setEventConfig(e){"object"==typeof e&&null!==e&&Object.entries(e).forEach((e,t)=>{"object"==typeof t&&null!==t&&Object.entries(t).forEach((t,i)=>{this.addEventStack(e,t,i)})})}addEventQuickHandle(e,t){if("string"!=typeof e||""===e||Array.isArray(t)||t.length!==t.filter(e=>"function"==typeof e).length)return;let i=this.eventQuickHandles.length;const r=`${this.id}-${e}-${i}`;return this.eventQuickHandles.push({id:r,type:e,handlers:t}),` data-${e}-id="${r}"`}addEventQuickHandleScan(e,t){return this.addEventQuickHandle(e,t)}setEventConfigScan(e){return this.setEventConfig(e)}startEventListener(){const e=[];Object.entries(this.events).forEach(([t,i])=>{Object.entries(i).forEach(([i,r])=>{const s=`[data-${t}-id="${i}"]`,n=document.querySelectorAll(s),a=this.parseEventHandlerFunctions(r);0!==a.length&&n.length>0?n.forEach(e=>{const i=e=>{let t=null;for(let i=0;i<a.length;i++)if(t=(0,a[i])(e),!1===t||e.defaultPrevented){e.preventDefault(),e.stopPropagation();break}if(!1===t||!0===t)return t};e.addEventListener(t,i),this.eventListeners.push({element:e,eventType:t,handler:i})}):(l.Ay.warn(`âš ï¸ ViewEngine.startEventListener: No elements found for selector ${s} or no handlers defined`),e.push({eventType:t,eventID:i}))})}),e.forEach(({eventType:e,eventID:t})=>{delete this.events[e][t],0===Object.keys(this.events[e]).length&&delete this.events[e]}),this.eventListenerStatus=!0}stopEventListener(){this.eventListeners.forEach(({element:e,eventType:t,handler:i})=>{e.removeEventListener(t,i)}),this.eventListeners=[],this.eventListenerStatus=!1}clearOrphanedEventData(){const e=[];Object.entries(this.events).forEach(([t,i])=>{Object.entries(i).forEach(([i,r])=>{const s=`[data-${t}-id="${i}"]`;0===document.querySelectorAll(s).length&&e.push({eventType:t,eventID:i})})}),e.forEach(({eventType:e,eventID:t})=>{delete this.events[e][t],0===Object.keys(this.events[e]).length&&delete this.events[e]}),e.length>0&&l.Ay.log(`ðŸ—‘ï¸ ViewEngine.clearOrphanedEventData: Cleaned up ${e.length} orphaned event handlers`)}parseEventHandlerFunctions(e){let t=[];return e.forEach(e=>{const i=e.handler,r=e.params||[];let s=null;s="function"==typeof this.userDefined[i]?e=>this.userDefined[i].apply(this,this.parseEventHandlerParams(e,r)):"function"==typeof this[i]?e=>this[i].apply(this,this.parseEventHandlerParams(e,r)):window&&"function"==typeof window[i]?e=>window[i].apply(this,this.parseEventHandlerParams(e,r)):e=>console.warn(`âš ï¸ Event handler ${i} is not defined`,e),t.push(s)}),t}parseEventHandlerParams(e,t=[]){return t.map(t=>"@EVENT"===t?e:"object"==typeof t&&null!==t?this.parseEventHandlerObject(e,t):Array.isArray(t)?this.parseEventHandlerParams(e,t):t)}parseEventHandlerObject(e,t={}){let i={};return Object.entries(t).forEach(([t,r])=>{"@EVENT"===r?i[t]=e:"object"==typeof r&&null!==r?i[t]=this.parseEventHandlerObject(e,r):Array.isArray(r)?i[t]=this.parseEventHandlerParams(e,r):i[t]=r}),i}wrapattr(){return` ${h.a.KEYS.VIEW_WRAPPER}="${this.id}"`}startWrapper(e=null,t={}){return this.wrapTag=null,"string"==typeof e?this.wrapTag=e:"object"==typeof e&&(this.wrapTag=e.tag||"div",delete e.tag,t={...t,...e.attributes},e=null),"string"!=typeof t&&t||(t={}),this.wrapTag?`<${this.wrapTag} data-wrap-view="${this.path}" data-wrap-id="${this.id}" ${Object.entries(t).map(([e,t])=>`${e}="${t}"`).join(" ")}>`:`\x3c!-- [one:view name="${this.path}" id="${this.id}"] --\x3e`}endWrapper(){return this.wrapTag?(this.wrapTag=null,`</${this.wrapTag}>`):(this.wrapTag=null,"\x3c!-- [/one:view] --\x3e")}addBlock(e,t={},i){if("string"==typeof e&&""!==e)return console.log("Add block:",e,t,i),this.App.View.section("block."+e,`\x3c!-- [one:block name="${this.path}" ref="${this.id}"] --\x3e${i}\x3c!-- [/one:block] --\x3e`,"html")}addBlockScan(e,t={},i){if("string"==typeof e&&""!==e)return this.App.View.section("block."+e,`\x3c!-- [one:block name="${this.path}" ref="${this.id}"] --\x3e${i}\x3c!-- [/one:block] --\x3e`,"html")}__block(e,t={},i){return this.addBlock(e,t,i)}__blockScan(e,t={},i){return this.addBlockScan(e,t,i)}useBlock(e,t=""){if("string"==typeof e&&""!==e)return'\x3c!-- [one:subscribe type="block" key="'+e+'"] --\x3e'+this.App.View.yield("block."+e,t)+"\x3c!-- [/one:subscribe] --\x3e"}useBlockScan(e,t=""){if("string"==typeof e&&""!==e)return`\x3c!-- [one:subscribe type="block" key="${e}"] --\x3e${this.App.View.yield("block."+e,t)}\x3c!-- [/one:subscribe] --\x3e`}mountBlock(e,t=""){return this.useBlock(e,t)}subscribeBlock(e,t=""){return' data-subscribe-block="'+e+'"'}renderFollowingBlock(e=[],t=()=>""){if(!Array.isArray(e)||0===e.length)return"";if("function"!=typeof t)return"";const i=new o({stateKeys:e,renderBlock:t,engine:this,states:this.states,App:this.App});return this.followingIDs.push(i.id),this.followingBlocks.set(i.id,i),i.render()}renderFollowingBlockScan(e=[],t=()=>""){if(!Array.isArray(e)||0===e.length)return"";if("function"!=typeof t)return"";let i=this.followingScanIndex,r=this.followingConfig[i];if(!(r||r.stateKeys==e||r.stateKeys.length==e.length&&r.stateKeys.every(t=>e.includes(t))))return"";const{id:s}=r,n=new o({renderID:s,stateKeys:e,renderBlock:t,engine:this,states:this.states,App:this.App});return n.scan(),this.followingIDs.push(n.id),this.followingBlocks.set(n.id,n),this.followingScanIndex++,""}__follow(e=[],t=()=>""){return this.renderFollowingBlock(e,t)}__followScan(e=[],t=()=>""){return this.renderFollowingBlockScan(e,t)}onFollowUpdating(){this.stopEventListener(),setTimeout(()=>{this.eventListenerStatus||this.startEventListener()},10)}onFollowUpdated(){this.eventListenerStatus||this.startEventListener()}onStateChange(e,t,i){this.changedStateKeys.add(e),this.changeStateQueueCount++,this._stateChangePending||(this._stateChangePending=!0,Promise.resolve().then(()=>{this._stateChangePending=!1,this._processStateChanges()}))}_processStateChanges(){if(this.isDestroyed)return;const e=Array.from(this.changedStateKeys);this.changedStateKeys.clear(),this.changeStateQueueCount=0,0!==e.length&&this._notifyStateChanges(e)}_notifyStateChanges(e){this.isRefreshing||(this.subscribe&&Array.isArray(this.subscribe)&&this.subscribe.length>0&&e.some(e=>this.subscribe.includes(e))&&this.refresh(),this.children&&this.children.length>0&&this.children.forEach(t=>{t.subscribe&&Array.isArray(t.subscribe)&&e.some(e=>t.subscribe.includes(e))&&t.view&&t.view._notifyStateChanges(e)}))}onStateDataChanges(){this.stateChangeData,this.stateChangeData=null}setApp(e){return this.App=e,this}setUrlPath(e){return this.urlPath=e,this}setSuperView(e){return this.superView=e,this}setParent(e){return this.parent=e,this}setOriginalView(e){return this.originalView=e,this.originalViewPath=e.path,this.originalViewId=e.id,this}addChild(e,t={}){let i=this.children.length,r={name:e.path,id:e.id,index:i,view:e,data:t,subscribe:[]};return e.setScope(r),this.children.push(r),this}removeChild(e){return this.children=this.children.filter(t=>t!==e),this}updateData(e={}){return this.data={...this.data,...e},this}updateVariableData(e={}){return"function"==typeof this.config.updateVariableData&&(this.config.updateVariableData.call(this,e),this.isCommitedConstructorData=!0),this}updateVariableItem(e,t){return"function"==typeof this.config.updateVariableItemData&&this.config.updateVariableItemData.call(this,e,t),this}setIsSuperView(e){return this.isSuperView=e,this}reset(){}}},4630:(e,t,i)=>{i.d(t,{nC:()=>s});var r=i(852);const s=new class{constructor(){if(this.http=new r.k,this.http.setHeader("Content-Type","application/json"),this.http.setHeader("Accept","application/json"),this.http.setHeader("X-Requested-With","XMLHttpRequest"),"undefined"!=typeof document){const e=document.querySelector('meta[name="csrf-token"]');e&&this.http.setHeader("X-CSRF-TOKEN",e.getAttribute("content"))}this.http.setHeader("X-DATA-TYPE","json"),this.endpoints="undefined"!=typeof window&&window.APP_CONFIGS?.api?.endpoints||{}}async getViewData(e){try{return await this.http.get(e).then(e=>e.status?e.data:{}).catch(e=>(console.error("âŒ AppAPI: Error getting view data:",e),{}))}catch(e){return console.error("âŒ AppAPI: Error getting view data:",e),{}}}async getSystemConfig(){return{}}async getSystemData(){let e=this.endpoints?.system?.data;return e?this.http.get(e).then(e=>e.status?e.data:{}).catch(e=>(console.error("âŒ AppAPI: Error getting system data:",e),{})):{}}async getURIDAta(){const e="undefined"!=typeof window?window.location.pathname+window.location.search:"/";return this.getViewData(e)}}},4877:(e,t,i)=>{i.d(t,{Ix:()=>s}),i(4476);class r{constructor(e,t,i,r={},s={}){this.$route=e,this.$urlPath=t,this.$params=i||{},this.$query=r||{},this.$fragment=s||{},this.$paramKeys=[...Object.keys(i||{})],Object.keys(i).forEach(e=>{Object.defineProperty(this,e,{get:()=>this.$params[e],set:t=>{this.$params[e]=t},enumerable:!0,configurable:!1})})}getPath(){return this.$urlPath||null}getUrlPath(){return this.$urlPath||null}getParams(){return this.$params||{}}getParam(e){return this.$params[e]||null}getQuery(){return this.$query||{}}getFragment(){return this.$fragment||{}}}class s{static activeRoute=null;static containers={};constructor(e=null){this.App=e,this.routes=[],this.currentRoute=null,this.mode="history",this.base="",this._beforeEach=null,this._afterEach=null,this.defaultRoute="/",this.handleRoute=this.handleRoute.bind(this),this.handlePopState=this.handlePopState.bind(this),this.routeConfigs={},this.currentUri=window.location.pathname+window.location.search}setApp(e){return this.App=e,this}addRouteConfig(e){this.routeConfigs[e.name]=e}setAllRoutes(e){for(const t of e)this.addRouteConfig(t)}getURL(e,t={}){const i=this.routeConfigs[e];if(!i)return null;let r=this.generateUrl(i.path,t);return r.startsWith("/")||r.startsWith("http:")||r.startsWith("https:")||(r=this.base+r),r}addRoute(e,t,i={}){this.routes.push({path:this.normalizePath(e),view:t,options:i})}setMode(e){this.mode=e}setBase(e){this.base=e}setDefaultRoute(e){this.defaultRoute=e}beforeEach(e){this._beforeEach=e}afterEach(e){this._afterEach=e}normalizePath(e){let t=e.startsWith("/")?e:"/"+e;return t.length>1&&t.endsWith("/")&&(t=t.slice(0,-1)),""===t&&(t="/"),t}matchFormat(e,t){let i=t.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1");return i=i.replace(/\{[a-zA-Z0-9_]+\}/g,"([^\\/\\-.]+)"),i="^"+i+"$",new RegExp(i).test(e)}hasParameter(e){return/\{[a-zA-Z0-9_]+\}/.test(e)}isAnyParameter(e){return e.includes("*")||"{any}"===e.toLowerCase()}getParameterName(e){var t=/\{([a-zA-Z0-9_]+)\}/.exec(e);return t&&t[1]?t[1]:null}getParameterValue(e,t){if("string"!=typeof t||"string"!=typeof e)return null;if(e.match(/^\{[a-zA-Z0-9_]+\}$/))return t;let i=e.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1");i=i.replace(/\{[a-zA-Z0-9_]+\}/g,"([^\\/\\-.]+)");const r=new RegExp("^"+i+"$").exec(t);return r&&r[1]?r[1]:null}getAnyParameterValue(e,t){if("string"==typeof e&&e.includes("*")&&(e=e.replace(/\*/g,"{any}")),"string"!=typeof t||"string"!=typeof e)return null;let i=e.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1");i=i.replace(/\{[a-zA-Z0-9_]+\}/g,"([^\\/\\-.]+)");const r=new RegExp("^"+i+"$").exec(t);return r&&r[1]||null}checkParameterRoute(e,t){const i=this.App.Helper.trim(e.path,"/").split("/"),r=this.App.Helper.trim(t,"/").split("/");if(i.length!==r.length)return console.log("âŒ Different number of segments"),null;const s=i.length-1,n={};for(let e=0;e<i.length;e++){const t=i[e],a=r[e];if(this.isAnyParameter(t)){const i=this.getAnyParameterValue(t,a);if(n.any=i,e===s&&0===e)return n}else if(this.hasParameter(t)){const e=this.getParameterName(t),i=this.getParameterValue(t,a);if(null===i)return console.log("âŒ Parameter value is null"),null;n[e]=i}else if(t!==a)return console.log("âŒ Exact match failed"),null}return n}matchRoute(e){const t=this.normalizePath(e);for(const e of this.routes){const i=e.path;if(i.split("/").some(e=>this.hasParameter(e)||this.isAnyParameter(e))){const i=this.checkParameterRoute(e,t);if(null!==i)return{route:e,params:i,path:t}}else if(i===t)return{route:e,params:{},path:t}}return null}async handleRoute(e,t=!1){const i=e.split("?")[0],r=this.matchRoute(i);if(!r)return void console.warn(`No route found for: ${e}`);const{route:n,params:a}=r;if(this._beforeEach&&!1===await this._beforeEach(n,a))return;const o=s.getUrlParts(),l=o.query,h=o.hash;t||s.addActiveRoute(n,r.path,a,l,h),this.currentRoute={...n,$params:a,$query:l,$fragment:h,$urlPath:r.path},this.App.View&&(n.view||n.component)&&this.App.View.mountView(n.view||n.component,a,s.getActiveRoute()),this._afterEach&&this._afterEach(n,a)}async hydrateViews(){if(console.log("ðŸš€ Router.hydrateViews: Starting hydration of server-rendered views..."),!this.App?.View)return void console.error("âŒ Router.hydrateViews: App.View not available");const e=s.activeRoute||this.currentRoute;if(!e)return void console.error("âŒ Router.hydrateViews: No active route found");const{$route:t,$params:i,$urlPath:r,$query:n,$fragment:a}=e;if(this._beforeEach&&!1===await this._beforeEach(t,i,r))console.log("ðŸš« Router.hydrateViews: Cancelled by beforeEach hook");else if(t.view||t.component)try{const r=t.view||t.component;this.App.View.mountViewScan(r,i,e),this._afterEach&&this._afterEach(t,i)}catch(e){console.error("âŒ Router.hydrateViews: Error during hydration:",e)}}handlePopState(e){const t=window.location.pathname+window.location.search;this.handleRoute(t)}navigate(e){if("history"===this.mode){window.history.pushState({},"",e);try{this.handleRoute(e),this.currentUri=e}catch(e){console.error("âŒ Router.navigate handleRoute error:",e)}}else{window.location.hash=e;try{this.handleRoute(e),this.currentUri=e}catch(e){console.error("âŒ Router.navigate handleRoute (hash mode) error:",e)}}}generateUrl(e,t={},i=""){let r=e;for(const[e,i]of Object.entries(t))r=r.replace(`{${e}}`,i);return i&&!r.endsWith(i)&&(r+=i),r}navigateTo(e,t={},i=""){const r=this.generateUrl(e,t,i);this.navigate(r)}start(e=!1){const t=this.App?.View?.detectServerRendered?.()||!1,i=(s.getUrlParts(),"history"===this.mode?window.location.pathname+window.location.search:window.location.hash.substring(1)||this.defaultRoute);console.log("ðŸ” Router.start: Detected SSR:",t),this.setActiveRouteForCurrentPath(i),"history"===this.mode?window.addEventListener("popstate",this.handlePopState):window.addEventListener("hashchange",this.handlePopState),t?(console.log("ðŸš€ Router.start: Starting SSR hydration..."),this.hydrateViews()):e?console.log("ðŸ” Router.start: Skipping initial route handling"+("history"===this.mode?"":"( hash)")+" but activeRoute is set"):(console.log("ðŸš€ Router.start: Starting CSR rendering..."),this.handleRoute(i)),this.setupAutoNavigation()}stop(){"history"===this.mode?window.removeEventListener("popstate",this.handlePopState):window.removeEventListener("hashchange",this.handlePopState),document.removeEventListener("click",this._autoNavHandler)}setActiveRouteForCurrentPath(e){const t=e.split("?")[0],i=this.matchRoute(t);if(i){const{route:e,params:t}=i,r=s.getUrlParts(),n=r.query,a=r.hash;s.addActiveRoute(e,i.path,t,n,a),this.currentRoute={...e,$params:t,$query:n,$fragment:a,$urlPath:i.path}}else console.log("âŒ No matching route found for current path:",e)}setupAutoNavigation(){console.log("ðŸ” setupAutoNavigation called"),this._autoNavHandler=this.handleAutoNavigation.bind(this),document.addEventListener("click",this._autoNavHandler),console.log("âœ… Auto-navigation setup complete - event listener added")}handleAutoNavigation(e){const t=e.target.closest("[data-nav-link]");if(t){if(t.hasAttribute("data-nav-disabled"))return void console.log("ðŸš« Skipping disabled data-nav-link element");const i=t.getAttribute("data-nav-link");if(console.log("ðŸ” navPath:",i),i&&""!==i.trim())return console.log("ðŸ”— Auto-navigating via data-nav-link attribute:",i),e.preventDefault(),i===this.currentUri?void console.log("ðŸš« Same path - no navigation needed:",i):void this.navigate(i)}const i=e.target.closest("a[href]");if(!i)return;if("_blank"===i.target)return void console.log('ðŸš« Skipping external link with target="_blank":',i.href);if("disabled"===i.dataset.nav||"false"===i.getAttribute("data-nav"))return void console.log("ðŸš« Skipping disabled link:",i.href);if("false"===i.dataset.nav)return void console.log("ðŸš« Skipping explicitly disabled link:",i.href);if(i.href.startsWith("mailto:")||i.href.startsWith("tel:")||i.href.startsWith("javascript:"))return void console.log("ðŸš« Skipping special protocol link:",i.href);const r=i.href;try{const e=new URL(r),t=new URL(window.location.href);if(e.host!==t.host)return void console.log("ðŸš« Skipping external domain link:",r)}catch(e){console.log("âš ï¸ URL parsing failed, treating as internal:",r)}if(r.startsWith("http://")||r.startsWith("https://"))try{const t=new URL(r),i=new URL(window.location.href);if(t.host===i.host){const i=t.pathname+t.search;return console.log("ðŸ”— Auto-navigating to same domain URL:",i),e.preventDefault(),i===this.currentUri?void console.log("ðŸš« Same path - no navigation needed:",i):void this.navigate(i)}}catch(e){console.log("âš ï¸ URL parsing failed for full URL:",r)}if(r&&!r.startsWith("http")&&!r.startsWith("//"))return console.log("ðŸ”— Auto-navigating to relative URL:",r),e.preventDefault(),r===this.currentUri?void console.log("ðŸš« Same path - no navigation needed:",r):void this.navigate(r);console.log("ðŸš« Skipping unsupported link format:",r)}static getUrlParts(){const{location:e}=window,{search:t,hash:i,pathname:r}=e;return{url:e.href,protocol:e.protocol,search:t.startsWith("?")?t.substring(1):t,path:r,query:Object.fromEntries(new URLSearchParams(t)),hash:i.startsWith("#")?i.substring(1):i}}static addActiveRoute(e,t,i,n={},a=null){e.path&&(s.containers[e.path]?(s.containers[e.path].$urlPath=t,s.containers[e.path].$params=i,s.containers[e.path].$query=n,s.containers[e.path].$fragment=a,s.activeRoute=s.containers[e.path]):(s.containers[e.path]=new r(e,t,i,n,a),s.activeRoute=s.containers[e.path]))}static getCachedRoute(e){return s.containers[e]||null}static getCurrentRoute(){return s.activeRoute||null}static getActiveRoute(){return s.activeRoute||null}static getCurrentPath(){return window.location.pathname}static getCurrentUri(){return"history"===this.mode?s.getCurrentPath():s.getCurrentHash()}static getCurrentHash(){return window.location.hash.substring(1)||""}static getCurrentUrl(){return"history"===this.mode?s.getCurrentPath()+window.location.search:s.getCurrentHash()}static getCurrentQuery(){return Object.fromEntries(new URLSearchParams(window.location.search))}static getCurrentFragment(){return window.location.hash.substring(1)||""}}},5276:(e,t,i)=>{i.d(t,{P:()=>s});var r=i(3696);class s{constructor(e){this._viewRef=e,this._states=[],this._stateIndex=0,this._canUpdateStateByKey=!0,this.__listeners=new Map,this.__ownProperties=["_states","_stateIndex","_stateMap","_canUpdateStateByKey","_viewRef","__listeners","__ownProperties","__ownMethods"],this.__ownMethods=["__commitStateChange","__setState","__useState","__updateStateByKey","__register","__lockUpdateRealState","__subscribe","__toJSON","toJSON","toString"],Object.defineProperty(this,"on",{value:(e,t)=>this.__subscribe(e,t),writable:!0,configurable:!0,enumerable:!1}),Object.defineProperty(this,"off",{value:(e,t)=>this.__unsubscribe(e,t),writable:!0,configurable:!0,enumerable:!1})}__commitStateChange(e,t,i=null){const r=this.__listeners.get(this._stateMap[e]);r&&r.forEach(i=>i(this._states[e][0],t)),this._viewRef}__setState(e,t,i=()=>{},r=null){return this._states[e]=[t,i,r??e],[t,i,r??e]}__useState(e,t=null){const i=this._stateIndex++,s=t??i,n=e=>{const t=this._states[i][0];this._states[i][0]=e,this.__commitStateChange(i,t,s)};return this.__setState(i,e,n,s),this.__ownProperties.includes(s)||this.__ownMethods.includes(s)||Object.defineProperty(this,s,{get:()=>this._states[i][0],set:e=>{r.Ay.log("Báº¡n khÃ´ng thá»ƒ thiáº¿t láº­p giÃ¡ trá»‹ cho "+s+" theo cÃ¡ch nÃ y")},configurable:!1,enumerable:!0}),[e,n,s]}__updateStateByKey(e,t){const i=this._states.findIndex(t=>t[2]===e);if(-1!==i){if(!this._canUpdateStateByKey)return this._states[i][0];this._states[i][0]=t,this.__commitStateChange(i)}return t}__register(e,t){return this.__useState(t,e)[1]}__lockUpdateRealState(){this._canUpdateStateByKey=!1}__subscribe(e,t){if("string"!=typeof e||this.__ownProperties.includes(e)||this.__ownMethods.includes(e))return!1;if(t&&"function"!=typeof t)throw new Error("Callback must be a function");this.__listeners.has(e)||this.__listeners.set(e,[]),this.__listeners.get(e).push(t);let i=this.__listeners.get(e).length-1;return()=>{this.__listeners.get(e).splice(i,1),0===this.__listeners.get(e).length&&this.__listeners.delete(e)}}__unsubscribe(e,t=null){if(!("string"!=typeof e||this.__ownProperties.includes(e)||this.__ownMethods.includes(e)||t&&"function"!=typeof t))if(t){let i=this.__listeners.get(e).indexOf(t);-1!==i&&(this.__listeners.get(e).splice(i,1),0===this.__listeners.get(e).length&&this.__listeners.delete(e))}else this.__listeners.delete(e)}__reset(){this._stateIndex=0,this._canUpdateStateByKey=!0,this.__listeners.clear()}__toJSON(){const e={};return this._states.forEach((t,i)=>{e[this._stateMap[i]]=t[0]}),e}toJSON(){return this.__toJSON()}toString(){return JSON.stringify(this.__toJSON())}}},6143:(e,t,i)=>{i.d(t,{Fj:()=>o,Ay:()=>l});var r=i(499);class s{constructor(e=document.body){this.rootElement=e,this.cachedComments=null}setRootElement(e){return this.rootElement=e,this.cachedComments=null,this}getAllComments(e=!0){if(e&&this.cachedComments)return this.cachedComments;const t=[],i=document.createTreeWalker(this.rootElement,NodeFilter.SHOW_COMMENT,null,!1);let r;for(;r=i.nextNode();)t.push(r);return e&&(this.cachedComments=t),t}parseComment(e){const t=e.nodeValue.trim(),i=t.match(/^\[([^\/\]]+?)(?:\s+(.+))?\]$/);if(i){const t=i[1],r={};if(i[2]){const e=i[2].match(/(\w+)="([^"]+)"/g);e&&e.forEach(e=>{const[t,i]=e.split("=");r[t]=i.replace(/"/g,"")})}return{type:"open",fullName:t,attributes:r,node:e}}const r=t.match(/^\[\/([^\/\]]+?)\]$/);return r?{type:"close",fullName:r[1],node:e}:null}getNodesBetween(e,t){if(e.parentNode!==t.parentNode)return null;const i=[];let r=e.nextSibling;for(;r&&r!==t;)i.push(r),r=r.nextSibling;return i}patternToRegex(e){if(!e||"*"===e||"*:*"===e)return/.*/;let t=e.replace(/[.+?^${}()|[\]\\]/g,"\\$&").replace(/\*/g,".*");return t="^"+t+"$",new RegExp(t)}matchPattern(e,t){return this.patternToRegex(t).test(e)}find(e="*:*",t={}){const{useCache:i=!0}=t,r=this.getAllComments(i).map(e=>this.parseComment(e)).filter(e=>null!==e),s=[],n=[];for(let t=0;t<r.length;t++){const i=r[t];if(this.matchPattern(i.fullName,e))if("open"===i.type)n.push({...i,index:t});else if("close"===i.type){let e=-1;for(let t=n.length-1;t>=0;t--)if(n[t].fullName===i.fullName){e=t;break}if(-1!==e){const t=n[e],r=this.getNodesBetween(t.node,i.node);null!==r&&s.push({fullName:i.fullName,openTag:t.node,closeTag:i.node,attributes:t.attributes,nodes:r,parent:t.node.parentNode}),n.splice(e,1)}}}return s}findOne(e){const t=this.find(e);return t.length>0?t[0]:null}filter(e,t="*:*"){return this.find(t).filter(e)}count(e="*:*"){return this.find(e).length}getUniqueNames(e="*:*"){const t=this.find(e);return[...new Set(t.map(e=>e.fullName))]}display(e,t={}){const{showAttributes:i=!0,showParent:r=!0,showNodes:s=!0,maxNodePreview:n=3}=t;let a,o="";"string"==typeof e?(o=` vá»›i pattern "${e}"`,a=this.find(e)):a=e,console.log(`\n${"=".repeat(80)}`),console.log(`TÃ¬m tháº¥y ${a.length} cáº·p tags${o}`),console.log(`${"=".repeat(80)}\n`),0!==a.length?(a.forEach((e,t)=>{console.log(`\nðŸ“¦ Cáº·p ${t+1}: [${e.fullName}]`),console.log("-".repeat(60)),i&&console.log("ðŸ“‹ Attributes:",Object.keys(e.attributes).length>0?e.attributes:"(khÃ´ng cÃ³)"),r&&console.log("ðŸ”¼ Parent:",e.parent.tagName.toLowerCase(),e.parent.className?`class="${e.parent.className}"`:""),s&&(console.log(`ðŸ“„ Ná»™i dung (${e.nodes.length} nodes):`),e.nodes.slice(0,n).forEach(e=>{if(e.nodeType===Node.ELEMENT_NODE){const t=e.className?` class="${e.className}"`:"";console.log(`   â”œâ”€ <${e.tagName.toLowerCase()}${t}>`)}else if(e.nodeType===Node.TEXT_NODE&&e.nodeValue.trim()){const t=e.nodeValue.trim().substring(0,50);console.log(`   â”œâ”€ Text: "${t}${t.length>=50?"...":""}"`)}}),e.nodes.length>n&&console.log(`   â””â”€ ... vÃ  ${e.nodes.length-n} nodes khÃ¡c`))}),console.log(`\n${"=".repeat(80)}\n`)):console.log("âŒ KhÃ´ng tÃ¬m tháº¥y cáº·p tags nÃ o!")}clearCache(){return this.cachedComments=null,this}}class n{constructor(e,t,i,r={},s=[]){this.__openTag=t,this.__closeTag=i,this.__attributes=r,this.__nodes=s,this.__definedAttributes=[],this.__tagName=e.split(":")[1],this.__fullName=e,this.__defineAttributes(Object.keys(r))}__update(e,t,i,r={},s=[]){return this.__openTag=t,this.__closeTag=i,this.__attributes=r,this.__nodes=s,this.__tagName=e.split(":")[1],this.__fullName=e,this.__defineAttributes(Object.keys(r)),this}__defineAttributes(e=[]){for(let t=0;t<e.length;t++){const i=e[t];this.__defineAttribute(i)}return this}__defineAttribute(e){return this.__definedAttributes.includes(e)||(this.__definedAttributes.push(e),(0,r.XN)(this,e,{set:t=>(this.__attributes[e]=t,t),get:()=>this.__attributes[e]})),this}get tagName(){return this.__tagName}set tagName(e){return this}get fullName(){return this.__fullName}set fullName(e){return this}get openTag(){return this.__openTag}get closeTag(){return this.__closeTag}get attributes(){return this.__attributes}get nodes(){return this.__nodes}getAttribute(e){return this.__attributes[e]}setAttribute(e,t){return this.__defineAttribute(e),this.__attributes[e]=t,this}__match(e={}){let t=Object.keys(e);for(let i=0;i<t.length;i++){const r=t[i],s=e[r];if("tagName"!==r){if("openTag"!==r){if("closeTag"!==r){if("attributes"!==r&&"nodes"!==r&&this.__attributes[r]!==s)return!1}else if(this.__closeTag!==s)return!1}else if(this.__openTag!==s)return!1}else if(this.__tagName!==s)return!1}return!0}__scan(){const e=[];let t=this.__openTag.nextSibling;for(;t&&t!==this.__closeTag;)e.push(t),t=t.nextSibling;return this.__nodes.length=0,this.__nodes.push(...e),this.__nodes}updateNodes(e=[]){return this.__nodes=e,this}}class a{constructor(e=[]){this.__models=e.map(e=>e instanceof n?e:new n(e.fullName,e.openTag,e.closeTag,e.attributes,e.nodes))}get models(){return this.__models}get length(){return this.__models.length}get first(){return this.__models[0]}get last(){return this.__models[this.__models.length-1]}push(e){return e instanceof n||(e=new n(e.fullName,e.openTag,e.closeTag,e.attributes,e.nodes)),this.__models.push(e),this}pop(){return this.__models.pop()}shift(){return this.__models.shift()}unshift(e){return e instanceof n||(e=new n(e.fullName,e.openTag,e.closeTag,e.attributes,e.nodes)),this.__models.unshift(e),this}splice(e,t,...i){return i instanceof a||(i=new a(i)),this.__models.splice(e,t,...i.__models),this}slice(e,t){return this.__models.slice(e,t)}concat(e){return e instanceof a||(e=new a(e)),new a(this.__models.concat(e.__models))}reverse(){return new a(this.__models.reverse())}get(e){return this.__models[e]}set(e,t){return this.__models[e]=t,this}map(e){return this.__models.map(e)}filter(e){return this.__models.filter(e)}reduce(e,t){return this.__models.reduce(e,t)}forEach(e){return this.__models.forEach(e)}some(e){return this.__models.some(e)}every(e){return this.__models.every(e)}query(e={}){return this.__models.filter(t=>t.__match(e))}find(e={}){return this.query(e)[0]||null}}const o=new class{constructor(){this.detector=new s(document.documentElement)}find(e="*",t={},i={},s=!1){(0,r.AO)(this,"useCache")||(i.useCache=!1);const o=this.detector.find("one:"+e,i),l=s&&"number"==typeof s&&s>0,h=s&&-1===s,c=s&&1===s;if(0===o.length)return h||l&&1==s?null:new a([]);if("object"!=typeof t||null===t||0===Object.keys(t).length){if(h){const e=o[o.length-1];return new n(e.fullName,e.openTag,e.closeTag,e.attributes,e.nodes)}return l?1==s?new n(o[0].fullName,o[0].openTag,o[0].closeTag,o[0].attributes,o[0].nodes):new a(o.slice(0,s)):new a(o)}const u=Object.keys(t),d=[],p=o.length,g=p-1;for(let e=0;e<p;e++){if(h&&e<g)continue;const i=o[e];let r=!0;for(let e=0;e<u.length;e++){const s=u[e],n=t[s];if(i.attributes[s]!==n){r=!1;break}}if(r){if(c)return new n(i.fullName,i.openTag,i.closeTag,i.attributes,i.nodes);if(h&&e===g)return new n(i.fullName,i.openTag,i.closeTag,i.attributes,i.nodes);if(d.push(i),l&&d.length>=s)return new a(d)}}return new a(d)}first(e="*",t={},i={}){return this.find(e,t,i,1)}},l=o},7611:(e,t,i)=>{i.d(t,{a:()=>s,p:()=>n});const r="data-",s={PREFIX:{BASE:r,YIELD:`${r}yield-`,CLICK:`${r}click-`,DBLCLICK:`${r}dblclick-`,MOUSEDOWN:`${r}mousedown-`,MOUSEUP:`${r}mouseup-`,MOUSEOVER:`${r}mouseover-`,MOUSEOUT:`${r}mouseout-`,MOUSEMOVE:`${r}mousemove-`,MOUSEENTER:`${r}mouseenter-`,MOUSELEAVE:`${r}mouseleave-`,WHEEL:`${r}wheel-`,AUXCLICK:`${r}auxclick-`,KEYDOWN:`${r}keydown-`,KEYUP:`${r}keyup-`,KEYPRESS:`${r}keypress-`,INPUT:`${r}input-`,CHANGE:`${r}change-`,SUBMIT:`${r}submit-`,RESET:`${r}reset-`,INVALID:`${r}invalid-`,SEARCH:`${r}search-`,FOCUS:`${r}focus-`,BLUR:`${r}blur-`,FOCUSIN:`${r}focusin-`,FOCUSOUT:`${r}focusout-`,SELECT:`${r}select-`,SELECTSTART:`${r}selectstart-`,SELECTIONCHANGE:`${r}selectionchange-`,TOUCHSTART:`${r}touchstart-`,TOUCHMOVE:`${r}touchmove-`,TOUCHEND:`${r}touchend-`,TOUCHCANCEL:`${r}touchcancel-`,DRAGSTART:`${r}dragstart-`,DRAG:`${r}drag-`,DRAGEND:`${r}dragend-`,DRAGENTER:`${r}dragenter-`,DRAGLEAVE:`${r}dragleave-`,DRAGOVER:`${r}dragover-`,DROP:`${r}drop-`,PLAY:`${r}play-`,PAUSE:`${r}pause-`,ENDED:`${r}ended-`,LOADSTART:`${r}loadstart-`,LOADEDDATA:`${r}loadeddata-`,LOADEDMETADATA:`${r}loadedmetadata-`,CANPLAY:`${r}canplay-`,CANPLAYTHROUGH:`${r}canplaythrough-`,WAITING:`${r}waiting-`,SEEKING:`${r}seeking-`,SEEKED:`${r}seeked-`,RATECHANGE:`${r}ratechange-`,DURATIONCHANGE:`${r}durationchange-`,VOLUMECHANGE:`${r}volumechange-`,SUSPEND:`${r}suspend-`,STALLED:`${r}stalled-`,PROGRESS:`${r}progress-`,EMPTIED:`${r}emptied-`,ENCRYPTED:`${r}encrypted-`,WAKEUP:`${r}wakeup-`,LOAD:`${r}load-`,UNLOAD:`${r}unload-`,BEFOREUNLOAD:`${r}beforeunload-`,RESIZE:`${r}resize-`,SCROLL:`${r}scroll-`,ORIENTATIONCHANGE:`${r}orientationchange-`,VISIBILITYCHANGE:`${r}visibilitychange-`,PAGEHIDE:`${r}pagehide-`,PAGESHOW:`${r}pageshow-`,POPSTATE:`${r}popstate-`,HASHCHANGE:`${r}hashchange-`,ONLINE:`${r}online-`,OFFLINE:`${r}offline-`,DOMCONTENTLOADED:`${r}DOMContentLoaded-`,READYSTATECHANGE:`${r}readystatechange-`,ERROR:`${r}error-`,ABORT:`${r}abort-`,CONTEXTMENU:`${r}contextmenu-`,ANIMATIONSTART:`${r}animationstart-`,ANIMATIONEND:`${r}animationend-`,ANIMATIONITERATION:`${r}animationiteration-`,TRANSITIONSTART:`${r}transitionstart-`,TRANSITIONEND:`${r}transitionend-`,TRANSITIONRUN:`${r}transitionrun-`,TRANSITIONCANCEL:`${r}transitioncancel-`,POINTERDOWN:`${r}pointerdown-`,POINTERUP:`${r}pointerup-`,POINTERMOVE:`${r}pointermove-`,POINTEROVER:`${r}pointerover-`,POINTEROUT:`${r}pointerout-`,POINTERENTER:`${r}pointerenter-`,POINTERLEAVE:`${r}pointerleave-`,POINTERCANCEL:`${r}pointercancel-`,GOTPOINTERCAPTURE:`${r}gotpointercapture-`,LOSTPOINTERCAPTURE:`${r}lostpointercapture-`,FULLSCREENCHANGE:`${r}fullscreenchange-`,FULLSCREENERROR:`${r}fullscreenerror-`,COPY:`${r}copy-`,CUT:`${r}cut-`,PASTE:`${r}paste-`,GAMEPADCONNECTED:`${r}gamepadconnected-`,GAMEPADDISCONNECTED:`${r}gamepaddisconnected-`,BATTERYCHARGINGCHANGE:`${r}batterychargingchange-`,BATTERYLEVELCHANGE:`${r}batterylevelchange-`,DEVICEORIENTATION:`${r}deviceorientation-`,DEVICEMOTION:`${r}devicemotion-`,DEVICELIGHT:`${r}devicelight-`,DEVICEPROXIMITY:`${r}deviceproximity-`,WEBGLCONTEXTLOST:`${r}webglcontextlost-`,WEBGLCONTEXTRESTORED:`${r}webglcontextrestored-`,VIEW:`${r}view-`},KEYS:{VIEW:`${r}view`,VIEW_ID:`${r}view-id`,VIEW_REF:`${r}view-ref`,VIEW_SECTION_REF:`${r}view-section-ref`,VIEW_RESOURCE:`${r}view-resource`,VIEW_STYLE:`${r}view-style`,VIEW_WRAPPER:`${r}view-wrapper`,YIELD_ATTR:`${r}yield-attr`,YIELD_CONTENT:`${r}yield-content`,YIELD_CHILDREN:`${r}yield-children`,YIELD_SUBSCRIBE:`${r}yield-subscribe`,YIELD_SUBSCRIBE_ATTR:`${r}yield-subscribe-attr`,YIELD_SUBSCRIBE_CONTENT:`${r}yield-subscribe-content`,YIELD_SUBSCRIBE_CHILDREN:`${r}yield-subscribe-children`},CLASSNAME:{BASE:r,VIEW_ERROR:`${r}view-error`,VIRTUAL_CONTAINER:`${r}virtual-container`,SECTION_ERROR:`${r}section-error`},prefix:e=>s.PREFIX[e.toUpperCase()]||r+e,key:e=>s.KEYS[e.toUpperCase()]||r+e,className:e=>s.CLASSNAME[e.toUpperCase()]||r+e.toLowerCase().replace(/_/g,"-")},n=["init","destroy","beforeInit","afterInit","beforeDestroy","destroyed","loadServerData","render","prerender","insertResources","removeResources","setMaster","setApp","addChild","removeChild","remove","setParent","parent","master","beforeCreate","created","beforeUpdate","updated","beforeMount","mounted","beforeUnmount","unmounted","renderLongSections","renderSections","prerenderSections","data","scope","subscribe","updateVariableItem","updateVariableData"]},8544:(e,t,i)=>{i.d(t,{A:()=>r});const r=class{static validateElement(e){if(!(e instanceof Element||e instanceof Comment))throw new Error("Provided value is not a valid DOM Element");return!0}static toFragment(e){const t=document.createDocumentFragment(),i=e=>{if(e)if("string"==typeof e){const i=document.createElement("template");i.innerHTML=e.trim(),t.appendChild(i.content)}else e instanceof Element||e instanceof DocumentFragment?t.appendChild(e):Array.isArray(e)||e instanceof NodeList?e.forEach(i):console.warn("Unsupported content type:",e)};return i(e),t}static before(e,t){if(!(e instanceof Element||e instanceof Comment))throw new Error("Target must be a DOM element");e.parentNode.insertBefore(this.toFragment(t),e)}static after(e,t){if(!(e instanceof Element||e instanceof Comment))throw new Error("Target must be a DOM element");const i=this.toFragment(t);e.nextSibling?e.parentNode.insertBefore(i,e.nextSibling):e.parentNode.appendChild(i)}static replace(e,t){if(!(e instanceof Element||e instanceof Comment))throw new Error("Target must be a DOM element");e.replaceWith(this.toFragment(t))}static append(e,t){if(!(e instanceof Element))throw new Error("Target must be a DOM element");e.appendChild(this.toFragment(t))}static prepend(e,t){if(!(e instanceof Element))throw new Error("Target must be a DOM element");e.firstChild?e.insertBefore(this.toFragment(t),e.firstChild):e.appendChild(this.toFragment(t))}static setHTML(e,t){if(!(e instanceof Element))throw new Error("Target must be a DOM element");e.innerHTML="",e.appendChild(this.toFragment(t))}static replaceContent(e,t){if(!(e instanceof Element))throw new Error("Target must be a DOM element");e.innerHTML="",e.appendChild(this.toFragment(t))}static content(e,t){if(void 0===t){if(!(e instanceof Element))throw new Error("Target must be a DOM element");return e.innerHTML}this.setHTML(e,t)}static children(e,t=null){if(!(e instanceof Element))throw new Error("Target must be a DOM element");if(null==t)return Array.from(e.children);e.innerHTML="",e.appendChild(this.toFragment(t))}}}}]);
//# sourceMappingURL=core.js.map