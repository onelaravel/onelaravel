"use strict";(Object("undefined"!=typeof self?self:this).webpackChunkApp=Object("undefined"!=typeof self?self:this).webpackChunkApp||[]).push([[215],{19:(e,t,i)=>{i.d(t,{j:()=>w});var s=i(693),n=i(780),r=i(430),a=i(796),o=i(724),h=i(107),l=i(568),c=i(741),d=i(179),u=i(639),p=i(647),f=i(690),g=i(618),_=i(32),m=i(76),E=i(317);const w={"components.tset":s.T,"web.docs":n.o,"web.about":r.E,"web.home":a._,"web.examples":o.y,"web.contact":h.b,"layouts.test-layout":l.G,"layouts.base-backup":c.n,"layouts.base":d.J,"layouts.base-with-view-id":u.r,"layouts.admin":p.l,"layouts.base-old":f.i,"partials.test-partial":g.G,"partials.assets-scripts":_.e,"partials.footer":m.w,"partials.data-example":E.z}},276:(e,t,i)=>{i.d(t,{P:()=>n});var s=i(696);class n{constructor(e){this._viewRef=e,this._states=[],this._stateIndex=0,this._canUpdateStateByKey=!0,this.__listeners=new Map,this.__ownProperties=["_states","_stateIndex","_canUpdateStateByKey","_viewRef","__listeners","__ownProperties","__ownMethods","__setters__"],this.__ownMethods=["__commitStateChange","__setState","__useState","__updateStateByKey","__register","__lockUpdateRealState","__subscribe","__toJSON","toJSON","toString"],this.__setters__={},Object.defineProperty(this,"on",{value:(e,t)=>this.__subscribe(e,t),writable:!0,configurable:!0,enumerable:!1}),Object.defineProperty(this,"off",{value:(e,t)=>this.__unsubscribe(e,t),writable:!0,configurable:!0,enumerable:!1})}__commitStateChange(e,t,i=null){let s=i||(this._states[e]?this._states[e][2]:e);const n=this.__listeners.get(s);n&&n.forEach(i=>i(this._states[e][0],t)),this._viewRef}__setState(e,t,i=()=>{},s=null){return this._states[e]=[t,i,s??e],[t,i,s??e]}__useState(e,t=null){const i=this._stateIndex++,n=t??i,r=e=>{const t=this._states[i][0];this._states[i][0]=e,this.__commitStateChange(i,t,n)};return this.__setState(i,e,r,n),this.__ownProperties.includes(n)||this.__ownMethods.includes(n)||Object.defineProperty(this,n,{get:()=>this._states[i][0],set:e=>{s.Ay.log("Báº¡n khÃ´ng thá»ƒ thiáº¿t láº­p giÃ¡ trá»‹ cho "+n+" theo cÃ¡ch nÃ y")},configurable:!1,enumerable:!0}),[e,r,n]}__updateStateByKey(e,t){const i=this._states.findIndex(t=>t[2]===e);if(s.Ay.log(`Updating state by key: ${e} at index: ${i} with value:`,t),-1!==i){if(!this._canUpdateStateByKey)return s.Ay.log(`State updates are locked for key: ${e}`),this._states[i][0];const n=this._states[i][0];this._states[i][0]=t,this.__commitStateChange(i,n,e)}else s.Ay.warn(`State key not found: ${e}`);return t}__register(e,t){return this.__useState(t,e)[1]}__lockUpdateRealState(){this._canUpdateStateByKey=!1}__subscribe(e,t){if("string"!=typeof e||this.__ownProperties.includes(e)||this.__ownMethods.includes(e))return!1;if(t&&"function"!=typeof t)throw new Error("Callback must be a function");this.__listeners.has(e)||this.__listeners.set(e,[]),this.__listeners.get(e).push(t);let i=this.__listeners.get(e).length-1;return()=>{this.__listeners.get(e).splice(i,1),0===this.__listeners.get(e).length&&this.__listeners.delete(e)}}__unsubscribe(e,t=null){if(!("string"!=typeof e||this.__ownProperties.includes(e)||this.__ownMethods.includes(e)||t&&"function"!=typeof t))if(t){let i=this.__listeners.get(e).indexOf(t);-1!==i&&(this.__listeners.get(e).splice(i,1),0===this.__listeners.get(e).length&&this.__listeners.delete(e))}else this.__listeners.delete(e)}__reset(){this._stateIndex=0,this._canUpdateStateByKey=!0,this.__listeners.clear()}__toJSON(){const e={};return this._states.forEach((t,i)=>{const s=t[2];e[s]=t[0]}),e}toJSON(){return this.__toJSON()}toString(){return JSON.stringify(this.__toJSON())}}},479:(e,t,i)=>{i.d(t,{I:()=>l});var s=i(499),n=i(400),r=i(734),a=i(276),o=i(696),h=i(611);class l{constructor(e,t){this.App=null,this.isSuperView=!1,this._emptyFn=()=>{},this.id=null,this.init=this._emptyFn,this.parent=null,this.children=[],this.superView=null,this.superViewPath=null,this.superViewId=null,this.hasSuperView=!1,this.originalViewPath=null,this.originalViewId=null,this.originalView=null,this.hasAwaitData=!1,this.hasFetchData=!1,this.fetch={},this.usesVars=!1,this.hasSections=!1,this.renderLongSections=[],this.hasSectionPreload=!1,this.hasPrerender=!1,this.sections={},this.addCSS=this._emptyFn,this.removeCSS=this._emptyFn,this.resources=[],this.userDefined={},this.events={},this.eventIndex=0,this.eventHandlers={},this.data={},this.states={},this.urlPath="",this.isInitlized=!1,this.wrapperConfig={enable:!1,tag:null,follow:!0,attributes:{},..."object"==typeof t?.wrapperConfig?t.wrapperConfig:{}},this.templateEngine=null,this.path=e,this.config=t||{},this.wrapTag=null,this.followingBlocks=new Map,this.followingConfig=[],this.followingIndex=0,this.followingScanIndex=0,this.followingIDs=[],this.followingPrerenderIDs=[],this.followingRenderIDs=[],this.subscribeStates=!0,this.childrenConfig=[],this.childrenIndex=0,this.refreshChildrenIndex=0,this.isRendering=!1,this.isRendered=!1,this.isMounted=!1,this.isDestroyed=!1,this.isScanning=!1,this.isScanned=!1,this.isReady=!1,this.markup=null,this.refElements=[],this.eventListenerStatus=!1,this.eventListeners=[],this.eventQuickHandles=[],this.isVirtualRendering=!1,this.cachedSections={},this.renderedContent=null,this.__scope=null,this.isRefreshing=!1,this.changeStateQueueCount=0,this.changedStateKeys=new Set,this._stateChangePending=!1,this.loopContext=null,this.isCommitedConstructorData=!1}setup(e,t){return this.isInitlized||(this.path=e,this.config=t||{},this.initialize()),this}initialize(){if(this.isInitlized)return;this.isInitlized=!0;const e=this.config;this.id=e.viewId||(0,s.bD)(),(0,s.DI)(e,"viewId"),this.init=e.init||this._emptyFn,(0,s.DI)(e,"init"),this.addCSS=e.addCSS||this._emptyFn,(0,s.DI)(e,"addCSS"),this.removeCSS=e.removeCSS||this._emptyFn,(0,s.DI)(e,"removeCSS"),this.states=e.states||new a.P(this),(0,s.DI)(e,"states"),this.superViewPath=e.superViewPath||e.superView,(0,s.DI)(e,"superViewPath"),(0,s.DI)(e,"superView"),this.hasSuperView=e.hasSuperView,(0,s.DI)(e,"hasSuperView"),this.hasAwaitData=e.hasAwaitData,(0,s.DI)(e,"hasAwaitData"),this.hasFetchData=e.hasFetchData,(0,s.DI)(e,"hasFetchData"),this.fetch=e.fetch,(0,s.DI)(e,"fetch"),this.usesVars=e.usesVars,(0,s.DI)(e,"usesVars"),this.hasSections=e.hasSections,(0,s.DI)(e,"hasSections"),this.hasSectionPreload=e.hasSectionPreload,(0,s.DI)(e,"hasSectionPreload"),this.renderLongSections=e.renderLongSections||[],(0,s.DI)(e,"renderLongSections"),this.hasPrerender=e.hasPrerender,(0,s.DI)(e,"hasPrerender"),this.sections=e.sections,(0,s.DI)(e,"sections"),this.wrapperConfig={...this.wrapperConfig,..."object"==typeof e.wrapperConfig?e.wrapperConfig:{}},(0,s.DI)(e,"wrapperConfig"),this.resources=e.resources,(0,s.DI)(e,"resources"),this.userDefined=e.userDefined,(0,s.DI)(e,"userDefined"),this.master=null,this.children=[],this.events={},this.eventHandlers={},this.processDefinedProperties(e),e&&e.data&&"object"==typeof e.data&&e.data.__SSR_VIEW_ID__&&(e.data.__SSR_VIEW_ID__=null,(0,s.DI)(e.data,"__SSR_VIEW_ID__")),this.data={...this.data||{},...e.data||{}},this.commitConstructorData()}processDefinedProperties(e){let t={},i={};e.__props__&&e.__props__.length>0&&e.__props__.forEach(s=>{"function"==typeof e[s]?i[s]=e[s].bind(this):void 0!==e[s]&&(t[s]=e[s])}),this.userDefined&&Object.entries(this.userDefined).forEach(([e,s])=>{h.p.includes(e)||("function"==typeof s?i[e]=s.bind(this):t[e]=s)}),(0,s.uH)(this,t,{writable:!0,configurable:!0,enumerable:!0}),(0,s.Im)(this,i)}setScope(e){this.__scope=e}loadServerData(e={}){const[t,i]=e,s="function"==typeof this.config.loadServerData?this.config.loadServerData.apply(this,[{...this.App.View.data,...this.data,..._data}]):this.config.loadServerData;return"object"==typeof s&&(s.constructor,this.constructor),s}commitConstructorData(){this.isCommitedConstructorData||((0,s.vI)(this.data)&&"function"==typeof this.config.updateVariableData&&(this.config.updateVariableData.apply(this,[{...this.App.View.data,...this.data}]),this.isCommitedConstructorData=!0),"function"==typeof this.config.commitConstructorData&&this.config.commitConstructorData.apply(this,[]))}addEventConfig(e,t){if("string"==typeof e&&""!==e&&"object"==typeof t&&null!==t)return this.addEventStack(e,t)}render(){let e=this.followingIDs.length;this.commitConstructorData(),console.log(`path: ${this.path}`,this);const t=this.config.render.apply(this,[]);return this.renderedContent=t,this.followingIDs.length>=e&&this.followingRenderIDs.push(...this.followingIDs.slice(e)),"string"==typeof t&&""!==t.trim()&&this.isHtmlString(t)&&(this.renderedContent=this.addXRefViewToRootElements(t)),this.renderedContent}virtualRender(){this.isScanning=!0,this.isVirtualRendering=!0;let e=this.followingIDs.length;this.commitConstructorData();const t=this.config.render.apply(this,[]);return this.followingIDs.length>=e&&this.followingRenderIDs.push(...this.followingIDs.slice(e)),this.isVirtualRendering=!1,this.isScanning=!1,t}prerender(e={}){let t=this.followingIDs.length;this.commitConstructorData();const i=this.config.prerender.apply(this,[]);return this.followingIDs.length>=t&&this.followingPrerenderIDs.push(...this.followingIDs.slice(t)),"string"==typeof i&&""!==i.trim()&&this.isHtmlString(i)?this.addXRefViewToRootElements(i):i}virtualPrerender(e={}){this.isScanning=!0,this.isVirtualRendering=!0;let t=this.followingIDs.length;this.commitConstructorData();const i=this.config.prerender.apply(this,[]);return this.followingIDs.length>=t&&this.followingPrerenderIDs.push(...this.followingIDs.slice(t)),this.isVirtualRendering=!1,this.isScanning=!1,i}replaceView(e){if(this.isHtmlString(e)){const t=document.createElement("div");t.innerHTML=e;const i=t.content,s=document.querySelectorAll(`[x-ref-view="${this.id}"]`);for(let e=s.length-1;e>0;e--){const t=s[e],n=i.childNodes[e];t.parentNode.replaceChild(n,t)}const n=s[0];return n.parentNode.replaceChild(i,n),!0}return!1}beforeCreate(){"function"==typeof this.userDefined.beforeCreate&&this.userDefined.beforeCreate.call(this)}created(){"function"==typeof this.userDefined.created&&this.userDefined.created.call(this)}beforeUpdate(){"function"==typeof this.userDefined.beforeUpdate&&this.userDefined.beforeUpdate.call(this)}updated(){"function"==typeof this.userDefined.updated&&this.userDefined.updated.call(this)}beforeInit(){"function"==typeof this.userDefined.beforeInit&&this.userDefined.beforeInit.call(this)}init(){"function"==typeof this.userDefined.init&&this.userDefined.init.call(this)}afterInit(){"function"==typeof this.userDefined.afterInit&&this.userDefined.afterInit.call(this)}beforeDestroy(){"function"==typeof this.userDefined.beforeDestroy&&this.userDefined.beforeDestroy.call(this)}destroyed(){"function"==typeof this.userDefined.destroyed&&this.userDefined.destroyed.call(this)}beforeMount(){"function"==typeof this.userDefined.beforeMount&&this.userDefined.beforeMount.call(this)}mounted(){this.isMounted||("function"==typeof this.userDefined.mounted&&this.userDefined.mounted.call(this),this.startEventListener(),this.isMounted=!0),this.originalView&&this.originalView instanceof l&&this.originalView.onSuperViewMounted(),this.children&&this.children.length>0&&this.children.forEach(e=>{e&&e instanceof l&&e.onParentMounted()}),this.followingBlocks&&this.followingBlocks.size>0&&this.followingBlocks.forEach(e=>{e.mounted()})}beforeUnmount(){"function"==typeof this.userDefined.beforeUnmounted&&this.userDefined.beforeUnmounted.call(this)}unmounted(){this.isMounted&&("function"==typeof this.userDefined.unmounted&&this.userDefined.unmounted.call(this),this.stopEventListener(),this.isMounted=!1),this.originalView&&this.originalView instanceof l&&this.originalView.onSuperViewUnmounted(),this.children&&this.children.length>0&&this.children.forEach(e=>{e&&e instanceof l&&e.onParentUnmounted()}),this.followingBlocks&&this.followingBlocks.size>0&&this.followingBlocks.forEach(e=>{e.unmounted()})}destroy(){this.isDestroyed=!0,this._stateChangePending=!1,this.changedStateKeys&&this.changedStateKeys.clear(),this.changeStateQueueCount=0,this.unmounted(),this.originalView&&this.originalView instanceof l&&this.originalView.destroy(),this.children&&this.children.length>0&&this.children.forEach(e=>e.destroy()),this.followingBlocks&&this.followingBlocks.size>0&&(this.followingBlocks.forEach(e=>e.destroy()),this.followingBlocks.clear()),this.refElements&&this.refElements.length>0&&(this.refElements.forEach(e=>e.parentNode&&e.parentNode.removeChild(e)),this.refElements=[])}refresh(){this.isRefreshing=!0,this.parent&&this.parent instanceof l&&this.parent.refresh()}onSuperViewMounted(){this.mounted()}onSuperViewUnmounted(){}onParentMounted(){this.mounted()}onParentUnmounted(){}addXRefViewToRootElements(e){const t=document.createElement("div");return t.innerHTML=e,Array.from(t.children).forEach(e=>{e.setAttribute("x-ref-view",this.id)}),t.innerHTML}isHtmlString(e){return/<[a-z][\s\S]*>/i.test(e)}renderPlaceholder(){return`<div class="${h.a.className("placeholder")}" ${h.a.KEYS.VIEW_ID}="${this.id}"></div>`}showError(e){return this.isSuperView?`<div class="${h.a.className("ERROR_VIEW")}">${e}</div>`:(this.hasSuperView,this.renderLongSections.length>0?this.renderLongSections.map(t=>this.App.View.section(t,`<div class="${h.a.className("section-error")}" ${h.a.KEYS.VIEW_SECTION_REF}="${this.id}">${e}</div>`,"html")).join(""):`<div class="${h.a.className("ERROR_VIEW")}" ${h.a.KEYS.VIEW_ID}="${this.id}">${e}</div>`)}showErrorScan(e){return null}resetOriginalView(){this.originalView&&this.originalView instanceof l&&this.originalView.destroy()}ejectOriginalView(){this.originalView&&this.originalView instanceof l&&(this.originalView=null,this.originalViewId=null,this.originalViewPath=null)}remove(){return this.master?.removeChild(this),this.children.forEach(e=>e.remove()),this.master=null,this.children=[],this}insertResources(){this.resources.forEach(e=>{if(document.querySelector(`[data-resource-uuid="${e.uuid}"]`))return;const t=document.createElement(e.tag);Object.entries(e.attrs).forEach(([e,i])=>{t.setAttribute(e,i)}),t.setAttribute("data-resource-uuid",e.uuid),"script"===e.tag?document.body.appendChild(t):("link"===e.tag||"style"===e.tag)&&document.head.appendChild(t),document.head.appendChild(t)})}removeResources(){this.resources.forEach(e=>{const t=document.querySelector(`[data-resource-uuid="${e.uuid}"]`);t&&t.remove()})}__showError(e){return o.Ay.error(`ViewEngine Error [${this.path}]: ${e}`),this.showError(e)}__section(e,t,i){return this.cachedSections[e]=t,this.isVirtualRendering?null:this.App.View.section(e,t,i)}__yield(e,t=""){return this.App.View.yield(e,t)}__yieldContent(e,t=""){return this.App.View.yieldContent(e,t)}__execute(...e){return this.App.View.execute(...e)}__subscribe(...e){}__text(...e){return this.App.View.text(...e)}__follow(e=[],t=()=>""){return this.isVirtualRendering?this.renderFollowingBlockScan(e,t):this.renderFollowingBlock(e,t)}__block(e,t={},i){return this.addBlock(e,t,i)}__include(e,t={}){if(this.isVirtualRendering){const i=this.childrenConfig[this.childrenIndex];if(!i||i.name!==e)return null;this.childrenIndex++;const s=this.App.View.ssrViewManager.getInstance(i.name,i.id);if(!s)return null;const n={...t,...s.data,__SSR_VIEW_ID__:i.id},r=this.$include(i.name,n);return r?(r.__scan(s),r):null}return this.$include(e,t)}__includeif(e,t={}){return this.App.View.exists(e)?this.__include(e,t):null}__includewhen(e,t,i={}){return e?this.__include(t,i):null}__extends(e,t={}){if(this.isVirtualRendering){if(!this.App.View.exists(e))return null;let i=null,s=this.childrenConfig.find((t,i)=>t.name===e&&i==this.childrenConfig.length-1);if(i=s?this.App.View.ssrViewManager.getInstance(s.name,s.id):this.App.View.ssrViewManager.scan(e),!i)return null;const n={...t,...i.data,__SSR_VIEW_ID__:i.viewId},r=this.$extends(e,n);return r?(r.__scan(i),r):null}return this.$extends(e,t)}__setLoopContext(e){let t=this.loopContext;return this.loopContext=new LoopContext(t),this.loopContext.setCount(e),this.loopContext}__resetLoopContext(){if(this.loopContext&&this.loopContext.parent){let e=this.loopContext.parent;this.loopContext.parent=null,Object.freeze(this.loopContext),this.loopContext=e}else this.loopContext?(Object.freeze(this.loopContext),this.loopContext=null):this.loopContext=null;return this.loopContext}__foreach(e,t){if(!e)return"";if(!e||"object"!=typeof e||Array.isArray(e))return"";let i="";if(Array.isArray(e)){let s=this.__setupLoopContext(e);s.setType("increment"),e.forEach((e,n)=>{s.setCurrentTimes(n),i+=t(e,n,n,s)}),this.__resetLoopContext()}else{let s=Object.keys(e).length,n=this.__setupLoopContext(s);n.setType("increment");let r=0;Object.entries(e).forEach(([e,s])=>{n.setCurrentTimes(r),i+=t(s,e,r,n),r+=1}),this.__resetLoopContext()}return i}__scan(e){if(this.isScanned)return;this.isScanning=!0;const{viewId:t,data:i,events:s,following:n,children:r,parent:a}=e;if(i&&"object"==typeof i&&this.updateVariableData(i),"string"!=typeof t||""===t)return o.Ay.warn("âš ï¸ ViewEngine.__scan: Invalid viewId",t),null;o.Ay.log(`ðŸ” ViewEngine.__scan: Scanning view ${this.path} (${t})`),this.__scanDOMElements(t),n&&n.length>0&&this.__setupFollowingBlocks(n,t),r&&r.length>0&&this.__storeChildrenReferences(r),o.Ay.log(`âœ… ViewEngine.__scan: Scan complete for ${this.path} (${t})`),this.isScanned=!0}__scanDOMElements(e){if(this.hasSuperView)o.Ay.log(`âœ… ViewEngine.__scanDOMElements: Skipping element scan for ${this.path} (${e}) due to super view`);else{if(this.wrapperConfig.enable)if(this.wrapperConfig.tag){let t=document.querySelectorAll(`${this.wrapperConfig.tag}[data-wrap-view="${this.path}"][${h.a.KEYS.VIEW_WRAPPER}="${e}"]`);t.length>0&&(this.refElements=Array.from(t).map(t=>(t.setAttribute("x-ref-view",e),t)),o.Ay.log(`âœ… ViewEngine.__scanDOMElements: Found ${t.length} custom wrapper elements`))}else{const t=r.Ay.first("view",{name:this.path,id:e});t&&(this.markup=t,this.refElements=t.nodes.filter(e=>e.nodeType===Node.ELEMENT_NODE),o.Ay.log(`âœ… ViewEngine.__scanDOMElements: Found view boundary with ${this.refElements.length} elements`))}else{let t=document.querySelectorAll(`[data-view-wrapper="${e}"]`);t.length>0&&(this.refElements=Array.from(t).map(t=>(t.setAttribute("x-ref-view",e),t)),o.Ay.log(`âœ… ViewEngine.__scanDOMElements: Found ${t.length} standard wrapper elements`))}this.refElements&&0!==this.refElements.length||o.Ay.warn(`âš ï¸ ViewEngine.__scanDOMElements: No elements found for ${this.path} (${e})`)}}__attachEventHandlers(e,t){this.events=e}__setupFollowingBlocks(e,t){e.forEach(e=>{const{id:t,stateKeys:i}=e;this.followingConfig.push({id:t,stateKeys:i})})}__storeChildrenReferences(e){e.forEach(e=>{const{name:t,id:i}=e;this.childrenConfig.push({name:t,id:i})})}$extends(e,t={}){const i=this.data?this.data:{};i.__SSR_VIEW_ID__&&(i.__SSR_VIEW_ID__=null,delete i.__SSR_VIEW_ID__);const s=this.App.View.extendView(e,{...i,...t});return s?(this.superViewPath=e,this.setSuperView(s),s.setOriginalView(this),s):null}$include(e,t={}){const i=this.data?this.data:{};i.__SSR_VIEW_ID__&&(i.__SSR_VIEW_ID__=null,delete i.__SSR_VIEW_ID__);const s=this.App.View.include(e,{...i,...t});return s?(s.setParent(this),this.addChild(s,t),s):null}addEventStack(e,t){if("string"!=typeof s||""===s)return;if("object"!=typeof t||null===t)return;let i=this.eventIndex++,s=this.viewId+"-"+e+"-"+i;return void 0===this.events[e]&&(this.events[e]={}),void 0===this.events[e][s]&&(this.events[e][s]=[]),this.events[e][s].push(...t),` data-${e}-id="${s}"`}__addEventConfig(e,t){return this.addEventConfig(e,t)}setEventConfig(e){"object"==typeof e&&null!==e&&Object.entries(e).forEach((e,t)=>{"object"==typeof t&&null!==t&&Object.entries(t).forEach((t,i)=>{this.addEventStack(e,t,i)})})}startEventListener(){const e=[];Object.entries(this.events).forEach(([t,i])=>{Object.entries(i).forEach(([i,s])=>{const n=`[data-${t}-id="${i}"]`,r=document.querySelectorAll(n),a=this.parseEventHandlerFunctions(s);0!==a.length&&r.length>0?r.forEach(e=>{const i=e=>{let t=null;for(let i=0;i<a.length;i++)if(t=(0,a[i])(e),!1===t||e.defaultPrevented){e.preventDefault(),e.stopPropagation();break}if(!1===t||!0===t)return t};e.addEventListener(t,i),this.eventListeners.push({element:e,eventType:t,handler:i})}):(o.Ay.warn(`âš ï¸ ViewEngine.startEventListener: No elements found for selector ${n} or no handlers defined`),e.push({eventType:t,eventID:i}))})}),e.forEach(({eventType:e,eventID:t})=>{delete this.events[e][t],0===Object.keys(this.events[e]).length&&delete this.events[e]}),this.eventListenerStatus=!0}stopEventListener(){this.eventListeners.forEach(({element:e,eventType:t,handler:i})=>{e.removeEventListener(t,i)}),this.eventListeners=[],this.eventListenerStatus=!1}clearOrphanedEventData(){const e=[];Object.entries(this.events).forEach(([t,i])=>{Object.entries(i).forEach(([i,s])=>{const n=`[data-${t}-id="${i}"]`;0===document.querySelectorAll(n).length&&e.push({eventType:t,eventID:i})})}),e.forEach(({eventType:e,eventID:t})=>{delete this.events[e][t],0===Object.keys(this.events[e]).length&&delete this.events[e]}),e.length>0&&o.Ay.log(`ðŸ—‘ï¸ ViewEngine.clearOrphanedEventData: Cleaned up ${e.length} orphaned event handlers`)}parseEventHandlerFunctions(e){let t=[];return e.forEach(e=>{const i=e.handler,s=e.params||[],n=this.parseHandlerFunction(i);t.push(e=>n(...this.parseEventHandlerParams(e,s)))}),t}parseHandlerFunction(e){if("string"!=typeof e&&"function"!=typeof e)return null;if("function"==typeof e)return"function"==typeof e.bind?e.bind(this):e;if("function"==typeof this.userDefined[e]){let t=this.userDefined[e];return"function"==typeof t.bind&&(t=t.bind(this)),t}if("function"==typeof this[e]){let t=this[e];return"function"==typeof t.bind&&(t=t.bind(this)),t}if("function"==typeof this.states.__setters__[e]){let t=this.states.__setters__[e];return"function"==typeof t.bind&&(t=t.bind(this)),t}if(window&&"function"==typeof window[e]){let t=window[e];return"function"==typeof t.bind&&(t=t.bind(window)),t}return t=>o.Ay.warn(`âš ï¸ Event handler ${e} is not defined`,t)}parseEventHandlerParams(e,t=[]){return t.map(t=>"@EVENT"===t?e:"object"==typeof t&&null!==t?"string"==typeof t.handler&&(Array.isArray(t.params)||"object"==typeof t.params&&null!==t.params&&t.params.constructor===Array)?this.parseHandlerFunction(t.handler)(...this.parseEventHandlerParams(e,t.params)):this.parseEventHandlerObject(e,t):Array.isArray(t)||"object"==typeof t&&null!==t&&t.constructor===Array?this.parseEventHandlerParams(e,t):"function"==typeof t?t(e):t)}parseEventHandlerObject(e,t={}){let i={};return Object.entries(t).forEach(([t,s])=>{if("@EVENT"===s)i[t]=e;else if("object"==typeof s&&null!==s)if("string"==typeof s.handler&&(Array.isArray(s.params)||"object"==typeof s.params&&null!==s.params&&s.params.constructor===Array)){const n=this.parseHandlerFunction(s.handler);i[t]=n(...this.parseEventHandlerParams(e,s.params))}else i[t]=this.parseEventHandlerObject(e,s);else Array.isArray(s)||"object"==typeof s&&null!==s&&s.constructor===Array?i[t]=this.parseEventHandlerParams(e,s):i[t]="function"==typeof s?s(e):s}),i}wrapattr(){return` ${h.a.KEYS.VIEW_WRAPPER}="${this.id}"`}startWrapper(e=null,t={}){return this.wrapTag=null,"string"==typeof e?this.wrapTag=e:"object"==typeof e&&(this.wrapTag=e.tag||"div",delete e.tag,t={...t,...e.attributes},e=null),"string"!=typeof t&&t||(t={}),this.wrapTag?`<${this.wrapTag} data-wrap-view="${this.path}" data-wrap-id="${this.id}" ${Object.entries(t).map(([e,t])=>`${e}="${t}"`).join(" ")}>`:`\x3c!-- [one:view name="${this.path}" id="${this.id}"] --\x3e`}endWrapper(){return this.wrapTag?(this.wrapTag=null,`</${this.wrapTag}>`):(this.wrapTag=null,"\x3c!-- [/one:view] --\x3e")}addBlock(e,t={},i){if("string"==typeof e&&""!==e)return this.isVirtualRendering,this.App.View.section("block."+e,`\x3c!-- [one:block name="${this.path}" ref="${this.id}"] --\x3e${i}\x3c!-- [/one:block] --\x3e`,"html")}useBlock(e,t=""){if("string"==typeof e&&""!==e)return this.isVirtualRendering,`\x3c!-- [one:subscribe type="block" key="${e}"] --\x3e${this.App.View.yield("block."+e,t)}\x3c!-- [/one:subscribe] --\x3e`}mountBlock(e,t=""){return this.useBlock(e,t)}subscribeBlock(e,t=""){return' data-subscribe-block="'+e+'"'}renderFollowingBlock(e=[],t=()=>""){if(!Array.isArray(e)||0===e.length)return"";if("function"!=typeof t)return"";if(this.isVirtualRendering){this.isVirtualRendering=!1;let i=this.renderFollowingBlockScan(e,t);return this.isVirtualRendering=!0,i}const i=new n.J({stateKeys:e,renderBlock:t,engine:this,states:this.states,App:this.App});return this.followingIDs.push(i.id),this.followingBlocks.set(i.id,i),i.render()}renderFollowingBlockScan(e=[],t=()=>""){let i=this.followingScanIndex,s=this.followingConfig[i];if(!(s||s.stateKeys==e||s.stateKeys.length==e.length&&s.stateKeys.every(t=>e.includes(t))))return"";const{id:r}=s,a=new n.J({renderID:r,stateKeys:e,renderBlock:t,engine:this,states:this.states,App:this.App});return a.scan(),this.followingIDs.push(a.id),this.followingBlocks.set(a.id,a),this.followingScanIndex++,""}onFollowUpdating(){this.stopEventListener(),setTimeout(()=>{this.eventListenerStatus||this.startEventListener()},10)}onFollowUpdated(){this.eventListenerStatus||this.startEventListener()}onStateChange(e,t,i){this.changedStateKeys.add(e),this.changeStateQueueCount++,this._stateChangePending||(this._stateChangePending=!0,Promise.resolve().then(()=>{this._stateChangePending=!1,this._processStateChanges()}))}_processStateChanges(){if(this.isDestroyed)return;const e=Array.from(this.changedStateKeys);this.changedStateKeys.clear(),this.changeStateQueueCount=0,0!==e.length&&this._notifyStateChanges(e)}_notifyStateChanges(e){this.isRefreshing||(this.subscribe&&Array.isArray(this.subscribe)&&this.subscribe.length>0&&e.some(e=>this.subscribe.includes(e))&&this.refresh(),this.children&&this.children.length>0&&this.children.forEach(t=>{t.subscribe&&Array.isArray(t.subscribe)&&e.some(e=>t.subscribe.includes(e))&&t.view&&t.view._notifyStateChanges(e)}))}onStateDataChanges(){this.stateChangeData,this.stateChangeData=null}setApp(e){return this.App=e,this}setUrlPath(e){return this.urlPath=e,this}setSuperView(e){return this.superView=e,this}setParent(e){return this.parent=e,this}setOriginalView(e){return this.originalView=e,this.originalViewPath=e.path,this.originalViewId=e.id,this}addChild(e,t={}){let i=this.children.length,s={name:e.path,id:e.id,index:i,view:e,data:t,subscribe:[]};return e.setScope(s),this.children.push(s),this}removeChild(e){return this.children=this.children.filter(t=>t!==e),this}updateData(e={}){return this.data={...this.data,...e},this}updateVariableData(e={}){return"function"==typeof this.config.updateVariableData&&(this.config.updateVariableData.call(this,e),this.isCommitedConstructorData=!0),this}updateVariableItem(e,t){return"function"==typeof this.config.updateVariableItemData&&this.config.updateVariableItemData.call(this,e,t),this}setIsSuperView(e){return this.isSuperView=e,this}reset(){}}},611:(e,t,i)=>{i.d(t,{a:()=>n,p:()=>r});const s="data-",n={PREFIX:{BASE:s,YIELD:`${s}yield-`,CLICK:`${s}click-`,DBLCLICK:`${s}dblclick-`,MOUSEDOWN:`${s}mousedown-`,MOUSEUP:`${s}mouseup-`,MOUSEOVER:`${s}mouseover-`,MOUSEOUT:`${s}mouseout-`,MOUSEMOVE:`${s}mousemove-`,MOUSEENTER:`${s}mouseenter-`,MOUSELEAVE:`${s}mouseleave-`,WHEEL:`${s}wheel-`,AUXCLICK:`${s}auxclick-`,KEYDOWN:`${s}keydown-`,KEYUP:`${s}keyup-`,KEYPRESS:`${s}keypress-`,INPUT:`${s}input-`,CHANGE:`${s}change-`,SUBMIT:`${s}submit-`,RESET:`${s}reset-`,INVALID:`${s}invalid-`,SEARCH:`${s}search-`,FOCUS:`${s}focus-`,BLUR:`${s}blur-`,FOCUSIN:`${s}focusin-`,FOCUSOUT:`${s}focusout-`,SELECT:`${s}select-`,SELECTSTART:`${s}selectstart-`,SELECTIONCHANGE:`${s}selectionchange-`,TOUCHSTART:`${s}touchstart-`,TOUCHMOVE:`${s}touchmove-`,TOUCHEND:`${s}touchend-`,TOUCHCANCEL:`${s}touchcancel-`,DRAGSTART:`${s}dragstart-`,DRAG:`${s}drag-`,DRAGEND:`${s}dragend-`,DRAGENTER:`${s}dragenter-`,DRAGLEAVE:`${s}dragleave-`,DRAGOVER:`${s}dragover-`,DROP:`${s}drop-`,PLAY:`${s}play-`,PAUSE:`${s}pause-`,ENDED:`${s}ended-`,LOADSTART:`${s}loadstart-`,LOADEDDATA:`${s}loadeddata-`,LOADEDMETADATA:`${s}loadedmetadata-`,CANPLAY:`${s}canplay-`,CANPLAYTHROUGH:`${s}canplaythrough-`,WAITING:`${s}waiting-`,SEEKING:`${s}seeking-`,SEEKED:`${s}seeked-`,RATECHANGE:`${s}ratechange-`,DURATIONCHANGE:`${s}durationchange-`,VOLUMECHANGE:`${s}volumechange-`,SUSPEND:`${s}suspend-`,STALLED:`${s}stalled-`,PROGRESS:`${s}progress-`,EMPTIED:`${s}emptied-`,ENCRYPTED:`${s}encrypted-`,WAKEUP:`${s}wakeup-`,LOAD:`${s}load-`,UNLOAD:`${s}unload-`,BEFOREUNLOAD:`${s}beforeunload-`,RESIZE:`${s}resize-`,SCROLL:`${s}scroll-`,ORIENTATIONCHANGE:`${s}orientationchange-`,VISIBILITYCHANGE:`${s}visibilitychange-`,PAGEHIDE:`${s}pagehide-`,PAGESHOW:`${s}pageshow-`,POPSTATE:`${s}popstate-`,HASHCHANGE:`${s}hashchange-`,ONLINE:`${s}online-`,OFFLINE:`${s}offline-`,DOMCONTENTLOADED:`${s}DOMContentLoaded-`,READYSTATECHANGE:`${s}readystatechange-`,ERROR:`${s}error-`,ABORT:`${s}abort-`,CONTEXTMENU:`${s}contextmenu-`,ANIMATIONSTART:`${s}animationstart-`,ANIMATIONEND:`${s}animationend-`,ANIMATIONITERATION:`${s}animationiteration-`,TRANSITIONSTART:`${s}transitionstart-`,TRANSITIONEND:`${s}transitionend-`,TRANSITIONRUN:`${s}transitionrun-`,TRANSITIONCANCEL:`${s}transitioncancel-`,POINTERDOWN:`${s}pointerdown-`,POINTERUP:`${s}pointerup-`,POINTERMOVE:`${s}pointermove-`,POINTEROVER:`${s}pointerover-`,POINTEROUT:`${s}pointerout-`,POINTERENTER:`${s}pointerenter-`,POINTERLEAVE:`${s}pointerleave-`,POINTERCANCEL:`${s}pointercancel-`,GOTPOINTERCAPTURE:`${s}gotpointercapture-`,LOSTPOINTERCAPTURE:`${s}lostpointercapture-`,FULLSCREENCHANGE:`${s}fullscreenchange-`,FULLSCREENERROR:`${s}fullscreenerror-`,COPY:`${s}copy-`,CUT:`${s}cut-`,PASTE:`${s}paste-`,GAMEPADCONNECTED:`${s}gamepadconnected-`,GAMEPADDISCONNECTED:`${s}gamepaddisconnected-`,BATTERYCHARGINGCHANGE:`${s}batterychargingchange-`,BATTERYLEVELCHANGE:`${s}batterylevelchange-`,DEVICEORIENTATION:`${s}deviceorientation-`,DEVICEMOTION:`${s}devicemotion-`,DEVICELIGHT:`${s}devicelight-`,DEVICEPROXIMITY:`${s}deviceproximity-`,WEBGLCONTEXTLOST:`${s}webglcontextlost-`,WEBGLCONTEXTRESTORED:`${s}webglcontextrestored-`,VIEW:`${s}view-`},KEYS:{VIEW:`${s}view`,VIEW_ID:`${s}view-id`,VIEW_REF:`${s}view-ref`,VIEW_SECTION_REF:`${s}view-section-ref`,VIEW_RESOURCE:`${s}view-resource`,VIEW_STYLE:`${s}view-style`,VIEW_WRAPPER:`${s}view-wrapper`,YIELD_ATTR:`${s}yield-attr`,YIELD_CONTENT:`${s}yield-content`,YIELD_CHILDREN:`${s}yield-children`,YIELD_SUBSCRIBE:`${s}yield-subscribe`,YIELD_SUBSCRIBE_ATTR:`${s}yield-subscribe-attr`,YIELD_SUBSCRIBE_CONTENT:`${s}yield-subscribe-content`,YIELD_SUBSCRIBE_CHILDREN:`${s}yield-subscribe-children`},CLASSNAME:{BASE:s,VIEW_ERROR:`${s}view-error`,VIRTUAL_CONTAINER:`${s}virtual-container`,SECTION_ERROR:`${s}section-error`},prefix:e=>n.PREFIX[e.toUpperCase()]||s+e,key:e=>n.KEYS[e.toUpperCase()]||s+e,className:e=>n.CLASSNAME[e.toUpperCase()]||s+e.toLowerCase().replace(/_/g,"-")},r=["init","destroy","beforeInit","afterInit","beforeDestroy","destroyed","loadServerData","render","prerender","insertResources","removeResources","setMaster","setApp","addChild","removeChild","remove","setParent","parent","master","beforeCreate","created","beforeUpdate","updated","beforeMount","mounted","beforeUnmount","unmounted","renderLongSections","renderSections","prerenderSections","data","scope","subscribe","updateVariableItem","updateVariableData"]},781:(e,t,i)=>{i.d(t,{Q:()=>s});const s={"meta:title":[{tag:"title",selector:"title",attribute:"@content",attrs:{}},{tag:"meta",selector:"meta[name='title']",attribute:"content",attrs:{name:"title"}}],"meta:description":[{tag:"meta",selector:"meta[name='description']",attribute:"content",attrs:{name:"description"}}],"meta:keywords":[{tag:"meta",selector:"meta[name='keywords']",attribute:"content",attrs:{name:"keywords"}}],"link:meta:canonical":[{tag:"link",selector:"link[rel='canonical']",attribute:"href",attrs:{rel:"canonical"}}],"meta:robots":[{tag:"meta",selector:"meta[name='robots']",attribute:"content",attrs:{name:"robots"}}],"meta:author":[{tag:"meta",selector:"meta[name='author']",attribute:"content",attrs:{name:"author"}}],"meta:image":[{tag:"meta",selector:"meta[name='image']",attribute:"content",attrs:{name:"image"}}],"meta:og:image":[{tag:"meta",selector:"meta[property='og:image']",attribute:"content",attrs:{property:"og:image"}}],"meta:og:title":[{tag:"meta",selector:"meta[property='og:title']",attribute:"content",attrs:{property:"og:title"}}],"meta:og:description":[{tag:"meta",selector:"meta[property='og:description']",attribute:"content",attrs:{property:"og:description"}}],"meta:og:type":[{tag:"meta",selector:"meta[property='og:type']",attribute:"content",attrs:{property:"og:type"}}],"meta:og:url":[{tag:"meta",selector:"meta[property='og:url']",attribute:"content",attrs:{property:"og:url"}}],"meta:og:site_name":[{tag:"meta",selector:"meta[property='og:site_name']",attribute:"content",attrs:{property:"og:site_name"}}],"meta:og:locale":[{tag:"meta",selector:"meta[property='og:locale']",attribute:"content",attrs:{property:"og:locale"}}],"meta:article:published_time":[{tag:"meta",selector:"meta[property='article:published_time']",attribute:"content",attrs:{property:"article:published_time"}}],"meta:article:modified_time":[{tag:"meta",selector:"meta[property='article:modified_time']",attribute:"content",attrs:{property:"article:modified_time"}}],"meta:article:section":[{tag:"meta",selector:"meta[property='article:section']",attribute:"content",attrs:{property:"article:section"}}],"meta:article:tag":[{tag:"meta",selector:"meta[property='article:tag']",attribute:"content",attrs:{property:"article:tag"}}],"meta:article:author":[{tag:"meta",selector:"meta[property='article:author']",attribute:"content",attrs:{property:"article:author"}}],"meta:article:publisher":[{tag:"meta",selector:"meta[property='article:publisher']",attribute:"content",attrs:{property:"article:publisher"}}],"meta:article:image":[{tag:"meta",selector:"meta[property='article:image']",attribute:"content",attrs:{property:"article:image"}}],"meta:og:image:width":[{tag:"meta",selector:"meta[property='og:image:width']",attribute:"content",attrs:{property:"og:image:width"}}],"meta:og:image:height":[{tag:"meta",selector:"meta[property='og:image:height']",attribute:"content",attrs:{property:"og:image:height"}}],"meta:twitter:card":[{tag:"meta",selector:"meta[name='twitter:card']",attribute:"content",attrs:{name:"twitter:card"}}],"meta:twitter:label1":[{tag:"meta",selector:"meta[name='twitter:label1']",attribute:"content",attrs:{name:"twitter:label1"}}],"meta:twitter:label2":[{tag:"meta",selector:"meta[name='twitter:label2']",attribute:"content",attrs:{name:"twitter:label2"}}],"twitter:data1":[{tag:"meta",selector:"meta[name='twitter:data1']",attribute:"content",attrs:{name:"twitter:data1"}}],"twitter:data2":[{tag:"meta",selector:"meta[name='twitter:data2']",attribute:"content",attrs:{name:"twitter:data2"}}],"link:rel:shortlink":[{tag:"meta",selector:"meta[name='rel:shortlink']",attribute:"content",attrs:{rel:"shortlink"}}],"link:rel:alternate":[{tag:"meta",selector:"meta[name='rel:alternate']",attribute:"content",attrs:{rel:"alternate"}}]}}}]);
//# sourceMappingURL=core-1c191ae7.js.map