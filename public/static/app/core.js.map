{"version":3,"file":"core.js","mappings":"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","sources":["webpack://App/./resources/js/app/core/services/HttpService.js","webpack://App/./resources/js/app/core/services/LoggerService.js","webpack://App/./resources/js/app/core/SEOConfig.js","webpack://App/./resources/js/app/core/ViewTemplate.js","webpack://App/./resources/js/app/core/services/StorageService.js","webpack://App/./resources/js/app/core/View.js","webpack://App/./resources/js/app/core/Helper.js","webpack://App/./resources/js/app/core/FollowingBlock.js","webpack://App/./resources/js/app/core/ViewEngine.js","webpack://App/./resources/js/app/core/API.js","webpack://App/./resources/js/app/core/Router.js","webpack://App/./resources/js/app/core/ViewState.js","webpack://App/./resources/js/app/core/services/TemplateDetectorService.js","webpack://App/./resources/js/app/core/OneMarkup.js","webpack://App/./resources/js/app/core/ViewConfig.js","webpack://App/./resources/js/app/core/OneDOM.js"],"sourcesContent":["/**\n * HTTP Service Module\n * ES6 Module for Blade Compiler\n */\n\n\nclass HttpService {\n\n    constructor() {\n        this.baseUrl = '';\n        this.timeout = 10000;\n        this.defaultHeaders = {};\n    }\n\n    setBaseUrl(url) {\n        this.baseUrl = url;\n    }\n\n    setTimeout(timeout) {\n        this.timeout = timeout;\n    }\n\n    setDefaultHeaders(headers) {\n        this.defaultHeaders = { ...this.defaultHeaders, ...headers };\n    }\n\n    setHeader(name, value) {\n        this.defaultHeaders[name] = value;\n    }\n\n    async request(method, url, data = null, options = {}) {\n        const fullUrl = url.startsWith('http') ? url : this.baseUrl + url;\n        \n        const config = {\n            method: method.toUpperCase(),\n            headers: {\n                ...this.defaultHeaders,\n                ...options.headers\n            },\n            ...options\n        };\n\n        if (data && (method.toUpperCase() === 'POST' || method.toUpperCase() === 'PUT' || method.toUpperCase() === 'PATCH')) {\n            if (config.headers['Content-Type'] === 'application/json') {\n                config.body = JSON.stringify(data);\n            } else {\n                config.body = data;\n            }\n        }\n\n        try {\n            const controller = new AbortController();\n            const timeoutId = setTimeout(() => controller.abort(), this.timeout);\n            \n            const response = await fetch(fullUrl, {\n                ...config,\n                signal: controller.signal\n            });\n            \n            clearTimeout(timeoutId);\n\n            const responseData = await response.json().catch(() => ({}));\n            \n            return {\n                status: response.ok,\n                statusCode: response.status,\n                data: responseData,\n                headers: response.headers\n            };\n        } catch (error) {\n            if (error.name === 'AbortError') {\n                throw new Error('Request timeout');\n            }\n            throw error;\n        }\n    }\n\n    async get(url, options = {}) {\n        return this.request('GET', url, null, options);\n    }\n\n    async post(url, data = null, options = {}) {\n        return this.request('POST', url, data, options);\n    }\n\n    async put(url, data = null, options = {}) {\n        return this.request('PUT', url, data, options);\n    }\n\n    async patch(url, data = null, options = {}) {\n        return this.request('PATCH', url, data, options);\n    }\n\n    async delete(url, options = {}) {\n        return this.request('DELETE', url, null, options);\n    }\n}\n\n\n// Export for ES6 modules\nexport { HttpService };","export class LoggerService {\n    constructor(config) {\n        this.config = {\n            level: 'info',\n            enabled: false,\n            console: true,\n            remote: false\n        };\n        \n        if (config) {\n            this.setConfig(config);\n        }\n    }\n\n    setConfig(config) {\n        this.config = { ...this.config, ...config };\n    }\n\n    getConfig() {\n        return this.config;\n    }\n\n    consoleLog(method, ...args) {\n        if (this.config.console && this.config.enabled) {\n            return console[method].apply(console, args);\n        }\n    }\n\n    log(...args) {\n        return this.consoleLog('log', ...args);\n    }\n\n    warn(...args) {\n        return this.consoleLog('warn', ...args);\n    }\n\n    error(...args) {\n        return this.consoleLog('error', ...args); \n    }\n\n    info(...args) {\n        return this.consoleLog('info', ...args);\n    }\n\n    debug(...args) {\n        return this.consoleLog('debug', ...args);\n    }\n\n}\n\n\nexport const logger = new LoggerService({level: 'info', enabled: true, console: true, remote: false});\nexport default logger;\n\n","/**\n * seo-config Module\n * ES6 Module for Blade Compiler\n */\n\nexport const ViewState = function (view) {\n    const viewRef = view;\n    const states = [];\n    let stateIndex = 0;\n    const stateMap = [];\n    \n}\nexport const SEOTagConfig = {\n    \"meta:title\": [\n        {\n            tag: \"title\",\n            selector: \"title\",\n            attribute: \"@content\",\n            attrs: {}\n        },\n        {\n            tag: \"meta\",\n            selector: \"meta[name='title']\",\n            attribute: \"content\",\n            attrs: {\n                \"name\": \"title\"\n            }\n\n        }\n    ],\n    \"meta:description\": [\n        {\n            tag: \"meta\",\n            selector: \"meta[name='description']\",\n            attribute: \"content\",\n            attrs: {\n                \"name\": \"description\"\n            }\n        }\n    ],\n    \"meta:keywords\": [\n        {\n            tag: \"meta\",\n            selector: \"meta[name='keywords']\",\n            attribute: \"content\",\n            attrs: {\n                \"name\": \"keywords\"\n            }\n        }\n    ],\n    \"link:meta:canonical\": [\n        {\n            tag: \"link\",\n            selector: \"link[rel='canonical']\",\n            attribute: \"href\",\n            attrs: {\n                \"rel\": \"canonical\"\n            }\n        }\n    ],\n    \"meta:robots\": [\n        {\n            tag: \"meta\",\n            selector: \"meta[name='robots']\",\n            attribute: \"content\",\n            attrs: {\n                \"name\": \"robots\"\n            }\n        }\n    ],\n    \"meta:author\": [\n        {\n            tag: \"meta\",\n            selector: \"meta[name='author']\",\n            attribute: \"content\",\n            attrs: {\n                \"name\": \"author\"\n            }\n        }\n    ],\n    \"meta:image\": [\n        {\n            tag: \"meta\",\n            selector: \"meta[name='image']\",\n            attribute: \"content\",\n            attrs: {\n                \"name\": \"image\"\n            }\n        }\n    ],\n    \"meta:og:image\": [\n        {\n            tag: \"meta\",\n            selector: \"meta[property='og:image']\",\n            attribute: \"content\",\n            attrs: {\n                \"property\": \"og:image\"\n            }\n        }\n    ],\n    \"meta:og:title\": [\n        {\n            tag: \"meta\",\n            selector: \"meta[property='og:title']\",\n            attribute: \"content\",\n            attrs: {\n                \"property\": \"og:title\"\n            }\n        }\n    ],\n    \"meta:og:description\": [\n        {\n            tag: \"meta\",\n            selector: \"meta[property='og:description']\",\n            attribute: \"content\",\n            attrs: {\n                \"property\": \"og:description\"\n            }\n        }\n    ],\n    \"meta:og:type\": [\n        {\n            tag: \"meta\",\n            selector: \"meta[property='og:type']\",\n            attribute: \"content\",\n            attrs: {\n                \"property\": \"og:type\"\n            }\n        }\n    ],\n    \"meta:og:url\": [\n        {\n            tag: \"meta\",\n            selector: \"meta[property='og:url']\",\n            attribute: \"content\",\n            attrs: {\n                \"property\": \"og:url\"\n            }\n        }\n    ],\n    \"meta:og:site_name\": [\n        {\n            tag: \"meta\",\n            selector: \"meta[property='og:site_name']\",\n            attribute: \"content\",\n            attrs: {\n                \"property\": \"og:site_name\"\n            }\n        }\n    ],\n    \"meta:og:locale\": [\n        {\n            tag: \"meta\",\n            selector: \"meta[property='og:locale']\",\n            attribute: \"content\",\n            attrs: {\n                \"property\": \"og:locale\"\n            }\n        }\n    ],\n    \"meta:article:published_time\": [\n        {\n            tag: \"meta\",\n            selector: \"meta[property='article:published_time']\",\n            attribute: \"content\",\n            attrs: {\n                \"property\": \"article:published_time\"\n            }\n        }\n    ],\n    \"meta:article:modified_time\": [\n        {\n            tag: \"meta\",\n            selector: \"meta[property='article:modified_time']\",\n            attribute: \"content\",\n            attrs: {\n                \"property\": \"article:modified_time\"\n            }\n        }\n    ],\n    \"meta:article:section\": [\n        {\n            tag: \"meta\",\n            selector: \"meta[property='article:section']\",\n            attribute: \"content\",\n            attrs: {\n                \"property\": \"article:section\"\n            }\n        }\n    ],\n    \"meta:article:tag\": [\n        {\n            tag: \"meta\",\n            selector: \"meta[property='article:tag']\",\n            attribute: \"content\",\n            attrs: {\n                \"property\": \"article:tag\"\n            }\n        }\n    ],\n    \"meta:article:author\": [\n        {\n            tag: \"meta\",\n            selector: \"meta[property='article:author']\",\n            attribute: \"content\",\n            attrs: {\n                \"property\": \"article:author\"\n            }\n        }\n    ],\n    \"meta:article:publisher\": [\n        {\n            tag: \"meta\",\n            selector: \"meta[property='article:publisher']\",\n            attribute: \"content\",\n            attrs: {\n                \"property\": \"article:publisher\"\n            }\n        }\n    ],\n    \"meta:article:image\": [\n        {\n            tag: \"meta\",\n            selector: \"meta[property='article:image']\",\n            attribute: \"content\",\n            attrs: {\n                \"property\": \"article:image\"\n            }\n        }\n    ],\n    \"meta:og:image:width\": [\n        {\n            tag: \"meta\",\n            selector: \"meta[property='og:image:width']\",\n            attribute: \"content\",\n            attrs: {\n                \"property\": \"og:image:width\"\n            }\n        }\n    ],\n    \"meta:og:image:height\": [\n        {\n            tag: \"meta\",\n            selector: \"meta[property='og:image:height']\",\n            attribute: \"content\",\n            attrs: {\n                \"property\": \"og:image:height\"\n            }\n        }\n    ],\n    \"meta:twitter:card\": [\n        {\n            tag: \"meta\",\n            selector: \"meta[name='twitter:card']\",\n            attribute: \"content\",\n            attrs: {\n                \"name\": \"twitter:card\"\n            }\n        }\n    ],\n    \"meta:twitter:label1\": [\n        {\n            tag: \"meta\",\n            selector: \"meta[name='twitter:label1']\",\n            attribute: \"content\",\n            attrs: {\n                \"name\": \"twitter:label1\"\n            }\n        }\n    ],\n    \"meta:twitter:label2\": [\n        {\n            tag: \"meta\",\n            selector: \"meta[name='twitter:label2']\",\n            attribute: \"content\",\n            attrs: {\n                \"name\": \"twitter:label2\"\n            }\n        }\n    ],\n    \"twitter:data1\": [\n        {\n            tag: \"meta\",\n            selector: \"meta[name='twitter:data1']\",\n            attribute: \"content\",\n            attrs: {\n                \"name\": \"twitter:data1\"\n            }\n        }\n    ],\n    \"twitter:data2\": [\n        {\n            tag: \"meta\",\n            selector: \"meta[name='twitter:data2']\",\n            attribute: \"content\",\n            attrs: {\n                \"name\": \"twitter:data2\"\n            }\n        }\n    ],\n    \"link:rel:shortlink\": [\n        {\n            tag: \"meta\",\n            selector: \"meta[name='rel:shortlink']\",\n            attribute: \"content\",\n            attrs: {\n                \"rel\": \"shortlink\"\n            }\n        }\n    ],\n    \"link:rel:alternate\": [\n        {\n            tag: \"meta\",\n            selector: \"meta[name='rel:alternate']\",\n            attribute: \"content\",\n            attrs: {\n                \"rel\": \"alternate\"\n            }\n        }\n    ]\n};","// Auto-generated ViewTemplate.js\n// This file imports all view functions and assigns them to templates\n\nimport { WebTestViewtypeComponent } from './../views/WebTestViewtypeComponent.js';\nimport { WebTestWrapper } from './../views/WebTestWrapper.js';\nimport { WebTestViewtype } from './../views/WebTestViewtype.js';\nimport { WebAwait } from './../views/WebAwait.js';\nimport { WebUserDetail } from './../views/WebUserDetail.js';\nimport { WebTestViewtypeLayout } from './../views/WebTestViewtypeLayout.js';\nimport { WebAbout } from './../views/WebAbout.js';\nimport { WebSimpleHome } from './../views/WebSimpleHome.js';\nimport { WebUsers } from './../views/WebUsers.js';\nimport { WebFetch } from './../views/WebFetch.js';\nimport { WebTestViewtypeTemplate } from './../views/WebTestViewtypeTemplate.js';\nimport { WebTestSubscribeState } from './../views/WebTestSubscribeState.js';\nimport { WebTestAbout } from './../views/WebTestAbout.js';\nimport { WebTestPrerender } from './../views/WebTestPrerender.js';\nimport { WebHome } from './../views/WebHome.js';\nimport { WebContact } from './../views/WebContact.js';\nimport { WebTestFetch } from './../views/WebTestFetch.js';\nimport { WebTest } from './../views/WebTest.js';\nimport { AdminDashboard } from './../views/AdminDashboard.js';\nimport { LayoutsTestLayout } from './../views/LayoutsTestLayout.js';\nimport { LayoutsBase } from './../views/LayoutsBase.js';\nimport { LayoutsBaseWithViewId } from './../views/LayoutsBaseWithViewId.js';\nimport { LayoutsAdmin } from './../views/LayoutsAdmin.js';\nimport { PartialsTestPartial } from './../views/PartialsTestPartial.js';\nimport { PartialsFooter } from './../views/PartialsFooter.js';\nimport { PartialsDataExample } from './../views/PartialsDataExample.js';\nimport { CustomTestSetup } from './../views/CustomTestSetup.js';\nimport { CustomTest } from './../views/CustomTest.js';\nimport { BaseHtmlDocument } from './../views/BaseHtmlDocument.js';\nimport { TestTestUpdatestatebykey } from './../views/TestTestUpdatestatebykey.js';\nimport { TestTestSubscribeNewApproach } from './../views/TestTestSubscribeNewApproach.js';\nimport { TestCompilerTest } from './../views/TestCompilerTest.js';\nimport { TestTestSimpleUsestate } from './../views/TestTestSimpleUsestate.js';\nimport { TestTestSubscribeArrayState } from './../views/TestTestSubscribeArrayState.js';\nimport { TestTestOnyieldFixed } from './../views/TestTestOnyieldFixed.js';\nimport { TestTestUpdatestatebykey2 } from './../views/TestTestUpdatestatebykey2.js';\nimport { TemplatesGaJs } from './../views/TemplatesGaJs.js';\nimport { TemplatesSimple } from './../views/TemplatesSimple.js';\nimport { TemplatesTest } from './../views/TemplatesTest.js';\n\nexport const ViewTemplates = {\n    'web.test-viewtype-component': WebTestViewtypeComponent,\n    'web.test-wrapper': WebTestWrapper,\n    'web.test-viewtype': WebTestViewtype,\n    'web.await': WebAwait,\n    'web.user-detail': WebUserDetail,\n    'web.test-viewtype-layout': WebTestViewtypeLayout,\n    'web.about': WebAbout,\n    'web.simple-home': WebSimpleHome,\n    'web.users': WebUsers,\n    'web.fetch': WebFetch,\n    'web.test-viewtype-template': WebTestViewtypeTemplate,\n    'web.test-subscribe-state': WebTestSubscribeState,\n    'web.test-about': WebTestAbout,\n    'web.test-prerender': WebTestPrerender,\n    'web.home': WebHome,\n    'web.contact': WebContact,\n    'web.test-fetch': WebTestFetch,\n    'web.test': WebTest,\n    'admin.dashboard': AdminDashboard,\n    'layouts.test-layout': LayoutsTestLayout,\n    'layouts.base': LayoutsBase,\n    'layouts.base-with-view-id': LayoutsBaseWithViewId,\n    'layouts.admin': LayoutsAdmin,\n    'partials.test-partial': PartialsTestPartial,\n    'partials.footer': PartialsFooter,\n    'partials.data-example': PartialsDataExample,\n    'custom.test-setup': CustomTestSetup,\n    'custom.test': CustomTest,\n    'base.html-document': BaseHtmlDocument,\n    'test.test-updateStateByKey': TestTestUpdatestatebykey,\n    'test.test-subscribe-new-approach': TestTestSubscribeNewApproach,\n    'test.compiler-test': TestCompilerTest,\n    'test.test-simple-usestate': TestTestSimpleUsestate,\n    'test.test-subscribe-array-state': TestTestSubscribeArrayState,\n    'test.test-onyield-fixed': TestTestOnyieldFixed,\n    'test.test-updateStateByKey2': TestTestUpdatestatebykey2,\n    'templates.ga-js': TemplatesGaJs,\n    'templates.simple': TemplatesSimple,\n    'templates.test': TemplatesTest,\n};\n","import logger from \"./LoggerService.js\";\n\n// StorageService - Service thun ty qun l localStorage vi Event System, TTL v Encrypt\nexport class StorageService {\n    static instance = null;\n    static privateProperties = [\n        '__key', \n        '__isSupport', \n        '__data', \n        '__listeners', '__eventQueue', '__isUpdating', 'instance', \n        'set', 'get', 'remove', 'clear', 'getAll', 'has', 'getAllKeys', 'size', 'isEmpty', 'getInfo', 'debug', \n        'export', 'import', 'backup', 'restore', 'getStorageUsage', \n        'isStorageFull',\n        'setKey', 'getKey', 'support', '__loadData', '__updateData', 'emit', 'on', 'off', 'removeAllListeners', 'getEvents', 'getListenerCount',\n        'getTTLInfo', 'cleanExpired', 'enableEncryption', '__generateEncryptionKey',\n        '__encrypt', '__decrypt', '__isExpired', '__cleanExpiredData', '__createDynamicProperty', '__removeDynamicProperty'\n    ];\n    dynamicProperties = [];\n\n    constructor(key = 'onejs_storage') {\n        this.__key = key || \"onejs_storage\";\n        this.__isSupport = typeof (Storage) !== \"undefined\";\n        this.__data = {};\n        this.__listeners = new Map(); // Event listeners\n        this.__eventQueue = []; // Event queue for batching\n        this.__isUpdating = false;\n        \n        // Encryption system\n        this.encryptionKey = null;\n        this.useEncryption = false;\n        \n        if (this.__isSupport) {\n            this.__loadData();\n        }\n    }\n\n    // ==========================================\n    // PUBLIC STATIC METHODS\n    // ==========================================\n\n    /**\n     * Get the instance of the StorageService\n     * @param {string} key - The key to use for the storage\n     * @returns {StorageService} - The instance of the StorageService\n     */\n    static getInstance(key) {\n        if (!StorageService.instance) {\n            StorageService.instance = new StorageService(key);\n        }\n        return StorageService.instance;\n    }\n\n    // ==========================================\n    // PUBLIC INSTANCE METHODS - Configuration\n    // ==========================================\n\n    /**\n     * Set the key for the storage\n     * @param {string} key - The key to use for the storage\n     * @returns {StorageService} - The instance of the StorageService\n     */\n    setKey(key) {\n        if (typeof key !== 'string' || !key.trim()) {\n            throw new Error('Storage key must be a non-empty string');\n        }\n        \n        this.__key = key;\n        this.__loadData();\n        return this;\n    }\n\n    /**\n     * Get the current storage key\n     * @returns {string} - The current storage key\n     */\n    getKey() {\n        return this.__key;\n    }\n\n    /**\n     * Check if the storage is supported\n     * @returns {boolean} - True if the storage is supported, false otherwise\n     */\n    support() {\n        return this.__isSupport;\n    }\n\n    /**\n     * Enable/disable encryption\n     * @param {boolean} enable - Enable encryption\n     * @param {string} key - Encryption key (optional, will generate if not provided)\n     */\n    enableEncryption(enable = true, key = null) {\n        this.useEncryption = enable;\n        \n        if (enable && !key) {\n            // Generate a random encryption key\n            this.encryptionKey = this.__generateEncryptionKey();\n        } else if (enable && key) {\n            this.encryptionKey = key;\n        } else {\n            this.encryptionKey = null;\n        }\n        \n        logger.log(` StorageService: Encryption ${enable ? 'enabled' : 'disabled'}`);\n    }\n\n    // ==========================================\n    // PUBLIC INSTANCE METHODS - Core Storage Operations\n    // ==========================================\n\n    /**\n     * Set the data in the storage with optional TTL\n     * @param {string|object} key - The key to use for the storage\n     * @param {any} value - The value to use for the storage\n     * @param {number|null} ttl - Time to live in seconds (null = no expiration)\n     * @returns {boolean} - True if the data is set, false otherwise\n     */\n    set(key, value, ttl = null) {\n        if (!this.__isSupport) return false;\n        \n        if (key === null || key === undefined) {\n            throw new Error('Key cannot be null or undefined');\n        }\n        \n        if (typeof key === 'object' && key !== null) {\n            // Nu key l object, set nhiu key-value\n            let success = true;\n            Object.keys(key).forEach(k => {\n                const v = key[k];\n                if (!this.set(k, v, ttl)) { success = false; }\n            })\n            return success;\n        }\n        \n        if (!(typeof key === 'string' || typeof key === 'number')) {\n            throw new Error('Key must be a string when setting single value');\n        }\n        \n        // Validate TTL\n        if (ttl && (typeof ttl !== 'number' || ttl <= 0)) {\n            throw new Error('TTL must be a positive number or null');\n        }\n        \n        const oldValue = this.__data[key];\n        \n        // Create data structure with TTL\n        const dataItem = {\n            value: value,\n            timestamp: Date.now()\n        };\n        \n        if (ttl !== null) {\n            dataItem.ttl = ttl * 1000;\n        }\n        \n        this.__data[key] = dataItem;\n        \n        try {\n            this.__updateData();\n            logger.log(` StorageService: Set ${key}:`, value, ttl ? `(TTL: ${ttl}ms)` : '(no TTL)');\n            \n            this.__createDynamicProperty(key, ttl);\n            // Emit events\n            this.emit(`set:${key}`, { key, value, oldValue, ttl });\n            this.emit('set', { key, value, oldValue, ttl });\n            \n            // Create dynamic property for direct access\n\n            return true;\n        } catch (error) {\n            // Revert on error\n            this.__data[key] = oldValue;\n            throw error;\n        }\n    }\n\n    /**\n     * Get the data from the storage with TTL check\n     * @param {string} key - The key to use for the storage\n     * @param {any} defaultValue - Default value if key not found or expired\n     * @returns {any} - The value of the data or null if expired\n     */\n    get(key, defaultValue = null) {\n        if (!this.__isSupport) return defaultValue;\n        \n        if (typeof key !== 'string') {\n            throw new Error('Key must be a string');\n        }\n        \n        if (typeof this.__data[key] === 'undefined') return defaultValue;\n        \n        const dataItem = this.__data[key];\n        \n        // Check if data has TTL structure\n        if (dataItem && typeof dataItem === 'object' && 'value' in dataItem) {\n            // Check if expired\n            if (this.__isExpired(dataItem)) {\n                logger.log(` StorageService: Key ${key} has expired, removing...`);\n                this.remove(key);\n                return defaultValue;\n            }\n            \n            logger.log(` StorageService: Retrieved ${key}:`, dataItem.value);\n            return dataItem.value;\n        } else {\n            // Legacy data without TTL structure\n            logger.log(` StorageService: Retrieved ${key}:`, dataItem);\n            return dataItem;\n        }\n    }\n\n    /**\n     * Remove the data from the storage\n     * @param {string} key - The key to use for the storage\n     * @returns {boolean} - True if the data is removed, false otherwise\n     */\n    remove(key) {\n        if (!this.__isSupport) return false;\n        \n        if (typeof key !== 'string') {\n            throw new Error('Key must be a string');\n        }\n        \n        if (Object.keys(this.__data).length === 0 || typeof this.__data[key] === 'undefined') {\n            return false;\n        }\n        \n        const oldValue = this.__data[key];\n        delete this.__data[key];\n        \n        try {\n            this.__updateData();\n            logger.log(' StorageService: Removed', key);\n            \n            // Emit events\n            this.emit('remove', { key, oldValue });\n            this.emit(`remove:${key}`, { key, oldValue });\n            \n            // Remove dynamic property\n            this.__removeDynamicProperty(key);\n            \n            return true;\n        } catch (error) {\n            // Revert on error\n            this.__data[key] = oldValue;\n            throw error;\n        }\n    }\n\n    /**\n     * Clear the data from the storage\n     */\n    clear() {\n        const oldData = { ...this.__data };\n        this.__data = {};\n\n        // Remove all dynamic properties\n        if (this.dynamicProperties) {\n            for (const key of this.dynamicProperties) {\n                this.__removeDynamicProperty(key);\n            }\n            this.dynamicProperties = [];\n        }\n        \n        try {\n            this.__updateData();\n            logger.log(' StorageService: Cleared all data');\n            \n            // Emit events\n            this.emit('clear', { oldData });\n        } catch (error) {\n            // Revert on error\n            this.__data = oldData;\n            throw error;\n        }\n    }\n\n    /**\n     * Get all data from the storage (excluding expired items)\n     * @returns {object} - All valid data in storage\n     */\n    getAll() {\n        // Clean expired data first\n        this.__cleanExpiredData();\n        \n        const result = {};\n        for (const [key, dataItem] of Object.entries(this.__data)) {\n            if (dataItem && typeof dataItem === 'object' && 'value' in dataItem) {\n                result[key] = dataItem.value;\n            } else {\n                result[key] = dataItem; // Legacy data\n            }\n        }\n        return result;\n    }\n\n    /**\n     * Check if key exists and is not expired\n     * @param {string} key - The key to check\n     * @returns {boolean} - True if key exists and not expired, false otherwise\n     */\n    has(key) {\n        if (typeof key !== 'string') {\n            throw new Error('Key must be a string');\n        }\n        \n        if (typeof this.__data[key] === 'undefined') return false;\n        \n        const dataItem = this.__data[key];\n        \n        // Check if data has TTL structure\n        if (dataItem && typeof dataItem === 'object' && 'value' in dataItem) {\n            return !this.__isExpired(dataItem);\n        }\n        \n        return true; // Legacy data without TTL\n    }\n\n    /**\n     * Get all keys (excluding expired items)\n     * @returns {string[]} - Array of all valid keys\n     */\n    getAllKeys() {\n        // Clean expired data first\n        this.__cleanExpiredData();\n        \n        return Object.keys(this.__data);\n    }\n\n    /**\n     * Get storage size (number of valid keys)\n     * @returns {number} - Number of valid keys in storage\n     */\n    size() {\n        // Clean expired data first\n        this.__cleanExpiredData();\n        \n        return Object.keys(this.__data).length;\n    }\n\n    /**\n     * Check if storage is empty\n     * @returns {boolean} - True if storage is empty, false otherwise\n     */\n    isEmpty() {\n        return this.size() === 0;\n    }\n\n    /**\n     * Get storage info\n     * @returns {object} - Storage information\n     */\n    getInfo() {\n        // Clean expired data first\n        const expiredRemoved = this.__cleanExpiredData();\n        \n        return {\n            key: this.__key,\n            isSupport: this.__isSupport,\n            size: this.size(),\n            keys: this.getAllKeys(),\n            isEmpty: this.isEmpty(),\n            events: this.getEvents(),\n            totalListeners: Array.from(this.__listeners.values()).reduce((sum, listeners) => sum + listeners.length, 0),\n            isUpdating: this.__isUpdating,\n            useEncryption: this.useEncryption,\n            hasEncryptionKey: !!this.encryptionKey,\n            expiredRemoved: expiredRemoved,\n            dynamicProperties: this.dynamicProperties ? this.dynamicProperties.length : 0\n        };\n    }\n\n    /**\n     * Debug storage\n     */\n    debug() {\n        logger.log(' StorageService Debug:', this.getInfo());\n        \n        // Show TTL info for each key\n        logger.log(' TTL Information:');\n        for (const [key, dataItem] of Object.entries(this.__data)) {\n            if (dataItem && typeof dataItem === 'object' && 'value' in dataItem) {\n                const isExpired = this.__isExpired(dataItem);\n                const ttl = dataItem.ttl;\n                const remaining = dataItem.ttl ? Math.max(0, (dataItem.timestamp + dataItem.ttl) - Date.now()) : null;\n                logger.log(`  ${key}: ${isExpired ? 'EXPIRED' : 'VALID'}${dataItem.ttl ? ` (TTL: ${dataItem.ttl}ms, Remaining: ${remaining}ms)` : ' (no TTL)'}`);\n            } else {\n                logger.log(`  ${key}: LEGACY (no TTL)`);\n            }\n        }\n        \n        // Show dynamic properties\n        logger.log(' Dynamic Properties:', this.dynamicProperties || []);\n    }\n\n    // ==========================================\n    // PUBLIC INSTANCE METHODS - TTL Operations\n    // ==========================================\n\n    /**\n     * Get TTL information for a key\n     * @param {string} key - The key to check\n     * @returns {object|null} - TTL information or null if not found\n     */\n    getTTLInfo(key) {\n        if (typeof key !== 'string') {\n            throw new Error('Key must be a string');\n        }\n        \n        if (typeof this.__data[key] === 'undefined') return null;\n        \n        const dataItem = this.__data[key];\n        \n        if (dataItem && typeof dataItem === 'object' && 'value' in dataItem) {\n            const isExpired = this.__isExpired(dataItem);\n            const remaining = dataItem.ttl ? Math.max(0, (dataItem.timestamp + dataItem.ttl) - Date.now()) : null;\n            \n            return {\n                hasTTL: !!dataItem.ttl,\n                ttl: dataItem.ttl,\n                timestamp: dataItem.timestamp,\n                isExpired,\n                remaining,\n                expiryTime: dataItem.ttl ? dataItem.timestamp + dataItem.ttl : null\n            };\n        }\n        \n        return null; // Legacy data without TTL\n    }\n\n    /**\n     * Clean all expired data\n     * @returns {number} - Number of expired items removed\n     */\n    cleanExpired() {\n        return this.__cleanExpiredData();\n    }\n\n    // ==========================================\n    // PUBLIC INSTANCE METHODS - Import/Export\n    // ==========================================\n\n    /**\n     * Export data to JSON string\n     * @returns {string} - JSON string of all data\n     */\n    export() {\n        return JSON.stringify(this.getAll(), null, 2);\n    }\n\n    /**\n     * Import data from JSON string\n     * @param {string} jsonString - JSON string to import\n     * @returns {boolean} - True if import successful, false otherwise\n     */\n    import(jsonString) {\n        if (typeof jsonString !== 'string') {\n            throw new Error('JSON string must be a string');\n        }\n        \n        try {\n            const data = JSON.parse(jsonString);\n            const oldData = { ...this.__data };\n            \n            // Convert imported data to TTL structure\n            this.__data = {};\n            for (const [key, value] of Object.entries(data)) {\n                this.__data[key] = {\n                    value: value,\n                    timestamp: Date.now()\n                };\n            }\n            \n            this.__updateData();\n            \n            logger.log(' StorageService: Imported data successfully');\n            \n            // Emit events\n            this.emit('import', { oldData, newData: data });\n            \n            return true;\n        } catch (error) {\n            logger.error(' StorageService: Failed to import data:', error);\n            return false;\n        }\n    }\n\n    /**\n     * Backup current data\n     * @returns {object} - Backup data with timestamp\n     */\n    backup() {\n        return {\n            timestamp: Date.now(),\n            key: this.__key,\n            data: { ...this.__data } // Return copy\n        };\n    }\n\n    /**\n     * Restore from backup\n     * @param {object} backup - Backup data\n     * @returns {boolean} - True if restore successful, false otherwise\n     */\n    restore(backup) {\n        if (!backup || typeof backup !== 'object') {\n            throw new Error('Backup must be a valid object');\n        }\n        \n        if (!backup.data) {\n            logger.error(' StorageService: Invalid backup data');\n            return false;\n        }\n\n        const oldData = { ...this.__data };\n        this.__data = { ...backup.data }; // Use copy\n        \n        try {\n            this.__updateData();\n            logger.log(' StorageService: Restored from backup:', backup.timestamp);\n            \n            // Emit events\n            this.emit('restore', { oldData, newData: backup.data, backup });\n            \n            return true;\n        } catch (error) {\n            // Revert on error\n            this.__data = oldData;\n            throw error;\n        }\n    }\n\n    // ==========================================\n    // PUBLIC INSTANCE METHODS - Storage Utilities\n    // ==========================================\n\n    /**\n     * Get storage usage in bytes\n     * @returns {number} - Storage usage in bytes\n     */\n    getStorageUsage() {\n        if (!this.__isSupport) return 0;\n        \n        try {\n            const data = localStorage.getItem(this.__key);\n            return data ? new Blob([data]).size : 0;\n        } catch (error) {\n            logger.error(' StorageService: Failed to get storage usage:', error);\n            return 0;\n        }\n    }\n\n    /**\n     * Check if storage is full\n     * @returns {boolean} - True if storage is full, false otherwise\n     */\n    isStorageFull() {\n        try {\n            const testKey = '__storage_test__';\n            const testValue = 'x'.repeat(1024); // 1KB test\n            \n            localStorage.setItem(testKey, testValue);\n            localStorage.removeItem(testKey);\n            return false;\n        } catch (error) {\n            return true; // Storage is full\n        }\n    }\n\n    // ==========================================\n    // PUBLIC INSTANCE METHODS - Event System\n    // ==========================================\n\n    /**\n     * Add event listener\n     * @param {string} event - Event name\n     * @param {function} callback - Callback function\n     * @returns {function} - Unsubscribe function\n     */\n    on(event, callback) {\n        if (typeof event !== 'string' || !event.trim()) {\n            throw new Error('Event name must be a non-empty string');\n        }\n        \n        if (typeof callback !== 'function') {\n            throw new Error('Callback must be a function');\n        }\n        \n        if (!this.__listeners.has(event)) {\n            this.__listeners.set(event, []);\n        }\n        \n        this.__listeners.get(event).push(callback);\n        logger.log(` StorageService: Added listener for event: ${event}`);\n        \n        // Return unsubscribe function\n        return () => this.off(event, callback);\n    }\n\n    /**\n     * Remove event listener\n     * @param {string} event - Event name\n     * @param {function} callback - Callback function\n     */\n    off(event, callback) {\n        if (!this.__listeners.has(event)) return;\n        \n        const listeners = this.__listeners.get(event);\n        const index = listeners.indexOf(callback);\n        if (index > -1) {\n            listeners.splice(index, 1);\n            logger.log(` StorageService: Removed listener for event: ${event}`);\n        }\n    }\n\n    /**\n     * Remove all listeners for an event\n     * @param {string} event - Event name\n     */\n    removeAllListeners(event) {\n        if (event) {\n            this.__listeners.delete(event);\n            logger.log(` StorageService: Removed all listeners for event: ${event}`);\n        } else {\n            this.__listeners.clear();\n            logger.log(' StorageService: Removed all listeners');\n        }\n    }\n\n    /**\n     * Get all registered events\n     * @returns {string[]} - Array of event names\n     */\n    getEvents() {\n        return Array.from(this.__listeners.keys());\n    }\n\n    /**\n     * Get listener count for an event\n     * @param {string} event - Event name\n     * @returns {number} - Number of listeners\n     */\n    getListenerCount(event) {\n        return this.__listeners.has(event) ? this.__listeners.get(event).length : 0;\n    }\n\n    // ==========================================\n    // PRIVATE METHODS\n    // ==========================================\n\n    /**\n     * Generate encryption key\n     * @returns {string} - Generated encryption key\n     */\n    __generateEncryptionKey() {\n        const array = new Uint8Array(32);\n        crypto.getRandomValues(array);\n        return Array.from(array, byte => byte.toString(16).padStart(2, '0')).join('');\n    }\n\n    /**\n     * Encrypt data\n     * @param {string} data - Data to encrypt\n     * @returns {string} - Encrypted data\n     */\n    __encrypt(data) {\n        if (!this.useEncryption || !this.encryptionKey) {\n            return data;\n        }\n        \n        try {\n            // Simple XOR encryption (for development purposes)\n            // In production, use proper encryption like AES\n            let encrypted = '';\n            for (let i = 0; i < data.length; i++) {\n                const charCode = data.charCodeAt(i) ^ this.encryptionKey.charCodeAt(i % this.encryptionKey.length);\n                encrypted += String.fromCharCode(charCode);\n            }\n            return btoa(encrypted); // Base64 encode\n        } catch (error) {\n            console.error(' StorageService: Encryption failed:', error);\n            return data;\n        }\n    }\n\n    /**\n     * Decrypt data\n     * @param {string} data - Data to decrypt\n     * @returns {string} - Decrypted data\n     */\n    __decrypt(data) {\n        if (!this.useEncryption || !this.encryptionKey) {\n            return data;\n        }\n        \n        try {\n            // Simple XOR decryption (for development purposes)\n            const decoded = atob(data); // Base64 decode\n            let decrypted = '';\n            for (let i = 0; i < decoded.length; i++) {\n                const charCode = decoded.charCodeAt(i) ^ this.encryptionKey.charCodeAt(i % this.encryptionKey.length);\n                decrypted += String.fromCharCode(charCode);\n            }\n            return decrypted;\n        } catch (error) {\n            console.error(' StorageService: Decryption failed:', error);\n            return data;\n        }\n    }\n\n    /**\n     * Check if data is expired\n     * @param {object} dataItem - Data item with timestamp and ttl\n     * @returns {boolean} - True if expired, false otherwise\n     */\n    __isExpired(dataItem) {\n        if (!dataItem || !dataItem.timestamp || !dataItem.ttl) {\n            return false; // No TTL, not expired\n        }\n        \n        const now = Date.now();\n        const expiryTime = dataItem.timestamp + dataItem.ttl;\n        return now > expiryTime;\n    }\n\n    /**\n     * Clean expired data\n     * @returns {number} - Number of expired items removed\n     */\n    __cleanExpiredData() {\n        let removed = 0;\n        const keysToRemove = [];\n        \n        for (const [key, dataItem] of Object.entries(this.__data)) {\n            if (this.__isExpired(dataItem)) {\n                keysToRemove.push(key);\n            }\n        }\n        \n        for (const key of keysToRemove) {\n            delete this.__data[key];\n            removed++;\n            logger.log(` StorageService: Removed expired key: ${key}`);\n        }\n        \n        if (removed > 0) {\n            this.__updateData();\n        }\n        \n        return removed;\n    }\n\n    /**\n     * Load the data from the storage (private method)\n     */\n    __loadData() {\n        if (!this.__isSupport) return;\n        \n        try {\n            const data = localStorage.getItem(this.__key);\n            if (data) {\n                const decryptedData = this.__decrypt(data);\n                this.__data = JSON.parse(decryptedData);\n                \n                // Clean expired data on load\n                this.__cleanExpiredData();\n            }\n        } catch (error) {\n            console.error(' StorageService: Failed to load data:', error);\n            this.__data = {};\n        }\n    }\n\n    /**\n     * Update the data in the storage (private method)\n     */\n    __updateData() {\n        if (!this.__isSupport || this.__isUpdating) return;\n        \n        this.__isUpdating = true;\n        \n        try {\n            const jsonData = JSON.stringify(this.__data);\n            const encryptedData = this.__encrypt(jsonData);\n            localStorage.setItem(this.__key, encryptedData);\n            logger.log(' StorageService: Updated data for key:', this.__key);\n        } catch (error) {\n            logger.error(' StorageService: Failed to update data:', error);\n            throw error;\n        } finally {\n            this.__isUpdating = false;\n        }\n    }\n\n    /**\n     * Emit event to all listeners (private method)\n     * @param {string} event - Event name\n     * @param {any} data - Event data\n     */\n    emit(event, data) {\n        if (!this.__listeners.has(event)) return;\n        \n        const listeners = this.__listeners.get(event);\n        listeners.forEach(callback => {\n            try {\n                callback(data);\n            } catch (error) {\n                console.error(` StorageService: Error in event listener for ${event}:`, error);\n            }\n        });\n    }\n\n    /**\n     * Create dynamic property for direct access\n     * @param {string} key - The key\n     * @param {number|null} ttl - TTL value\n     */\n    __createDynamicProperty(key, ttl) {\n        try {\n            if (!StorageService.privateProperties.includes(key) && !this.dynamicProperties.includes(key)) {\n                this.dynamicProperties.push(key);\n                Object.defineProperty(this, key, {\n                    set: (value) => this.set(key, value, ttl),\n                    get: () => this.get(key),\n                    configurable: true\n                });\n            }\n        } catch (error) {\n            logger.error(' StorageService: Failed to create dynamic property:', error);\n        }\n    }\n\n    /**\n     * Remove dynamic property\n     * @param {string} key - The key to remove\n     */\n    __removeDynamicProperty(key) {\n        try {\n            if (this.dynamicProperties && this.dynamicProperties.includes(key)) {\n                delete this[key];\n                this.dynamicProperties = this.dynamicProperties.filter(k => k !== key);\n            }\n        } catch (error) {\n            logger.error(' StorageService: Failed to remove dynamic property:', error);\n        }\n    }\n}\n\n// Export singleton instance\nconst storage = StorageService.getInstance('onejs_storage');\nexport default storage;","import { SEOTagConfig } from './SEOConfig.js';\nimport { ViewTemplates } from './ViewTemplate.js';\nimport { hasData, uniqId } from '../helpers/utils.js';\nimport { ViewEngine } from './ViewEngine.js';\nimport { ViewState } from './ViewState.js';\nimport { ATTR } from './ViewConfig.js';\nimport logger from './services/LoggerService.js';\nimport { OneMarkup } from './OneMarkup.js';\nimport { StorageService } from './services/StorageService.js';\nimport OneDOM from './OneDOM.js';\n\n\nclass SSRViewData {\n    constructor(viewData) {\n        const { instances, indexMap } = this.parseViewData(viewData);\n        this.instances = instances;\n        this.indexMap = indexMap;\n        this.index = 0;\n        this.maxIndex = indexMap.length - 1;\n    }\n    parseViewData(viewData) {\n        let instances = viewData.instances || {};\n        const instancesMap = new Map();\n        const keys = Object.keys(instances);\n        keys.forEach(key => {\n            instancesMap.set(key, instances[key]);\n        });\n        const indexMap = keys;\n        return {\n            instances: instancesMap,\n            indexMap: indexMap,\n        };\n    }\n    get(index = null) {\n        if (index === null) {\n            index = this.index;\n        }\n        this.index = index;\n        return this.instances.get(this.indexMap[index]) ?? null;\n    }\n    next() {\n        this.index++;\n        return this.get(this.index);\n    }\n    prev() {\n        this.index--;\n        return this.get(this.index);\n    }\n    getById(id) {\n        return this.instances.get(id) ?? null;\n    }\n    scan() {\n        let index = this.index;\n        this.index++;\n        let instance = this.get(index);\n        if (!instance) {\n            this.index--;\n            return null;\n        }\n        return instance;\n    }\n}\n\nclass SSRViewDataCollection {\n    constructor(views) {\n        /**\n         * @type {Object<string, SSRViewData>}\n         */\n        this.views = new Map();\n        this.setViews(views);\n    }\n    setViews(views) {\n        if (typeof views !== 'object' || !views || Object.keys(views).length === 0) {\n            return;\n        }\n        Object.keys(views).forEach(name => {\n            this.views.set(name, new SSRViewData(views[name]));\n        });\n    }\n    get(name) {\n        return this.views.get(name) ?? null;\n    }\n    scan(name) {\n        return this.get(name)?.scan() ?? null;\n    }\n    getInstance(name, id) {\n        return this.get(name)?.getById(id) ?? null;\n    }\n}\n\nexport class View {\n    constructor(App = null) {\n        /**\n         * @type {Application}\n         */\n        this.App = App;\n\n        this.markupService = OneMarkup;\n        /**\n         * @type {StorageService}\n         */\n        this.storageService = StorageService.getInstance('onejs_view_data');\n        /**\n         * @type {HTMLElement}\n         */\n        this.container = null;\n        /**\n         * @type {Object<string, function>}\n         */\n        this.stateChangeListeners = {};\n        /**\n         * @type {ViewEngine}\n         */\n        this.currentMasterView = null;\n        /**\n         * @type {ViewEngine}\n         */\n        this.Engine = ViewEngine;\n        /**\n         * @type {ViewState}\n         */\n        this.State = ViewState;\n        /**\n         * @type {Object<string, ViewEngine>}\n         */\n        this.templates = ViewTemplates;\n        /**\n         * @type {Object<string, string>}\n         */\n        this._sections = {};\n        /**\n         * @type {Array<string>}\n         */\n        this._changedSections = [];\n        /**\n         * @type {Object<string, Array<string>>}\n         */\n        this._stacks = {};\n\n        /**\n         * @type {boolean}\n         */\n        this.scanMode = false;\n        /**\n         * @type {Object<string, boolean>}\n         */\n        this._once = {};\n        /**\n         * @type {HTMLElement}\n         */\n        this.vitualContainer = document.createElement('div');\n        this.vitualContainer.setAttribute('id', 'data-vitual-container');\n        this.vitualContainer.style.display = 'none';\n        /**\n         * @type {Array<ViewEngine>}\n         */\n        this.VIEW_MOUNTED_QUEUE = [];\n        /**\n         * @type {ViewEngine}\n         */\n        this.CURRENT_SUPER_VIEW = null;\n\n        this.CURRENT_SUPER_VIEW_PATH = null;\n        /**\n         * @type {boolean}\n         */\n        this.CURRENT_SUPER_VIEW_MOUNTED = false;\n        /**\n         * @type {ViewEngine}\n         */\n        this.CURRENT_VIEW = null;\n\n        this.CURRENT_VIEW_PATH = null;\n        /**\n         * @type {boolean}\n         */\n        this.CURRENT_VIEW_MOUNTED = false;\n\n        /**\n         * @type {Array<ViewEngine>}\n         */\n        this.SUPER_VIEW_STACK = [];\n        /**\n         * @type {Array<ViewEngine>}\n         */\n        this.ALL_VIEW_STACK = [];\n        /**\n         * @type {ViewEngine}\n         */\n        this.PAGE_VIEW = null;\n        /**\n         * @type {number}\n         */\n        this.renderTimes = -1;\n\n        /**\n         * @type {Object<string, ViewEngine>}\n         */\n        this.cachedViews = {};\n        /**\n         * @type {Object<string, any>}\n         */\n        this.serverRenderData = {};\n        /**\n         * @type {Map<string, ViewEngine>}\n         */\n        this.viewMap = new Map();\n\n        /**\n         * @type {Map<string, Object<string, any>>}\n         */\n        this.cachedPageData = new Map();\n\n        // document.body.appendChild(this.vitualContainer);\n        /**\n         * @type {Object<string, any>}\n         */\n        this.wrapperConfig = {\n\n        };\n\n        this.listeners = {};\n\n        this.ssrData = {};\n        this.ssrViewManager = new SSRViewDataCollection();\n\n        /**\n         * @type {Map<string, ViewEngine>}\n         */\n        this.cachedPageView = new Map();\n\n        this.cachedTimes = 600; // mc nh cache 10 pht\n\n\n        /**\n         * @type {Object<string, any>}\n         */\n        this.SEO = {\n            tags: SEOTagConfig,\n            updateItem: function (key, value) {\n                const items = this.tags[key];\n                if (!items || items.length == 0) return false;\n                items.forEach(item => {\n                    let element = document.querySelector(item.selector);\n                    if (!element) {\n                        element = document.createElement(item.tag);\n                        if (item.attrs) {\n                            Object.entries(item.attrs).forEach(([key, value]) => {\n                                element.setAttribute(key, value);\n                            });\n                        }\n                        document.head.appendChild(element);\n                    };\n\n                    if (item.attribute) {\n                        if (item.attribute == \"@content\") {\n                            element.textContent = value;\n                        } else {\n                            element.setAttribute(item.attribute, value);\n                        }\n                    }\n                });\n                return true;\n            }\n        };\n\n\n\n\n\n    }\n\n    setApp(app) {\n        this.App = app;\n    }\n    setContainer(container) {\n        this.container = container;\n    }\n\n    /**\n     * Initialize SPA\n     */\n    init(data = {}) {\n        // console.log('App.View initialized', data);\n\n        // Clear sections and stacks on page load\n        this._sections = {};\n        this._stacks = {};\n        this._once = {};\n        this._changedSections = [];\n\n        // Initialize views if not already done\n        if (!this.templates) {\n            this.templates = ViewTemplates;\n        }\n\n        // Initialize current scope\n        this._currentScope = 'web';\n\n        this.ssrData = data?.ssrData || {};\n        this.ssrViewManager.setViews(this.ssrData);\n    }\n\n    /**\n     * Get view by name\n     * @param {string} name - View name\n     * @returns {ViewEngine|null} View object or null if not found\n     */\n    getView(name) {\n        return this.templates[name] || null;\n    }\n\n\n    /**\n     * Load and render view with master view handling\n     * @param {string} name - View name\n     * @param {Object} data - Data to pass to view\n     * @param {string} urlPath - URL path for the view\n     * @returns {Object<html: string, error: string, superView: ViewEngine, isSuperView: boolean, needInsert: boolean, ultraView: ViewEngine>} Final rendered HTML string\n     */\n    loadView(name, data = {}, urlPath = '') {\n        // console.log(' App.View.loadView called with:', name, data);\n        if (this.templates[name]) {\n            this.clearOldRendering();\n        }\n        this.renderTimes++;\n        let message = null;\n        this.CURRENT_SUPER_VIEW_MOUNTED = false;\n\n        try {\n            let hasCache = false;\n            if (this.cachedTimes > 0) {\n                let cacheKey = name.replace('.', '_') + '_' + urlPath?.replace(/\\//g, '_');\n                const cachedData = this.storageService.get(cacheKey);\n                if (cachedData) {\n                    data = { ...data, ...cachedData };\n                    hasCache = true;\n                }\n            }\n            // Get view from templates\n            let view = this.view(name, hasCache ? { ...data } : null);\n            // console.log(' View loaded:', view);\n            if (!view) {\n                message = `App.View.loadView: View '${name}' not found`;\n                return {\n                    error: `App.View.loadView: View '${name}' not found`,\n                    html: null,\n                    superView: null,\n                    isSuperView: false,\n                    needInsert: false,\n                };\n            }\n            if (urlPath) {\n                view.urlPath = urlPath;\n            }\n            if (this.cachedTimes > 0) {\n                if (this.PAGE_VIEW instanceof ViewEngine) {\n                    const oldCacheData = this.PAGE_VIEW.data;\n                    let cacheKey = this.PAGE_VIEW.path.replace('.', '_') + '_' + this.PAGE_VIEW.urlPath?.replace(/\\//g, '_');\n                    this.storageService.set(cacheKey, oldCacheData, 3600); // cache trong 1 gi\n                }\n            }\n\n            // Store view in array for tracking\n\n            let superView = null;\n            let superViewPath = null;\n            let result;\n            let currentViewPath = view.path;\n            let currentView = view;\n            let ultraView = view;\n            let renderIndex = 0;\n            // vng lp  render view cho n khi khng c super view hoc khng c super view th render view\n            do {\n                try {\n                    // console.log(' App.View.loadView in do while view:' + view.path);\n                    // kim tra view c super view khng\n                    if (view.hasSuperView) {\n                        this.ALL_VIEW_STACK.unshift(view);\n                        // console.log(' App.View.loadView has super view:', view.superViewPath);\n                        superViewPath = view.superViewPath;\n                        result = this.renderView(view);\n                        view = result;\n                        view.setIsSuperView(true);\n                        if (view && typeof view === 'object') {\n                            superView = view;\n                            ultraView = view;\n                        }\n                        // console.log(' App.View.loadView super view:', view);\n                    }\n                    // kim tra view c phi l super view khng\n                    else if (view.isSuperView) {\n                        if (superViewPath !== view.path) {\n                            this.SUPER_VIEW_STACK.unshift(view);\n                            superViewPath = view.path;\n                        }\n                        // superViewPath = view.path;\n                        superView = view;\n                        // console.log(' App.View.loadView is super view:', view.path);\n                        if (view.hasSuperView) {\n                            result = this.renderView(view, renderIndex > 0 ? view.data : null);\n                            view = result;\n                            view.setIsSuperView(true);\n                            if (view && typeof view === 'object') {\n                                superView = view;\n                                superViewPath = view.path;\n                                ultraView = view;\n                            }\n                        } else {\n                            result = '';// nu l super view th khng cn thm vo queue v khng render.  bc sau x l\n                        }\n                    }\n                    // nu khng c super view v khng phi l super view th render view\n                    else {\n\n                        this.ALL_VIEW_STACK.unshift(view);\n                        // this.PAGE_VIEW = view;\n                        // console.log(' App.View.loadView normal view:', view.path);\n                        result = this.renderView(view, renderIndex > 0 ? view.data : null);\n                        ultraView = view;\n                    }\n                } catch (error) {\n                    message = `App.View.loadView: Error rendering view '${name}':` + error.message;\n                    console.error(' App.View.loadView error:', error);\n                    return '';\n                }\n                renderIndex++;\n            } while (result && typeof result === 'object' && result instanceof ViewEngine)\n            // Update #spa-root with the final string\n            // console.log(\"view after check\", { currentViewPath, superViewPath })\n            try {\n                let html = result;\n                // diu kin c cn insert content vo html khng\n                const needInsert = !(superViewPath && superViewPath === this.CURRENT_SUPER_VIEW_PATH);\n                if (superViewPath) {\n                    // kim tra view c phi l super view khng\n                    if (!needInsert) { // nu khng cn insert content vo html th set trang thi super view mounted = true\n                        // console.log(' App.View.loadView need insert super view:', superViewPath);\n                        this.CURRENT_SUPER_VIEW_MOUNTED = true;\n                    } else { // nu cn insert content vo html th set trang thi super view mounted = false v render super view\n                        this.CURRENT_SUPER_VIEW_PATH = superViewPath;\n                        this.CURRENT_SUPER_VIEW = superView;\n                        // this.CURRENT_SUPER_VIEW_MOUNTED = false;\n                        html = superView.render();\n                        // console.log(' App.View.loadView render super view:', html);\n\n\n                    }\n                }\n                // console.log(' App.View.loadView need insert:', needInsert);\n                // console.log(' App.View.loadView return in try');\n                return {\n                    html: html,\n                    isSuperView: superViewPath ? true : false,\n                    needInsert: needInsert,\n                    superView: superView,\n                    ultraView: ultraView,\n                    error: null\n                };\n\n            } catch (error) {\n                message = 'App.View.loadView: Error updating DOM:', error;\n\n            }\n\n            // console.log(` App.View.loadView: Successfully loaded view '${name}'`);\n\n        } catch (error) {\n            message = `App.View.loadView: Critical error loading view '${name}':`, error;\n\n        }\n        return {\n            html: null,\n            needInsert: false,\n            superView: null,\n            ultraView: null,\n            isSuperView: false,\n            error: message\n        };\n    }\n\n\n    scanView(name, route = null) {\n        if (this.templates[name]) {\n            this.clearOldRendering();\n        }\n        this.renderTimes++;\n        let message = null;\n        this.CURRENT_SUPER_VIEW_MOUNTED = false;\n        try {\n            const viewData = this.ssrViewManager.scan(name);\n            if (!viewData) {\n                message = `App.View.scanView: View '${name}' not found`;\n                return {\n                    error: `App.View.scanView: View '${name}' not found`,\n                    html: null,\n                    superView: null,\n                    isSuperView: false,\n                    needInsert: false,\n                };\n            }\n            const data = viewData.data;\n            data.__SSR_VIEW_ID__ = viewData.viewId;\n            // console.log(' App.View.scanView called with:', name, data);\n\n            // Get view from templates\n            let view = this.view(name, data);\n            if (!view) {\n                message = `App.View.loadView: View '${name}' not found`;\n                return {\n                    error: `App.View.loadView: View '${name}' not found`,\n                    html: null,\n                    superView: null,\n                    isSuperView: false,\n                    needInsert: false,\n                };\n            }\n            if (route && route.$urlPath) {\n                view.urlPath = route.$urlPath;\n            }\n\n\n            // Store view in array for tracking\n            let superView = null;\n            let superViewPath = null;\n            let result;\n            let currentViewPath = view.path;\n            let currentView = view;\n            let ultraView = view;\n            this.PAGE_VIEW = view;\n            view.__scan(viewData);\n            // vng lp  render view cho n khi khng c super view hoc khng c super view th render view\n            let renderIndex = 0;\n            do {\n                try {\n\n                    // kim tra view c super view khng\n                    if (view.hasSuperView) {\n\n                        this.ALL_VIEW_STACK.unshift(view);\n                        superViewPath = view.superViewPath;\n                        result = this.scanRenderedView(view);\n                        view = result;\n                        view.setIsSuperView(true);\n                        if (view && typeof view === 'object') {\n                            superView = view;\n                            ultraView = view;\n                            if (!view.isScanned) {\n\n                                // ============================================================\n                                // CRITICAL FIX: Scan super view DOM + attach events\n                                // ============================================================\n                                // Get super view SSR data and scan it\n                                const superViewData = this.ssrViewManager.scan(superViewPath);\n                                if (superViewData) {\n                                    // logger.log(` View.scanView: Scanning super view ${superViewPath}`);\n                                    superView.__scan(superViewData);\n                                    // logger.log(` View.scanView: Super view ${superViewPath} scanned`);\n                                } else {\n                                    // logger.warn(` View.scanView: No SSR data for super view ${superViewPath}`);\n                                }\n                            }\n                        }\n                        // console.log(' App.View.scanView super view:', view);\n                    }\n                    // kim tra view c phi l super view khng\n                    else if (view.isSuperView) {\n                        if (superViewPath !== view.path) {\n                            this.SUPER_VIEW_STACK.unshift(view);\n                            superViewPath = view.path;\n                            ultraView = view;\n                        }\n\n                        superView = view;\n                        ultraView = view;\n                        // console.log(' App.View.scanView is super view:', view.path);\n                        if (view.hasSuperView) {\n                            result = this.scanRenderedView(view);\n                            view = result;\n                            view.setIsSuperView(true);\n                            if (view && typeof view === 'object') {\n                                superView = view;\n                                superViewPath = view.path;\n                                ultraView = view;\n                                if (!view.isScanned) {\n                                    // ============================================================\n                                    // CRITICAL FIX: Scan nested super view\n                                    // ============================================================\n                                    const nestedSuperViewData = this.ssrViewManager.scan(superViewPath);\n                                    if (nestedSuperViewData) {\n                                        // logger.log(` View.scanView: Scanning nested super view ${superViewPath}`);\n                                        superView.__scan(nestedSuperViewData);\n                                        // logger.log(` View.scanView: Nested super view ${superViewPath} scanned`);\n                                    }\n                                }\n                            }\n                        } else {\n                            result = '';// nu l super view th khng cn thm vo queue v khng render.  bc sau x l\n                        }\n                    }\n                    // nu khng c super view v khng phi l super view th render view\n                    else {\n                        this.ALL_VIEW_STACK.unshift(view);\n                        this.PAGE_VIEW = view;\n                        // console.log(' App.View.scanView normal view:', view.path);\n                        result = this.scanRenderedView(view);\n                        ultraView = view;\n                    }\n                } catch (error) {\n                    message = `App.View.scanView: Error rendering view '${name}':`, error;\n                    console.error(' App.View.scanView error:', error);\n                    return '';\n                }\n                renderIndex++;\n            } while (result && typeof result === 'object' && result.constructor === this.Engine)\n            // Update #spa-root with the final string\n            // console.log(\"view after check\", { currentViewPath, superViewPath })\n            try {\n                let html = result;\n                // diu kin c cn insert content vo html khng\n                const needInsert = !(superViewPath && superViewPath === this.CURRENT_SUPER_VIEW_PATH);\n                if (superViewPath) {\n                    // kim tra view c phi l super view khng\n                    if (!needInsert) { // nu khng cn insert content vo html th set trang thi super view mounted = true\n                        console.log(' App.View.scanView need insert super view:', superViewPath);\n                        this.CURRENT_SUPER_VIEW_MOUNTED = true;\n                    } else { // nu cn insert content vo html th set trang thi super view mounted = false v render super view\n                        this.CURRENT_SUPER_VIEW_PATH = superViewPath;\n                        this.CURRENT_SUPER_VIEW = superView;\n                        this.CURRENT_SUPER_VIEW_MOUNTED = false;\n                        html = superView.virtualRender();\n                        console.log(' App.View.scanView render super view:', html);\n\n\n                    }\n                }\n\n                // ============================================================\n                // LIFECYCLE: Mount all views in bottom-up order\n                // ============================================================\n                // After scanning and virtual render complete, mount all views\n                // in reverse order (deepest layout  page view)\n                this.mountAllViewsFromStack(this.renderTimes).then(() => {\n                    logger.log(' View.scanView: All views mounted successfully in bottom-up order');\n                }).catch(error => {\n                    logger.error(' View.scanView: Error mounting views:', error);\n                });\n\n                return {\n                    html: html,\n                    isSuperView: superViewPath ? true : false,\n                    needInsert: needInsert,\n                    superView: superView,\n                    ultraView: ultraView,\n                    error: null\n                };\n\n            } catch (error) {\n                message = 'App.View.scanView: Error updating DOM:' + error.message;\n\n            }\n\n            // console.log(` App.View.scanView: Successfully loaded view '${name}'`);\n\n        } catch (error) {\n            message = `App.View.scanView: Critical error loading view '${name}':` + error.message;\n\n        }\n        return {\n            html: null,\n            needInsert: false,\n            superView: null,\n            isSuperView: false,\n            ultraView: null,\n            error: message\n        };\n    }\n\n    mountView(viewName, params = {}, route = null) {\n        try {\n            let currentSuperView = this.CURRENT_SUPER_VIEW;\n            if (currentSuperView && currentSuperView instanceof ViewEngine) {\n                currentSuperView.unmounted();\n            }\n            const viewResult = this.loadView(viewName, params, route?.$urlPath || '');\n            if (viewResult.error) {\n                console.error('View rendering error:', viewResult.error);\n                return;\n            }\n            console.log('View rendered successfully:', viewResult);\n\n            if (viewResult.needInsert && viewResult.html) {\n                const container = this.container || document.querySelector('#app-root') || document.querySelector('#app') || document.body;\n                const html = viewResult.html\n                if (container) {\n                    OneDOM.setHTML(container, html);\n                }\n            } else {\n                console.log('Router: Not updating DOM - needInsert:', viewResult.needInsert, 'html:', !!viewResult.html);\n            }\n\n            // Emit changed sections\n            if (this.emitChangedSections) {\n                this.emitChangedSections();\n            }\n\n            if (viewResult.ultraView && viewResult.ultraView instanceof ViewEngine) {\n                viewResult.ultraView.mounted();\n            }\n            this.CURRENT_SUPER_VIEW_MOUNTED = true; // set trang thi super view mounted = true\n\n\n        } catch (error) {\n            console.error('Error rendering view:', error);\n        }\n    }\n\n    mountViewScan(viewName, params = {}, route = null) {\n\n        // ============================================================\n        // CORE HYDRATION: Scan SSR HTML and attach JS behavior\n        // ============================================================\n        // scanView() will:\n        // 1. Parse SSR data from HTML comments\n        // 2. Create view instances (page + layouts)\n        // 3. Call virtualRender() to setup relationships\n        // 4. Scan DOM and attach event handlers\n        // 5. Setup state subscriptions\n        // 6. Mount all views in bottom-up order (deepest layout  page)\n        const scanResult = this.scanView(viewName);\n        // console.log(scanResult);\n        if (scanResult.error) {\n            console.error(' Router.hydrateViews: Scan error:', scanResult.error);\n            return;\n        }\n\n        if (scanResult.ultraView && scanResult.ultraView instanceof ViewEngine) {\n            scanResult.ultraView.mounted();\n        }\n        this.CURRENT_SUPER_VIEW_MOUNTED = true; // set trang thi super view mounted = true\n        this._isHydrated = true;\n    }\n\n\n    mountContent(htmlContent) {\n        const container = this.container || document.querySelector('#app-root') || document.querySelector('#app') || document.body;\n        if (container) {\n            OneDOM.setHTML(container, htmlContent);\n        }\n    }\n\n\n    // ============================================================================\n    // EVENT FUNCTIONS\n    // ============================================================================\n\n\n    on(event, callback) {\n        if (typeof event !== 'string' || event === '') {\n            return false;\n        }\n        if (typeof callback !== 'function') {\n            return false;\n        }\n        if (!this.listeners[event]) {\n            this.listeners[event] = [];\n        }\n        this.listeners[event].push(callback);\n    }\n    off(event, callback) {\n        if (typeof event !== 'string' || event === '') {\n            return false;\n        }\n        if (typeof callback !== 'function') {\n            return false;\n        }\n        if (!this.listeners[event]) {\n            return;\n        }\n        this.listeners[event] = this.listeners[event].filter(cb => cb !== callback);\n    }\n    emit(event, ...args) {\n        if (typeof event !== 'string' || event === '') {\n            return false;\n        }\n        if (!this.listeners[event]) {\n            return;\n        }\n        this.listeners[event].forEach(callback => callback(...args));\n    }\n    // ============================================================================\n    // CORE FUNCTIONS\n    // ============================================================================\n\n    /**\n     * Generate unique view ID\n     * @returns {string} UUID v4\n     */\n    generateViewId() {\n        return uniqId();\n    }\n\n    /**\n     * Execute function and return result\n     * @param {Function} fn - Function to execute\n     * @returns {string} Result as string\n     */\n    execute(fn, defaultValue = '') {\n        try {\n            const result = fn();\n            return result !== undefined ? result : defaultValue;\n        } catch (error) {\n            logger.error('App.execute error:', error);\n            return defaultValue;\n        }\n    }\n\n    evaluate(fn, defaultValue = '') {\n        try {\n            const result = fn();\n            return result !== undefined ? result : defaultValue;\n        } catch (error) {\n            logger.error('App.evaluate error:', error);\n            return defaultValue;\n        }\n    }\n    /**\n     * Escape string for HTML output\n     * @param {*} value - Value to escape\n     * @returns {string} Escaped string\n     */\n    escString(value) {\n        if (value === null || value === undefined) {\n            return '';\n        }\n\n        const str = String(value);\n        return str\n            .replace(/&/g, '&amp;')\n            .replace(/</g, '&lt;')\n            .replace(/>/g, '&gt;')\n            .replace(/\"/g, '&quot;')\n            .replace(/'/g, '&#39;');\n    }\n\n    /**\n     * Get text content (for preloader messages)\n     * @param {string} key - Text key\n     * @returns {string} Text content\n     */\n    text(key) {\n        const texts = {\n            'loading': 'Loading...',\n            'error': 'Error occurred',\n            'not_found': 'Not found',\n            'unauthorized': 'Unauthorized'\n        };\n\n        return texts[key] || key;\n    }\n\n\n    // ============================================================================\n    // INIT FUNCTIONS\n    // ============================================================================\n    setSuperViewPath(superView) {\n        this.CURRENT_SUPER_VIEW_PATH = superView;\n    }\n    addViewEngine(renderTimes, viewEngine) {\n        if (typeof this.VIEW_MOUNTED_QUEUE[renderTimes] === 'undefined') {\n            this.VIEW_MOUNTED_QUEUE[renderTimes] = [];\n        }\n        this.VIEW_MOUNTED_QUEUE[renderTimes].push(viewEngine);\n    }\n    /**\n     * Gi hm mounted ca ViewEngine\n     * @param {number} renderTimes - S ln render hin ti (dng lm key cho queue).\n     * @param {string} viewEngineId - ID ca ViewEngine cn gi hm mounted.\n     */\n    callViewEngineMounted(renderTimes, viewEngineId) {\n        return;\n    }\n\n    /**\n     * Mount all views in bottom-up order (last  first)\n     * This ensures parent views mount after their children\n     *\n     * Flow:\n     * 1. Layout View 2 (deepest) mounted first\n     * 2. Layout View 1 mounted\n     * 3. Included views mounted\n     * 4. First View (page view) mounted last\n     *\n     * @param {number} renderTimes - S ln render hin ti\n     * @returns {Promise<void>}\n     */\n    async mountAllViewsBottomUp(renderTimes) {\n        // logger.log(` View.mountAllViewsBottomUp: Starting bottom-up mounting for renderTimes=${renderTimes}`);\n\n        // Check if queue exists and has views\n        if (!this.VIEW_MOUNTED_QUEUE[renderTimes] || !this.VIEW_MOUNTED_QUEUE[renderTimes].length) {\n            logger.warn(` View.mountAllViewsBottomUp: No views in queue for renderTimes=${renderTimes}`);\n            return;\n        }\n\n        // Wait for super view to be ready\n        if (!this.CURRENT_SUPER_VIEW_MOUNTED) {\n            logger.log(` View.mountAllViewsBottomUp: Waiting for super view to be mounted...`);\n            await new Promise(resolve => {\n                const checkInterval = setInterval(() => {\n                    if (this.CURRENT_SUPER_VIEW_MOUNTED) {\n                        clearInterval(checkInterval);\n                        resolve();\n                    }\n                }, 50); // Check every 50ms (faster than 100ms)\n            });\n        }\n\n        // Get queue for this render\n        const queue = this.VIEW_MOUNTED_QUEUE[renderTimes];\n        logger.log(` View.mountAllViewsBottomUp: Processing ${queue.length} views`);\n\n        // Mount in reverse order (bottom-up: last  first)\n        // This ensures deepest layouts mount first, then parent views\n        for (let i = queue.length - 1; i >= 0; i--) {\n            const viewEngine = queue[i];\n\n            try {\n                // logger.log(` View.mountAllViewsBottomUp: Mounting view ${i + 1}/${queue.length} - ${viewEngine.path} (${viewEngine.id})`);\n\n                // Call beforeMount lifecycle\n                if (typeof viewEngine.beforeMount === 'function') {\n                    viewEngine.beforeMount();\n                }\n\n                // Call mounted lifecycle\n                if (typeof viewEngine.mounted === 'function') {\n                    viewEngine.mounted();\n                }\n\n                logger.log(` View.mountAllViewsBottomUp: Successfully mounted ${viewEngine.path}`);\n            } catch (error) {\n                logger.error(` View.mountAllViewsBottomUp: Error mounting ${viewEngine.path}:`, error);\n                // Continue mounting other views even if one fails\n            }\n        }\n\n        // Clear the queue after mounting all views\n        this.VIEW_MOUNTED_QUEUE[renderTimes] = [];\n        // logger.log(` View.mountAllViewsBottomUp: All views mounted successfully, queue cleared`);\n    }\n\n    /**\n     * Mount all views using stack-based order\n     * Uses ALL_VIEW_STACK which is built during scanView\n     * Order: super views first (bottom), then included views, then page view (top)\n     *\n     * @param {number} renderTimes - S ln render hin ti\n     * @returns {Promise<void>}\n     */\n    async mountAllViewsFromStack(renderTimes) {\n        // logger.log(` View.mountAllViewsFromStack: Starting stack-based mounting`);\n\n        // Check if we have views in queue\n        if (!this.VIEW_MOUNTED_QUEUE[renderTimes] || !this.VIEW_MOUNTED_QUEUE[renderTimes].length) {\n            logger.warn(` View.mountAllViewsFromStack: No views in queue`);\n            return;\n        }\n\n        // Wait for super view to be ready\n        if (!this.CURRENT_SUPER_VIEW_MOUNTED) {\n            logger.log(` View.mountAllViewsFromStack: Waiting for super view...`);\n            await new Promise(resolve => {\n                const checkInterval = setInterval(() => {\n                    if (this.CURRENT_SUPER_VIEW_MOUNTED) {\n                        clearInterval(checkInterval);\n                        resolve();\n                    }\n                }, 50);\n            });\n        }\n\n        // If we have a stack (from scanView), use it for ordering\n        if (this.ALL_VIEW_STACK && this.ALL_VIEW_STACK.length > 0) {\n            // logger.log(` View.mountAllViewsFromStack: Using ALL_VIEW_STACK (${this.ALL_VIEW_STACK.length} views)`);\n\n            // Mount super views first (they're at the beginning of stack)\n            const superViews = this.SUPER_VIEW_STACK || [];\n            for (let i = superViews.length - 1; i >= 0; i--) {\n                const viewEngine = superViews[i];\n                try {\n                    // logger.log(` View.mountAllViewsFromStack: Mounting super view ${viewEngine.path}`);\n                    if (typeof viewEngine.beforeMount === 'function') {\n                        viewEngine.beforeMount();\n                    }\n                    if (typeof viewEngine.mounted === 'function') {\n                        viewEngine.mounted();\n                    }\n                    // logger.log(` Mounted super view: ${viewEngine.path}`);\n                } catch (error) {\n                    logger.error(` Error mounting super view ${viewEngine.path}:`, error);\n                }\n            }\n\n            // Then mount page view and its includes (from ALL_VIEW_STACK)\n            for (let i = this.ALL_VIEW_STACK.length - 1; i >= 0; i--) {\n                const viewEngine = this.ALL_VIEW_STACK[i];\n\n                // Skip if already mounted as super view\n                if (superViews.includes(viewEngine)) {\n                    continue;\n                }\n\n                try {\n                    // logger.log(` View.mountAllViewsFromStack: Mounting view ${viewEngine.path}`);\n                    if (typeof viewEngine.beforeMount === 'function') {\n                        viewEngine.beforeMount();\n                    }\n                    if (typeof viewEngine.mounted === 'function') {\n                        viewEngine.mounted();\n                    }\n                    // logger.log(` Mounted view: ${viewEngine.path}`);\n                } catch (error) {\n                    logger.error(` Error mounting view ${viewEngine.path}:`, error);\n                }\n            }\n\n            // Clear stacks\n            this.ALL_VIEW_STACK = [];\n            this.SUPER_VIEW_STACK = [];\n            // logger.log(` View.mountAllViewsFromStack: Stack-based mounting complete`);\n        } else {\n            // Fallback to bottom-up queue mounting\n            // logger.log(` View.mountAllViewsFromStack: No stack available, falling back to queue mounting`);\n            await this.mountAllViewsBottomUp(renderTimes);\n        }\n\n        // Clear the queue\n        this.VIEW_MOUNTED_QUEUE[renderTimes] = [];\n    }\n\n    // ============================================================================\n    // VIEW FUNCTIONS\n    // ============================================================================\n\n    templateToDom(template) {\n        /**\n         * @type {HTMLTemplateElement}\n         */\n        const templator = document.createElement('template');\n        templator.innerHTML = template;\n        return templator.content.firstChild;\n    }\n\n\n\n    /**\n     * Include a view\n     * @param {string} viewName - Name of the view to include\n     * @param {Object} data - Data to pass to the view\n     * @returns {string} Rendered view content\n     */\n    include(viewName, data = {}) {\n        try {\n            const view = this.view(viewName, { ...data }, false);\n            return view;\n        } catch (error) {\n            console.error(`App.View.include error for '${viewName}':`, error);\n            return '';\n        }\n    }\n\n    /**\n     * Include a view if it exists\n     * @param {string} viewName - Name of the view to include\n     * @param {Object} data - Data to pass to the view\n     * @returns {string} Rendered view content or empty string\n     */\n    includeIf(viewName, data = {}) {\n        try {\n            return this.exists(viewName) ? this.include(viewName, data) : null;\n        } catch (error) {\n            console.error(`App.View.includeIf error for '${viewName}':`, error);\n            return null;\n        }\n    }\n\n    /**\n     * Extend a view (for @extends directive)\n     * @param {string} superViewName - Name of the parent view\n     * @param {Object} data - Data to pass to the parent view\n     * @returns {App.View.Engine} View Engine\n     */\n    extendView(superViewName, data = {}) {\n        try {\n            const view = this.view(superViewName, hasData(data) ? data : null, true);\n            if (!view) {\n                // console.warn(`App.View.extendView: Parent view '${superViewName}' not found`);\n                return null;\n            }\n            this.cachedViews[superViewName] = view;\n            return this.cachedViews[superViewName];\n\n        } catch (error) {\n            // console.error(`App.View.extendView error for '${superViewName}':`, error);\n            return null;\n        }\n    }\n\n\n    registerSubscribe(attr, yieldKey, defaultContent = '') {\n        let output = '';\n        const subscribeAttr = [];\n        if (typeof attr === 'string') {\n            output += ` ${attr}=\"${this.yieldContent(yieldKey, defaultContent)}\"`;\n            subscribeAttr.push(`${attr}:${yieldKey}`);\n        }\n        else if (typeof attr === 'object') {\n            const keys = Object.keys(attr);\n            for (const key of keys) {\n                if (key.toLowerCase() === '#content') {\n                    output += ` ${ATTR.KEYS.YIELD_CONTENT}=\"${attr[key]}\"`;\n                }\n                else if (key.toLowerCase() === '#children') {\n                    output += ` ${ATTR.KEYS.YIELD_CHILDREN}=\"${attr[key]}\"`;\n                }\n                else {\n                    output += ` ${key}=\"${this.yieldContent(attr[key], defaultContent)}\"`;\n                    subscribeAttr.push(`${key}:${attr[key]}`);\n                }\n            }\n        }\n        output += ` ${ATTR.KEYS.YIELD_ATTR}=\"${subscribeAttr.join(',')}\"`;\n        return output;\n    }\n\n    exists(viewName) {\n        return this.templates && this.templates[viewName] ? true : false;\n    }\n\n    // ========================================================================\n    // RENDER/SCAN METHODS - OPTIMIZED\n    // ========================================================================\n\n    /**\n     * Unified view rendering/scanning method\n     *\n     * @param {ViewEngine} view - View engine instance\n     * @param {Object} variableData - Variable data to pass to the view\n     * @param {string} mode - Render mode: 'csr' (render) or 'ssr' (virtualRender)\n     * @returns {string|ViewEngine} Rendered content or ViewEngine for extends\n     *\n     * @description\n     * Handles both CSR (Client-Side Rendering) and SSR (Server-Side Scanning):\n     * - CSR mode: Calls render(), prerender() for actual HTML generation\n     * - SSR mode: Calls virtualRender(), virtualPrerender() for relationship setup\n     *\n     * Async Data Handling:\n     * - @await('client'): Loads data from current URL via getURIDAta()\n     * - @fetch(url, data, headers): Loads data using custom fetch config\n     *\n     * Note: virtualRender/virtualPrerender do NOT generate HTML!\n     * They only setup view hierarchy, sections, state subscriptions, and prepare for hydration.\n     */\n    renderOrScanView(view, variableData = null, mode = 'csr') {\n        let result = null;\n        const renderTimes = this.renderTimes;\n\n\n        // Determine render methods based on mode\n        // CSR: render() generates HTML\n        // SSR: virtualRender() only sets up relationships (NO HTML)\n        const renderMethod = mode === 'ssr' ? 'virtualRender' : 'render';\n        const prerenderMethod = mode === 'ssr' ? 'virtualPrerender' : 'prerender';\n\n        // ====================================================================\n        // CASE 1: No async data - simple render/scan\n        // ====================================================================\n        if (!(view.hasAwaitData || view.hasFetchData)) {\n            if (variableData) {\n                view.updateVariableData({ ...variableData });\n            }\n            result = view[renderMethod]();\n\n            return result;\n        }\n\n        // ====================================================================\n        // CASE 2: Has async data but no prerender\n        // ====================================================================\n        const isPrerender = view.hasPrerender;\n        if (!isPrerender) {\n            if (variableData) {\n                view.updateVariableData(variableData);\n            }\n            result = view[renderMethod]();\n        }\n\n        // ====================================================================\n        // CASE 3A: Has @await - Load data by current URL\n        // ====================================================================\n        if (view.hasAwaitData) {\n            // First: Show prerender (loading state)\n            if (isPrerender) {\n                result = view[prerenderMethod]();\n            }\n\n            // Handle based on mode\n            if (mode === 'csr') {\n                // CSR: Load data from current URL then re-render\n                this.App.API.getURIDAta().then(data => {\n\n                    view.updateVariableData(data);\n                    // Re-render with loaded data\n                    view[renderMethod]();\n\n                });\n            } else {\n                // SSR: Just setup relationships (no data loading needed)\n                result = view[renderMethod]();\n\n                if (addToQueue) {\n                    this.callViewEngineMounted(renderTimes, view.id);\n                }\n            }\n        }\n\n        // ====================================================================\n        // CASE 3B: Has @fetch - Load data by fetch config\n        // ====================================================================\n        else if (view.hasFetchData) {\n            // First: Show prerender (loading state)\n            if (isPrerender) {\n                result = view[prerenderMethod]();\n            }\n\n            // Handle based on mode\n            if (mode === 'csr') {\n                // CSR: Fetch data using config (url, method, data, headers)\n                const fetchConfig = view.fetch || {};\n                // TODO: Implement fetch logic with config\n                // this.App.API.fetch(fetchConfig).then(data => {\n                //     view[renderMethod]();\n                //     if (addToQueue) {\n                //         this.callViewEngineMounted(renderTimes, view.id);\n                //     }\n                // });\n\n                // Temporary: Use same as await until fetch is implemented\n                this.App.API.getURIDAta().then(data => {\n                    view.updateVariableData(data);\n                    view[renderMethod]();\n                    if (addToQueue) {\n                        this.callViewEngineMounted(renderTimes, view.id);\n                    }\n                });\n            } else {\n                // SSR: Just setup relationships (no data loading needed)\n                result = view[renderMethod]();\n\n                if (addToQueue) {\n                    this.callViewEngineMounted(renderTimes, view.id);\n                }\n            }\n        }\n\n        return result;\n    }\n\n    /**\n     * Render a view (CSR - Client-Side Rendering)\n     *\n     * Generates actual HTML content by calling:\n     * - view.render() - Returns HTML string\n     * - view.prerender() - Returns loading state HTML\n     *\n     * @param {ViewEngine} view - View engine\n     * @param {Object} variableData - Variable data to pass to the view\n     * @returns {string} Rendered HTML content\n     */\n    renderView(view, variableData = null) {\n        return this.renderOrScanView(view, variableData, 'csr');\n    }\n\n    /**\n     * Scan rendered view (SSR - Server-Side Scanning)\n     *\n     * DOES NOT generate HTML - only sets up relationships by calling:\n     * - view.virtualRender() - Setup hierarchy, sections, state (NO HTML)\n     * - view.virtualPrerender() - Setup loading relationships (NO HTML)\n     *\n     * Purpose of virtual methods:\n     * 1. Setup view hierarchy (extends/includes)\n     * 2. Register sections with parent views\n     * 3. Setup state subscriptions for reactive blocks\n     * 4. Prepare view instances for DOM hydration\n     * 5. Map server data to client view structure\n     *\n     * @param {ViewEngine} view - View engine\n     * @param {Object} variableData - Variable data to pass to the view\n     * @returns {ViewEngine} ViewEngine instance for extends chain\n     */\n    scanRenderedView(view, variableData = null) {\n        return this.renderOrScanView(view, variableData, 'ssr');\n    }\n\n    /**\n     * Render a view by name\n     * @param {string} name - View name\n     * @param {Object} data - Data to pass to view\n     * @param {string} scope - View scope\n     * @returns {ViewEngine|null} Rendered view content\n     */\n    view(name, data = null, cache = false) {\n        try {\n            // check if view is cached\n            if (cache && this.cachedViews[name]) {\n                const view = this.cachedViews[name];\n                view.reset();\n                if (data) {\n                    view.updateVariableData({ ...data });\n                }\n                return view;\n            }\n            // check if view is valid\n            if (!this.templates[name]) {\n                console.warn(`App.View.view: View '${name}' not found in scope '${scope}'`);\n                return null;\n            }\n            // check if view is valid\n            if (typeof this.templates[name] !== 'function') {\n                console.warn(`App.View.view: View '${name}' render function is not valid`);\n                return null;\n            }\n\n            // get view wrapper\n            const viewWrapper = this.templates[name];\n            // create view\n            const view = viewWrapper(data ? { ...data } : {}, { App: this.App, View: this });\n            // view.updateVariableData(data);\n            // check if view is valid\n            if (!view) {\n                console.error(`App.View.view: View config not found for '${name}' in scope '${scope}'`);\n                return null;\n            }\n\n            view.setApp(this.App);\n            // cache view\n            this.cachedViews[name] = view;\n            return view;\n\n        } catch (error) {\n            console.error(`App.View.view: Critical error loading view '${name}':`, error);\n            return null;\n        }\n    };\n\n\n    /**\n     * Clear old rendering data and cleanup memory\n     * Called before each new render to prevent memory leaks\n     *\n     * Cleanup tasks:\n     * 1. Remove old views from previous render cycles\n     * 2. Clear event listeners from unmounted views\n     * 3. Cleanup old render queues (keep only last 3 cycles)\n     * 4. Trim view cache if too large (LRU eviction)\n     */\n    clearOldRendering() {\n        const currentRenderTime = this.renderTimes;\n\n        // ================================================================\n        // 1. Cleanup old render queues (keep only last 3 cycles)\n        // ================================================================\n        if (currentRenderTime > 3) {\n            const oldRenderTime = currentRenderTime - 3;\n            if (this.VIEW_MOUNTED_QUEUE[oldRenderTime]) {\n                // logger.log(` View.clearOldRendering: Cleaning queue for renderTime=${oldRenderTime}`);\n\n                // Unmount views from old queue\n                const oldViews = this.VIEW_MOUNTED_QUEUE[oldRenderTime];\n                if (Array.isArray(oldViews)) {\n                    oldViews.forEach(view => {\n                        if (view && typeof view === 'object') {\n                            this.unmountView(view);\n                        }\n                    });\n                }\n\n                // Delete old queue\n                delete this.VIEW_MOUNTED_QUEUE[oldRenderTime];\n            }\n        }\n\n        // ================================================================\n        // 2. Trim view cache if too large (LRU: max 50 views)\n        // ================================================================\n        const MAX_CACHED_VIEWS = 50;\n        const cachedKeys = Object.keys(this.cachedViews);\n        if (cachedKeys.length > MAX_CACHED_VIEWS) {\n            // logger.log(` View.clearOldRendering: Cache too large (${cachedKeys.length}), trimming to ${MAX_CACHED_VIEWS}`);\n\n            // Remove oldest views (simple strategy: remove first N)\n            const toRemove = cachedKeys.slice(0, cachedKeys.length - MAX_CACHED_VIEWS);\n            toRemove.forEach(key => {\n                const view = this.cachedViews[key];\n                if (view) {\n                    this.unmountView(view);\n                }\n                delete this.cachedViews[key];\n            });\n        }\n        this.ALL_VIEW_STACK = [];\n        this.SUPER_VIEW_STACK = [];\n        this.PAGE_VIEW = null;\n\n        // ================================================================\n        // 3. Clear orphaned event data to prevent memory leaks\n        // ================================================================\n        this.clearOrphanedEventData();\n    }\n\n\n\n    /**\n     * Unmount a view and cleanup its resources\n     *\n     * @param {ViewEngine} view - View to unmount\n     * @returns {boolean} Success status\n     *\n     * @description\n     * Properly cleanup a view by:\n     * 1. Call beforeUnmount() lifecycle hook\n     * 2. Remove event listeners via removeEvents()\n     * 3. Remove from viewMap\n     * 4. Call unmounted() lifecycle hook\n     * 5. Call destroy() if defined\n     */\n    unmountView(view) {\n        if (!view || typeof view !== 'object') {\n            logger.warn(' View.unmountView: Invalid view object');\n            return false;\n        }\n\n        try {\n            logger.log(` View.unmountView: Unmounting view ${view.id} (${view.path})`);\n\n            // Step 1: Call beforeUnmount lifecycle\n            if (typeof view.beforeUnmount === 'function') {\n                view.beforeUnmount();\n            }\n\n            // Step 2: Remove event listeners\n            if (typeof view.removeEvents === 'function') {\n                view.removeEvents();\n            }\n\n            // Step 3: Remove from viewMap\n            if (this.viewMap.has(view.id)) {\n                this.viewMap.delete(view.id);\n            }\n\n            // Step 4: Call unmounted lifecycle\n            if (typeof view.unmounted === 'function') {\n                view.unmounted();\n            }\n\n            // Step 5: Call destroy if defined\n            if (typeof view.destroy === 'function') {\n                view.destroy();\n            }\n\n            logger.log(` View.unmountView: View ${view.id} unmounted successfully`);\n            return true;\n\n        } catch (error) {\n            logger.error(` View.unmountView: Error unmounting view ${view.id}:`, error);\n            return false;\n        }\n    }\n\n    /**\n     * Reset view state\n     * Clears view stacks but does NOT unmount views\n     * Use clearOldRendering() for proper cleanup\n     */\n    resetView() {\n        logger.log(' View.resetView: Resetting view stacks');\n        this.SUPER_VIEW_STACK = [];\n        this.ALL_VIEW_STACK = [];\n        this.PAGE_VIEW = null;\n\n    }\n\n    /**\n     * Clear orphaned event data from all views\n     * Call this when DOM changes significantly to prevent memory leaks\n     */\n    clearOrphanedEventData() {\n        logger.log(' View.clearOrphanedEventData: Cleaning up orphaned event handlers');\n\n        // Clear from all cached views\n        Object.values(this.cachedViews).forEach(view => {\n            if (view && typeof view.clearOrphanedEventData === 'function') {\n                view.clearOrphanedEventData();\n            }\n        });\n\n        // Clear from current views in stacks\n        [...this.ALL_VIEW_STACK, ...this.SUPER_VIEW_STACK].forEach(view => {\n            if (view && typeof view.clearOrphanedEventData === 'function') {\n                view.clearOrphanedEventData();\n            }\n        });\n\n        // Clear from current view\n        if (this.CURRENT_VIEW && typeof this.CURRENT_VIEW.clearOrphanedEventData === 'function') {\n            this.CURRENT_VIEW.clearOrphanedEventData();\n        }\n\n        if (this.CURRENT_SUPER_VIEW && typeof this.CURRENT_SUPER_VIEW.clearOrphanedEventData === 'function') {\n            this.CURRENT_SUPER_VIEW.clearOrphanedEventData();\n        }\n    }\n\n\n    // ============================================================================\n    // SECTION FUNCTIONS\n    // ============================================================================\n\n\n    /**\n     * Define a section\n     * @param {string} name - Section name\n     * @param {string} content - Section content\n     * @param {string} type - Section type\n     */\n    section(name, content, type = 'string') {\n        let oldContent = this._sections[name];\n        this._sections[name] = content;\n        if (oldContent !== content) {\n            this._changedSections.push(name);\n        }\n    };\n\n    /**\n     * Yield a section content\n     * @param {string} name - Section name\n     * @param {string} defaultContent - Default content if section not found\n     * @returns {string} Section content\n     */\n    yield(name, defaultContent = '') {\n        return this._sections[name] || defaultContent;\n    }\n    yieldContent(name, defaultContent = '') {\n        return this._sections[name] || defaultContent;\n    }\n\n\n    /**\n     * Render all sections as HTML\n     * @returns {string} Rendered sections HTML\n     */\n    renderSections() {\n        let html = '';\n        for (const [name, content] of Object.entries(this._sections)) {\n            html += content;\n        }\n        return html;\n    }\n\n    /**\n     * Check if section exists\n     * @param {string} name - Section name\n     * @returns {boolean} True if section exists\n     */\n    hasSection(name) {\n        return name in this._sections;\n    }\n\n    /**\n     * Get changed sections\n     * @returns {string[]} Changed sections\n     */\n    getChangedSections() {\n        return this._changedSections;\n    };\n\n    /**\n     * Reset changed sections list\n     */\n    resetChangedSections() {\n        this._changedSections = [];\n    };\n\n    /**\n     * Check if section has changed\n     * @param {string} name - Section name\n     * @returns {boolean} True if section has changed\n     */\n    isChangedSection(name) {\n        return this._changedSections.includes(name);\n    };\n\n\n    /**\n     * Emit changed sections to subscribed elements\n     */\n    emitChangedSections() {\n        this._changedSections.forEach(name => {\n            if (this.SEO.updateItem(name, this._sections[name])) {\n                return;\n            }\n            // Escape special characters in CSS selector\n            const escapedName = name.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n\n            // Find elements subscribed to this section\n            const subscribedElements = document.querySelectorAll(`[data-yield-subscribe-key*=\"${escapedName}\"]`);\n\n            subscribedElements.forEach(element => {\n                const subscribeKey = element.getAttribute('data-yield-subscribe-key');\n                const subscribeTarget = element.getAttribute('data-yield-subscribe-target');\n                const subscribeAttr = element.getAttribute('data-yield-subscribe-attr');\n\n                if (subscribeKey && subscribeKey.includes(name)) {\n                    const sectionContent = this._sections[name] || '';\n\n                    if (subscribeTarget === 'content' || subscribeTarget === 'children') {\n                        element.innerHTML = sectionContent;\n                    } else if (subscribeTarget === 'attr' || subscribeTarget === 'attribute') {\n                        if (subscribeAttr) {\n                            element.setAttribute(subscribeAttr, sectionContent);\n                        }\n                    } else {\n                        element.innerHTML = sectionContent;\n                    }\n                }\n            });\n\n            // Find elements with spa-yield-attr containing section name\n            const attrElements = document.querySelectorAll('[data-yield-attr]');\n            attrElements.forEach(element => {\n                const yieldAttr = element.getAttribute('data-yield-attr');\n\n                if (yieldAttr && yieldAttr.includes(name)) {\n                    const attrPairs = yieldAttr.split(',');\n\n                    attrPairs.forEach(pair => {\n                        let paths = pair.split(':');\n                        let attrName = paths.shift();\n                        let sectionName = paths.join(':');\n\n                        if (sectionName && sectionName.trim() === name) {\n                            const sectionContent = this._sections[name] || '';\n                            element.setAttribute(attrName.trim(), sectionContent);\n                        }\n                    });\n                }\n            });\n\n            // Find elements with app-yield-{name} attributes\n            if (name.split(':').length <= 1) {\n                const specialElements = document.querySelectorAll(`[data-yield-${escapedName}]`);\n                specialElements.forEach(element => {\n                    const sectionContent = this._sections[name] || '';\n                    element.innerHTML = sectionContent;\n                });\n\n            }\n\n            const contentElements = document.querySelectorAll(`[data-yield-content=\"${escapedName}\"]`);\n            contentElements.forEach(element => {\n                element.innerHTML = this._sections[name] || '';\n            });\n            const childrenElements = document.querySelectorAll(`[data-yield-children=\"${escapedName}\"]`);\n            childrenElements.forEach(element => {\n                element.innerHTML = this._sections[name] || '';\n            });\n        });\n\n        // Reset changed sections after processing\n        this.resetChangedSections();\n    };\n\n\n    loadServerData(data = {}) {\n\n    }\n\n\n\n    // ============================================================================\n    // STACK FUNCTIONS\n    // ============================================================================\n\n    // Initialize stacks storage\n\n\n    /**\n     * Push content to a stack\n     * @param {string} name - Stack name\n     * @param {string} content - Content to push\n     */\n    push(name, content) {\n        if (!this._stacks[name]) {\n            this._stacks[name] = [];\n        }\n        this._stacks[name].push(content);\n    };\n\n    /**\n     * Get stack content\n     * @param {string} name - Stack name\n     * @returns {string} Stack content\n     */\n    stack(name) {\n        return this._stacks[name] ? this._stacks[name].join('') : '';\n    };\n\n    // ============================================================================\n    // ONCE FUNCTIONS\n    // ============================================================================\n\n    // Initialize once storage\n\n    /**\n     * Execute content only once\n     * @param {string} content - Content to execute once\n     * @returns {string} Content if not executed before, empty string otherwise\n     */\n    once(content) {\n        const hash = this._hashContent(content);\n        if (!this._once[hash]) {\n            this._once[hash] = true;\n            return content;\n        }\n        return '';\n    };\n\n    /**\n     * Hash content for once tracking\n     * @param {string} content - Content to hash\n     * @returns {string} Hash string\n     */\n    _hashContent(content) {\n        let hash = 0;\n        if (content.length === 0) return hash.toString();\n\n        for (let i = 0; i < content.length; i++) {\n            const char = content.charCodeAt(i);\n            hash = ((hash << 5) - hash) + char;\n            hash = hash & hash; // Convert to 32-bit integer\n        }\n\n        return hash.toString();\n    };\n\n    // ============================================================================\n    // AUTH FUNCTIONS\n    // ============================================================================\n\n    /**\n     * Check if user is authenticated\n     * @param {string} guard - Guard name (optional)\n     * @returns {boolean} True if authenticated\n     */\n    isAuth(guard = null) {\n        // This should be implemented based on your auth system\n        // For now, return false as placeholder\n        return false;\n    };\n\n    /**\n     * Check if user has permission\n     * @param {string} permission - Permission name\n     * @param {*} model - Model instance (optional)\n     * @returns {boolean} True if user has permission\n     */\n    can(permission, model = null) {\n        // This should be implemented based on your permission system\n        // For now, return false as placeholder\n        return false;\n    };\n\n    // ============================================================================\n    // ERROR FUNCTIONS\n    // ============================================================================\n\n    /**\n     * Check if field has error\n     * @param {string} field - Field name\n     * @returns {boolean} True if field has error\n     */\n    hasError(field) {\n        // This should be implemented based on your error handling system\n        // For now, return false as placeholder\n        return false;\n    };\n\n    /**\n     * Get first error for field\n     * @param {string} field - Field name\n     * @returns {string} Error message\n     */\n    firstError(field) {\n        // This should be implemented based on your error handling system\n        // For now, return empty string as placeholder\n        return '';\n    };\n\n    // ============================================================================\n    // CSRF FUNCTIONS\n    // ============================================================================\n\n    /**\n     * Get CSRF token\n     * @returns {string} CSRF token\n     */\n    csrfToken() {\n        // This should be implemented based on your CSRF system\n        // For now, return empty string as placeholder\n        return '';\n    };\n\n    // ============================================================================\n    // LOOP FUNCTIONS\n    // ============================================================================\n\n    /**\n     * Foreach loop helper\n     * @param {Array|Object} items - Items to iterate\n     * @param {Function} callback - Callback function\n     * @returns {string} Rendered content\n     */\n    foreach(items, callback) {\n        if (!items) return '';\n\n        let result = '';\n\n        if (Array.isArray(items)) {\n            items.forEach((item, index) => {\n                result += callback(item, index);\n            });\n        } else if (typeof items === 'object') {\n            Object.entries(items).forEach(([key, value]) => {\n                result += callback(value, key);\n            });\n        }\n\n        return result;\n    };\n\n\n    /**\n  * Get route URL\n  * @param {string} name - Route name\n  * @param {object} params - Route parameters\n  * @returns {string} Route URL\n  */\n    route(name, params = {}) {\n        return this.App.Router.getURL(name, params);\n    }\n\n}\n","/**\n * ViewHelper - Utility functions for view operations\n * Contains helper methods that are not directly related to view management\n */\n\nimport { uniqId } from '../helpers/utils.js';\n\nexport class Helper {\n    constructor(App = null) {\n        this.App = App;\n    }\n\n    setApp(App) {\n        this.App = App;\n    }\n\n    /**\n     * Trim string\n     * @param {string} str - String to trim\n     * @param {string} char - Character to trim\n     * @returns {string} Trimmed string\n     */\n    trim(str, char = ' ') {\n        if (typeof str !== 'string') return str;\n        const regex = new RegExp(`^${char}+|${char}+$`, 'g');\n        return str.replace(regex, '');\n    }\n\n    /**\n     * Check if string is HTML\n     * @param {string} str - String to check\n     * @returns {boolean} True if HTML\n     */\n    isHtmlString(str) {\n        if (typeof str !== 'string') return false;\n        return /<[a-z][\\s\\S]*>/i.test(str);\n    }\n\n    substr(str, start, length) {\n        if (typeof str !== 'string') return str;\n        return str.substring(start, length);\n    }\n\n    strtolower(str) {\n        if (typeof str !== 'string') return str;\n        return str.toLowerCase();\n    }\n\n    strtoupper(str) {\n        if (typeof str !== 'string') return str;\n        return str.toUpperCase();\n    }\n\n\n    /**\n     * Format date\n     * @param {Date|string} date - Date to format\n     * @param {string} format - Format string\n     * @returns {string} Formatted date\n     */\n    formatDate(date, format = 'YYYY-MM-DD') {\n        const d = new Date(date);\n        if (isNaN(d.getTime())) return '';\n\n        const year = d.getFullYear();\n        const month = String(d.getMonth() + 1).padStart(2, '0');\n        const day = String(d.getDate()).padStart(2, '0');\n        const hours = String(d.getHours()).padStart(2, '0');\n        const minutes = String(d.getMinutes()).padStart(2, '0');\n        const seconds = String(d.getSeconds()).padStart(2, '0');\n\n        return format\n            .replace('YYYY', year)\n            .replace('MM', month)\n            .replace('DD', day)\n            .replace('HH', hours)\n            .replace('mm', minutes)\n            .replace('ss', seconds);\n    }\n\n    /**\n     * Format number\n     * @param {number} num - Number to format\n     * @param {Object} options - Formatting options\n     * @returns {string} Formatted number\n     */\n    formatNumber(num, options = {}) {\n        if (typeof num !== 'number' || isNaN(num)) return '0';\n\n        const {\n            decimals = 2,\n            thousandsSeparator = ',',\n            decimalSeparator = '.',\n            prefix = '',\n            suffix = ''\n        } = options;\n\n        const parts = num.toFixed(decimals).split('.');\n        parts[0] = parts[0].replace(/\\B(?=(\\d{3})+(?!\\d))/g, thousandsSeparator);\n\n        return prefix + parts.join(decimalSeparator) + suffix;\n    }\n\n    /**\n     * Format currency\n     * @param {number} amount - Amount to format\n     * @param {string} currency - Currency code\n     * @returns {string} Formatted currency\n     */\n    formatCurrency(amount, currency = 'USD') {\n        const currencySymbols = {\n            'USD': '$',\n            'EUR': '',\n            'GBP': '',\n            'JPY': '',\n            'VND': ''\n        };\n\n        const symbol = currencySymbols[currency] || currency;\n        return symbol + this.formatNumber(amount, { decimals: 2 });\n    }\n\n    /**\n     * Truncate text\n     * @param {string} text - Text to truncate\n     * @param {number} length - Maximum length\n     * @param {string} suffix - Suffix to add\n     * @returns {string} Truncated text\n     */\n    truncate(text, length = 100, suffix = '...') {\n        if (typeof text !== 'string' || text.length <= length) {\n            return text;\n        }\n        return text.substring(0, length).trim() + suffix;\n    }\n\n    /**\n     * Generate random string\n     * @param {number} length - Length of string\n     * @returns {string} Random string\n     */\n    randomString(length = 8) {\n        const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n        let result = '';\n        for (let i = 0; i < length; i++) {\n            result += chars.charAt(Math.floor(Math.random() * chars.length));\n        }\n        return result;\n    }\n\n    /**\n     * Deep clone object\n     * @param {*} obj - Object to clone\n     * @returns {*} Cloned object\n     */\n    deepClone(obj) {\n        if (obj === null || typeof obj !== 'object') return obj;\n        if (obj instanceof Date) return new Date(obj.getTime());\n        if (obj instanceof Array) return obj.map(item => this.deepClone(item));\n        if (typeof obj === 'object') {\n            const cloned = {};\n            Object.keys(obj).forEach(key => {\n                cloned[key] = this.deepClone(obj[key]);\n            });\n            return cloned;\n        }\n        return obj;\n    }\n\n    /**\n     * Debounce function\n     * @param {Function} func - Function to debounce\n     * @param {number} wait - Wait time in ms\n     * @returns {Function} Debounced function\n     */\n    debounce(func, wait) {\n        let timeout;\n        return function executedFunction(...args) {\n            const later = () => {\n                clearTimeout(timeout);\n                func(...args);\n            };\n            clearTimeout(timeout);\n            timeout = setTimeout(later, wait);\n        };\n    }\n\n    /**\n     * Throttle function\n     * @param {Function} func - Function to throttle\n     * @param {number} limit - Limit time in ms\n     * @returns {Function} Throttled function\n     */\n    throttle(func, limit) {\n        let inThrottle;\n        return function executedFunction(...args) {\n            if (!inThrottle) {\n                func.apply(this, args);\n                inThrottle = true;\n                setTimeout(() => inThrottle = false, limit);\n            }\n        };\n    }\n\n    /**\n     * Get SEO tag configuration\n     * @returns {Object} SEO tag configuration\n     */\n    getSEOTagConfig() {\n        return {\n            title: [\n                {\n                    tag: 'title',\n                    selector: 'title',\n                    attribute: '@content'\n                }\n            ],\n            description: [\n                {\n                    tag: 'meta',\n                    selector: 'meta[name=\"description\"]',\n                    attrs: { name: 'description' },\n                    attribute: 'content'\n                }\n            ],\n            keywords: [\n                {\n                    tag: 'meta',\n                    selector: 'meta[name=\"keywords\"]',\n                    attrs: { name: 'keywords' },\n                    attribute: 'content'\n                }\n            ],\n            ogTitle: [\n                {\n                    tag: 'meta',\n                    selector: 'meta[property=\"og:title\"]',\n                    attrs: { property: 'og:title' },\n                    attribute: 'content'\n                }\n            ],\n            ogDescription: [\n                {\n                    tag: 'meta',\n                    selector: 'meta[property=\"og:description\"]',\n                    attrs: { property: 'og:description' },\n                    attribute: 'content'\n                }\n            ],\n            ogImage: [\n                {\n                    tag: 'meta',\n                    selector: 'meta[property=\"og:image\"]',\n                    attrs: { property: 'og:image' },\n                    attribute: 'content'\n                }\n            ]\n        };\n    }\n\n    /**\n     * Update SEO item\n     * @param {string} key - SEO key\n     * @param {string} value - SEO value\n     * @returns {boolean} Success status\n     */\n    updateSEOItem(key, value) {\n        const items = this.SEO.tags[key];\n        if (!items || items.length === 0) return false;\n\n        items.forEach(item => {\n            let element = document.querySelector(item.selector);\n            if (!element) {\n                element = document.createElement(item.tag);\n                if (item.attrs) {\n                    Object.entries(item.attrs).forEach(([attrKey, attrValue]) => {\n                        element.setAttribute(attrKey, attrValue);\n                    });\n                }\n                document.head.appendChild(element);\n            }\n\n            if (item.attribute) {\n                if (item.attribute === '@content') {\n                    element.textContent = value;\n                } else {\n                    element.setAttribute(item.attribute, value);\n                }\n            }\n        });\n\n        return true;\n    }\n\n    /**\n     * Update page title\n     * @param {string} title - New title\n     */\n    updateTitle(title) {\n        this.updateSEOItem('title', title);\n    }\n\n    /**\n     * Update page description\n     * @param {string} description - New description\n     */\n    updateDescription(description) {\n        this.updateSEOItem('description', description);\n    }\n\n    /**\n     * Update page keywords\n     * @param {string} keywords - New keywords\n     */\n    updateKeywords(keywords) {\n        this.updateSEOItem('keywords', keywords);\n    }\n\n    /**\n     * Update Open Graph title\n     * @param {string} title - New OG title\n     */\n    updateOGTitle(title) {\n        this.updateSEOItem('ogTitle', title);\n    }\n\n    /**\n     * Update Open Graph description\n     * @param {string} description - New OG description\n     */\n    updateOGDescription(description) {\n        this.updateSEOItem('ogDescription', description);\n    }\n\n    /**\n     * Update Open Graph image\n     * @param {string} image - New OG image URL\n     */\n    updateOGImage(image) {\n        this.updateSEOItem('ogImage', image);\n    }\n\n    /**\n     * Get URL parameters\n     * @param {string} url - URL to parse\n     * @returns {Object} URL parameters\n     */\n    getUrlParams(url = window.location.href) {\n        const params = {};\n        const urlObj = new URL(url);\n        urlObj.searchParams.forEach((value, key) => {\n            params[key] = value;\n        });\n        return params;\n    }\n\n    /**\n     * Build URL with parameters\n     * @param {string} baseUrl - Base URL\n     * @param {Object} params - Parameters to add\n     * @returns {string} Built URL\n     */\n    buildUrl(baseUrl, params = {}) {\n        const url = new URL(baseUrl);\n        Object.entries(params).forEach(([key, value]) => {\n            if (value !== null && value !== undefined) {\n                url.searchParams.set(key, value);\n            }\n        });\n        return url.toString();\n    }\n\n    /**\n     * Check if element is in viewport\n     * @param {Element} element - Element to check\n     * @returns {boolean} True if in viewport\n     */\n    isInViewport(element) {\n        const rect = element.getBoundingClientRect();\n        return (\n            rect.top >= 0 &&\n            rect.left >= 0 &&\n            rect.bottom <= (window.innerHeight || document.documentElement.clientHeight) &&\n            rect.right <= (window.innerWidth || document.documentElement.clientWidth)\n        );\n    }\n\n    /**\n     * Scroll to element\n     * @param {Element|string} element - Element or selector\n     * @param {Object} options - Scroll options\n     */\n    scrollTo(element, options = {}) {\n        const target = typeof element === 'string' ? document.querySelector(element) : element;\n        if (!target) return;\n\n        const {\n            behavior = 'smooth',\n            block = 'start',\n            inline = 'nearest',\n            offset = 0\n        } = options;\n\n        const targetPosition = target.offsetTop - offset;\n        window.scrollTo({\n            top: targetPosition,\n            behavior\n        });\n    }\n\n    /**\n     * Copy text to clipboard\n     * @param {string} text - Text to copy\n     * @returns {Promise<boolean>} Success status\n     */\n    async copyToClipboard(text) {\n        try {\n            await navigator.clipboard.writeText(text);\n            return true;\n        } catch (error) {\n            console.error('Failed to copy to clipboard:', error);\n            return false;\n        }\n    }\n\n    /**\n     * Download file\n     * @param {string} content - File content\n     * @param {string} filename - Filename\n     * @param {string} mimeType - MIME type\n     */\n    downloadFile(content, filename, mimeType = 'text/plain') {\n        const blob = new Blob([content], { type: mimeType });\n        const url = URL.createObjectURL(blob);\n        const link = document.createElement('a');\n        link.href = url;\n        link.download = filename;\n        document.body.appendChild(link);\n        link.click();\n        document.body.removeChild(link);\n        URL.revokeObjectURL(url);\n    }\n\n    /**\n     * Get device type\n     * @returns {string} Device type\n     */\n    getDeviceType() {\n        const width = window.innerWidth;\n        if (width < 768) return 'mobile';\n        if (width < 1024) return 'tablet';\n        return 'desktop';\n    }\n\n    // ============================================================================\n    // ADDITIONAL UTILITY FUNCTIONS (moved from View)\n    // ============================================================================\n\n    /**\n     * Count items\n     * @param {Array|Object} items - Items to count\n     * @returns {number} Count\n     */\n    count(items) {\n        if (Array.isArray(items)) {\n            return items.length;\n        } else if (typeof items === 'object' && items !== null) {\n            return Object.keys(items).length;\n        }\n        return 0;\n    }\n\n    /**\n     * Check if value is null\n     * @param {*} value - Value to check\n     * @returns {boolean} True if null\n     */\n    isNull(value) {\n        return value === null;\n    }\n\n    /**\n     * Check if value is array\n     * @param {*} value - Value to check\n     * @returns {boolean} True if array\n     */\n    isArray(value) {\n        return Array.isArray(value);\n    }\n\n    /**\n     * Check if value is string\n     * @param {*} value - Value to check\n     * @returns {boolean} True if string\n     */\n    isString(value) {\n        return typeof value === 'string';\n    }\n\n    /**\n     * Check if value is numeric\n     * @param {*} value - Value to check\n     * @returns {boolean} True if numeric\n     */\n    isNumeric(value) {\n        return !isNaN(parseFloat(value)) && isFinite(value);\n    }\n\n    /**\n     * Get current timestamp with format method\n     * @returns {Object} Current timestamp with format method\n     */\n    now() {\n        const now = new Date();\n        return {\n            format: function (format) {\n                if (!format) return now.toISOString();\n\n                // Simple format implementation\n                const year = now.getFullYear();\n                const month = String(now.getMonth() + 1).padStart(2, '0');\n                const day = String(now.getDate()).padStart(2, '0');\n                const hours = String(now.getHours()).padStart(2, '0');\n                const minutes = String(now.getMinutes()).padStart(2, '0');\n                const seconds = String(now.getSeconds()).padStart(2, '0');\n\n                return format\n                    .replace('Y', year)\n                    .replace('m', month)\n                    .replace('d', day)\n                    .replace('H', hours)\n                    .replace('i', minutes)\n                    .replace('s', seconds);\n            },\n            getTime: function () {\n                return now.getTime();\n            },\n            toString: function () {\n                return now.toString();\n            }\n        };\n    }\n\n    /**\n     * Get current date\n     * @returns {Date} Current date\n     */\n    today() {\n        return new Date();\n    }\n\n    /**\n     * Simple date formatting\n     * @param {Date|string} date - Date to format\n     * @param {string} format - Format string\n     * @returns {string} Formatted date\n     */\n    date(date, format = 'Y-m-d H:i:s') {\n        const d = new Date(date);\n        // Simple date formatting - can be enhanced\n        return d.toISOString().slice(0, 19).replace('T', ' ');\n    }\n\n\n    /**\n     * Get environment value\n     * @param {string} key - Environment key\n     * @param {*} defaultValue - Default value\n     * @returns {*} Environment value\n     */\n    env(key, defaultValue = null) {\n        // This should be implemented based on your environment system\n        // For now, return default value as placeholder\n        return defaultValue;\n    }\n\n    // ============================================================================\n    // PHP-LIKE FUNCTIONS (for Blade compatibility)\n    // ============================================================================\n\n    /**\n     * Hm tng t nh PHP: ucfirst\n     * Vit hoa k t u tin ca chui\n     * @param {string} str\n     * @returns {string}\n     */\n    ucfirst(str) {\n        if (typeof str !== 'string' || str.length === 0) return str;\n        return str.charAt(0).toUpperCase() + str.slice(1);\n    }\n\n    /**\n     * Hm tng t nh PHP: lcfirst\n     * Vit thng k t u tin ca chui\n     * @param {string} str\n     * @returns {string}\n     */\n    lcfirst(str) {\n        if (typeof str !== 'string' || str.length === 0) return str;\n        return str.charAt(0).toLowerCase() + str.slice(1);\n    }\n\n    /**\n     * Hm tng t nh PHP: str_replace\n     * Thay th tt c cc chui con trong chui\n     * @param {string|string[]} search\n     * @param {string|string[]} replace\n     * @param {string} subject\n     * @returns {string}\n     */\n    str_replace(search, replace, subject) {\n        if (Array.isArray(search)) {\n            let result = subject;\n            search.forEach((s, i) => {\n                const r = Array.isArray(replace) ? (replace[i] !== undefined ? replace[i] : '') : replace;\n                result = result.split(s).join(r);\n            });\n            return result;\n        } else {\n            return subject.split(search).join(replace);\n        }\n    }\n\n    /**\n     * Hm tng t nh PHP: explode\n     * Ct chui thnh mng theo k t phn tch\n     * @param {string} delimiter\n     * @param {string} str\n     * @returns {Array}\n     */\n    explode(delimiter, str) {\n        if (typeof str !== 'string' || typeof delimiter !== 'string') return [];\n        return str.split(delimiter);\n    }\n\n    /**\n     * Hm tng t nh PHP: implode\n     * Ni cc phn t ca mng thnh chui vi k t phn tch\n     * @param {string} glue\n     * @param {Array} pieces\n     * @returns {string}\n     */\n    implode(glue, pieces) {\n        if (!Array.isArray(pieces)) return '';\n        return pieces.join(glue);\n    }\n\n    /**\n     * Hm tng t nh PHP: in_array\n     * Kim tra gi tr c trong mng khng\n     * @param {any} needle\n     * @param {Array} haystack\n     * @returns {boolean}\n     */\n    in_array(needle, haystack) {\n        if (!Array.isArray(haystack)) return false;\n        return haystack.includes(needle);\n    }\n\n    /**\n     * Hm tng t nh PHP: array_unique\n     * Loi b cc phn t trng lp trong mng\n     * @param {Array} arr\n     * @returns {Array}\n     */\n    array_unique(arr) {\n        if (!Array.isArray(arr)) return [];\n        return Array.from(new Set(arr));\n    }\n\n    /**\n     * Hm tng t nh PHP: array_merge\n     * Gp nhiu mng thnh mt mng\n     * @param  {...Array} arrays\n     * @returns {Array}\n     */\n    array_merge(...arrays) {\n        return [].concat(...arrays);\n    }\n\n    /**\n     * Hm tng t nh PHP: is_array\n     * Kim tra bin c phi l mng khng\n     * @param {any} value\n     * @returns {boolean}\n     */\n    is_array(value) {\n        return Array.isArray(value);\n    }\n\n    /**\n     * Hm tng t nh PHP: is_string\n     * Kim tra bin c phi l chui khng\n     * @param {any} value\n     * @returns {boolean}\n     */\n    is_string(value) {\n        return typeof value === 'string';\n    }\n\n    /**\n     * Hm tng t nh PHP: is_numeric\n     * Kim tra bin c phi l s hoc chui s khng\n     * @param {any} value\n     * @returns {boolean}\n     */\n    is_numeric(value) {\n        return !isNaN(parseFloat(value)) && isFinite(value);\n    }\n\n    /**\n     * Hm tng t nh PHP: empty\n     * Kim tra bin c \"rng\" khng (null, undefined, '', 0, false, [], {})\n     * @param {any} value\n     * @returns {boolean}\n     */\n    empty(value) {\n        if (value === null || value === undefined) return true;\n        if (typeof value === 'string' && value.trim() === '') return true;\n        if (Array.isArray(value) && value.length === 0) return true;\n        if (typeof value === 'object' && !Array.isArray(value) && Object.keys(value).length === 0) return true;\n        if (value === false) return true;\n        if (value === 0) return true;\n        return false;\n    }\n\n    /**\n     * Hm tng t nh PHP: isset\n     * Kim tra bin c c nh ngha v khc null khng\n     * @param {any} value\n     * @returns {boolean}\n     */\n    isset(value) {\n        return value !== undefined && value !== null;\n    }\n\n    /**\n     * Hm tng t nh PHP: json_encode\n     * Chuyn i gi tr thnh chui JSON\n     * @param {any} value\n     * @returns {string}\n     */\n    json_encode(value) {\n        return JSON.stringify(value);\n    }\n\n    /**\n     * Hm tng t nh PHP: json_decode\n     * Chuyn i chui JSON thnh gi tr\n     * @param {string} value\n     * @returns {any}\n     */\n    json_decode(value) {\n        return JSON.parse(value);\n    }\n\n    /**\n     * Check if device is mobile\n     * @returns {boolean} True if mobile\n     */\n    isMobile() {\n        return this.getDeviceType() === 'mobile';\n    }\n\n    /**\n     * Check if device is tablet\n     * @returns {boolean} True if tablet\n     */\n    isTablet() {\n        return this.getDeviceType() === 'tablet';\n    }\n\n    /**\n     * Check if device is desktop\n     * @returns {boolean} True if desktop\n     */\n    isDesktop() {\n        return this.getDeviceType() === 'desktop';\n    }\n}\n","import { uniqId } from \"../helpers/utils.js\";\nimport OneMarkup, { OneMarkupModel } from \"./OneMarkup.js\";\nimport OneDOM from \"./OneDOM.js\";\nimport { ViewState } from \"./ViewState.js\";\n\n\nexport class FollowingBlock {\n    constructor({ App, engine, stateKeys = [], renderBlock = () => '', scanMode = false, renderID = '' }) {\n        /**\n         * @type {Application}\n         */\n        this.App = App;\n        /**\n         * @type {ViewEngine}\n         */\n        this.engine = engine;\n        /**\n         * @type {ViewState}\n         */\n        this.states = engine.states;\n        /**\n         * @type {Array}\n         */\n        this.stateKeys = stateKeys;\n        /**\n         * @type {function}\n         */\n        this.renderBlock = renderBlock;\n        /**\n         * @type {boolean}\n         */\n        this.scanMode = scanMode;\n        /**\n         * @type {string}\n         */\n        this.id = renderID || uniqId();\n        /**\n         * @type {boolean}\n         */\n        this.isRendered = false;\n\n        this.openTag = null;\n        this.closeTag = null;\n        this.refElements = [];\n        this.subscribes = [];\n        this.isMounted = false;\n        this.isScanned = false;\n        /**\n         * @type {OneMarkupModel|null}\n         */\n        this.markup = null;\n    }\n    mounted() {\n        if (this.isMounted) return;\n        this.isMounted = true;\n        this.scan();\n        if (this.stateKeys.length > 0) {\n            this.stateKeys.forEach(stateKey => {\n                const unsubscribe = this.states.__subscribe(stateKey, () => {\n                    console.log(`FollowingBlock [id=${this.id}] detected change in state \"${stateKey}\", renewing...`);\n                    this.renew();\n                });\n                this.subscribes.push(unsubscribe);\n            });\n        }\n    }\n    unmounted() {\n        this.isMounted = false;\n        if (this.subscribes.length > 0) {\n            this.subscribes.forEach(unsubscribe => {\n                unsubscribe();\n            });\n            this.subscribes = [];\n        }\n    }\n\n    placeholder() {\n        return `<!-- [one:placeholder ref=\"following\" id=\"${this.id}\"] --><!-- [/one:placeholder] -->`;\n    }\n\n    render() {\n        \n        return `<!-- [one:follow type=\"state\" id=\"${this.id}\" following=\"${this.stateKeys.join(',')}\"] viewid=\"${this.id}\" -->${this.renderBlock()}<!-- [/one:follow] -->`;\n    }\n    rerender() {\n        return this.renderBlock();\n    }\n    renew() {\n        this.engine.onFollowUpdating();\n        try {\n            this.unmounted();\n            this.clear();\n            if (this.closeTag && this.closeTag.parentNode) {\n                OneDOM.before(this.closeTag, this.rerender());\n                this.mounted();\n            }\n        } catch (e) {\n            console.error('FollowingBlock renew error:', e);\n        }\n        this.engine.onFollowUpdated();\n    }\n\n    destroy() {\n        this.unmounted();\n        this.clear();\n    }\n\n\n    scan() {\n        console.log(`FollowingBlock [id=${this.id}] scanning...`);\n        if(!this.markup){\n            this.markup = OneMarkup.first('follow', { id: this.id }, {}, false);\n            this.openTag = this.markup.openTag;\n            this.closeTag = this.markup.closeTag;\n            this.refElements = this.markup.nodes.slice();\n        }else{\n            this.refElements = [];\n            this.markup.__scan();\n            this.refElements = this.markup.nodes.slice();\n        }\n        this.isScanned = true;\n    }\n    clear() {\n        this.refElements.forEach(node => {\n            if (node.parentNode) {\n                node.parentNode.removeChild(node);\n            }\n        });\n        this.refElements = [];\n    }\n\n}","/**\n * View Engine class for managing view instances\n * @param {Object} config - View configuration\n */\nimport { __defineGetters, __defineMethods, __defineProperties, __defineProps, deleteProp, uniqId } from '../helpers/utils.js';\nimport { FollowingBlock } from './FollowingBlock.js';\nimport OneMarkup from './OneMarkup.js';\nimport { ViewState } from './ViewState.js';\nimport logger from './services/LoggerService.js';\nimport { ATTR, FORBIDDEN_KEYS } from './ViewConfig.js';\n\nexport class ViewEngine {\n    constructor(path, config) {\n\n        // Private properties using naming convention for browser compatibility\n        /**\n         * @type {Application}\n         */\n        this.App = null;\n        /**\n         * @type {boolean}\n         */\n        this.isSuperView = false;\n        /**\n         * @type {function}\n         */\n        this._emptyFn = () => { };\n        /**\n         * @type {string}\n         */\n        this.id = null;\n        /**\n         * @type {function}\n         */\n        this.init = this._emptyFn;\n        /**\n         * @type {ViewEngine}\n         */\n        this.parent = null;\n        /**\n         * @type {Array<ViewEngine>}\n         */\n        this.children = [];\n        /**\n         * @type {ViewEngine}\n         */\n        this.superView = null;\n        /**\n         * @type {string}\n         */\n        this.superViewPath = null;\n        /**\n         * @type {string}\n         */\n        this.superViewId = null;\n        /**\n         * @type {boolean}\n         */\n        this.hasSuperView = false;\n\n        /**\n         * @type {string}\n         */\n        this.originalViewPath = null;\n        /**\n         * @type {string}\n         */\n        this.originalViewId = null;\n        /**\n         * @type {ViewEngine}\n         */\n        this.originalView = null;\n        /**\n         * @type {boolean}\n         */\n        this.hasAwaitData = false;\n        /**\n         * @type {boolean}\n         */\n        this.hasFetchData = false;\n        /**\n         * @type {Object}\n         */\n        this.fetch = {};\n        /**\n         * @type {boolean}\n         */\n        this.usesVars = false;\n        /**\n         * @type {boolean}\n         */\n        this.hasSections = false;\n        /**\n         * @type {Array<string>}\n         */\n        this.renderLongSections = [];\n        /**\n         * @type {boolean}\n         */\n        this.hasSectionPreload = false;\n        /**\n         * @type {boolean}\n         */\n        this.hasPrerender = false;\n        /**\n         * @type {Object}\n         */\n        this.sections = {};\n        /**\n         * @type {function}\n         */\n        this.addCSS = this._emptyFn;\n        this.removeCSS = this._emptyFn;\n        /**\n         * @type {Array<string>}\n         */\n        this.resources = [];\n        this.userDefined = {};\n        /**\n         * @type {Object}\n         */\n        this.events = {};\n        /**\n         * @type {Object}\n         */\n        this.eventHandlers = {};\n        /**\n         * @type {Object}\n         */\n        this.data = {};\n        /**\n         * @type {ViewState}\n         */\n        this.states = {};\n        this.urlPath = '';\n        /**\n         * @type {boolean}\n         */\n        this.isInitlized = false;\n\n        /**\n         * @type {Object}\n         */\n        this.wrapperConfig = { enable: false, tag: null, follow: true, attributes: {}, ...(typeof config?.wrapperConfig === 'object' ? config.wrapperConfig : {}) };\n\n        /**\n         * @type {TemplateEngine}\n         */\n        this.templateEngine = null;\n\n        // Initialize\n        this.path = path;\n        this.config = config || {};\n\n\n\n        this.wrapTag = null;\n\n\n        /**\n         * @type {Map<string, FollowingBlock>}\n         */\n        this.followingBlocks = new Map();\n\n        this.followingConfig = [];\n        this.followingIndex = 0;\n        this.followingScanIndex = 0;\n        this.followingIDs = [];\n        this.followingPrerenderIDs = [];\n        this.followingRenderIDs = [];\n\n\n        this.subscribeStates = true;\n\n        this.childrenConfig = [];\n        this.childrenIndex = 0;\n        this.refreshChildrenIndex = 0;\n\n        /**\n         * @type {boolean}\n         */\n        this.isRendering = false;\n        /**\n         * @type {boolean}\n         */\n        this.isRendered = false;\n\n        this.isMounted = false;\n        this.isDestroyed = false; // Flag to prevent processing after destroy\n\n        this.isScanned = false;\n\n\n        this.isReady = false;\n\n        /**\n         * @type {OneMarkupModel}\n         */\n        this.markup = null;\n        /**\n         * @type {Array<OneMarkupModel>}\n         */\n        this.refElements = [];\n\n\n        this.eventListenerStatus = false;\n\n        this.eventListeners = [];\n\n        this.eventQuickHandles = [];\n\n        this.isVirtualRendering = false;\n        this.cachedSections = {};\n        this.renderedContent = null;\n\n        /**\n         * @type {Object<{name: string, id: string, index: number, view: ViewEngine, data: Object, subscribe: Array<string>}>}\n         */\n        this.__scope = null;\n        this.isRefreshing = false;\n\n        this.changeStateQueueCount = 0;\n        this.changedStateKeys = new Set(); // Use Set to avoid duplicates\n        this._stateChangePending = false; // Flag to track if processing is scheduled\n\n        /**\n         * @type {LoopContext}\n         */\n        this.loopContext = null;\n\n        this.isCommitedConstructorData = false;\n\n\n    }\n\n\n    /**\n     * Setup the view engine with configuration\n     * @param {string} path - View path\n     * @param {Object} config - View configuration\n     */\n    setup(path, config) {\n        if (this.isInitlized) {\n            return this;\n        }\n\n        // Set config and path\n        this.path = path;\n        this.config = config || {};\n\n        // Call _initialize to do the actual setup\n        this.initialize();\n        return this;\n    }\n\n\n    /**\n     * Initialize the view engine with configuration\n     * @private\n     */\n    initialize() {\n        if (this.isInitlized) {\n            return;\n        }\n\n        this.isInitlized = true;\n        const config = this.config;\n\n        // Set basic properties (gi nguyn tn t code gc)\n        this.id = config.viewId || uniqId();\n        deleteProp(config, 'viewId');\n        this.init = config.init || this._emptyFn;\n        deleteProp(config, 'init');\n        this.addCSS = config.addCSS || this._emptyFn;\n        deleteProp(config, 'addCSS');\n        this.removeCSS = config.removeCSS || this._emptyFn;\n        deleteProp(config, 'removeCSS');\n        this.states = config.states || new ViewState(this);\n        deleteProp(config, 'states');\n        this.superViewPath = config.superViewPath || config.superView;\n        deleteProp(config, 'superViewPath');\n        deleteProp(config, 'superView');\n        this.hasSuperView = config.hasSuperView;\n        deleteProp(config, 'hasSuperView');\n        this.hasAwaitData = config.hasAwaitData;\n        deleteProp(config, 'hasAwaitData');\n        this.hasFetchData = config.hasFetchData;\n        deleteProp(config, 'hasFetchData');\n        this.fetch = config.fetch;\n        deleteProp(config, 'fetch');\n        this.usesVars = config.usesVars;\n        deleteProp(config, 'usesVars');\n        this.hasSections = config.hasSections;\n        deleteProp(config, 'hasSections');\n        this.hasSectionPreload = config.hasSectionPreload;\n        deleteProp(config, 'hasSectionPreload');\n        this.renderLongSections = config.renderLongSections || [];\n        deleteProp(config, 'renderLongSections');\n        this.hasPrerender = config.hasPrerender;\n        deleteProp(config, 'hasPrerender');\n        this.sections = config.sections;\n        deleteProp(config, 'sections');\n        this.wrapperConfig = { ...this.wrapperConfig, ...(typeof config.wrapperConfig === 'object' ? config.wrapperConfig : {}) };\n        deleteProp(config, 'wrapperConfig');\n        this.resources = config.resources;\n        deleteProp(config, 'resources');\n        this.userDefined = config.userDefined;\n        deleteProp(config, 'userDefined');\n        // Initialize arrays and objects\n        this.master = null;\n        this.children = [];\n        this.events = {};\n        this.eventHandlers = {};\n\n        // Process defined properties and methods (gi nguyn logic t code gc)\n        this.processDefinedProperties(config);\n\n        if (config && config.data && typeof config.data === 'object' && config.data.__SSR_VIEW_ID__) {\n            config.data.__SSR_VIEW_ID__ = null;\n            deleteProp(config.data, '__SSR_VIEW_ID__');\n\n        }\n\n        // Merge data\n        this.data = { ...(this.data || {}), ...(config.data || {}) };\n        this.commitConstructorData();\n    }\n\n    /**\n     * Process defined properties and methods from config\n     * @private\n     */\n    processDefinedProperties(config) {\n        let definedProps = {};\n        let definedMethods = {};\n\n        if (config.__props__ && config.__props__.length > 0) {\n            config.__props__.forEach(prop => {\n                if (typeof config[prop] === 'function') {\n                    definedMethods[prop] = config[prop].bind(this);\n                }\n                else if (typeof config[prop] !== 'undefined') {\n                    definedProps[prop] = config[prop];\n                }\n            });\n        }\n        /**\n         * lifecycle methods\n         * beforeCreate hm dc gi trc khi view c to\n         * created hm dc gi sau khi view c to\n         * beforeMount hm dc gi trc khi view c mount\n         * mounted hm dc gi sau khi view c mount\n         * beforeUpdate hm dc gi trc khi view c update\n         * updated hm dc gi sau khi view c update\n         * beforeUnmount hm dc gi trc khi view c unmount\n         * unmounted hm dc gi sau khi view c unmount\n         */\n        if (this.userDefined) {\n            Object.entries(this.userDefined).forEach(([key, value]) => {\n                if (FORBIDDEN_KEYS.includes(key)) {\n                    return;\n                }\n                if (typeof value === 'function') {\n                    definedMethods[key] = value.bind(this);\n                }\n                else {\n                    definedProps[key] = value;\n                }\n            });\n        }\n\n        __defineProps(this, definedProps, {\n            writable: true,\n            configurable: true,\n            enumerable: true,\n        });\n\n        __defineMethods(this, definedMethods);\n    }\n\n\n\n    setScope(scope) {\n        this.__scope = scope;\n    }\n\n    loadServerData(_serverData = {}) {\n        const [data, events] = _serverData;\n        const result = typeof this.config.loadServerData === 'function' ? this.config.loadServerData.apply(this, [{ ...this.App.View.data, ...this.data, ..._data }]) : this.config.loadServerData;\n        if (typeof result === 'object' && result.constructor === this.constructor) {\n            return result;\n        }\n        return result;\n    }\n\n    commitConstructorData() {\n        if(hasData(this.data) && typeof this.config.commitConstructorData === 'function') {\n            this.config.commitConstructorData.apply(this, [{ ...this.App.View.data, ...this.data }]);\n        }\n        this.isCommitedConstructorData = true;\n    }\n\n    /**\n     * Add event configuration for view engine\n     * @param {string} eventType - Type of event\n     * @param {Array} handlers - Array of handler objects\n     * @returns {string} Event attribute string\n     * @example\n     * <AppViewEngine>.addEventConfig('click', [{handler: 'handleClick', params: [1, 2, 3]}]);\n     */\n    addEventConfig(eventType, handlers) {\n        if (typeof eventType !== 'string' || eventType === '') {\n            return;\n        }\n        if (typeof handlers !== 'object' || handlers === null) {\n            return;\n        }\n        let eventID = uniqId();\n        return this.addEventStack(eventType, eventID, handlers);\n    }\n\n\n\n    /**\n     * Render the view with data\n     * @param {Object} _data - Additional data to merge\n     * @returns {string|Object} Rendered content\n     */\n    render(_data = {}) {\n        let renderFollowIDStart = this.followingIDs.length;\n        this.data = { ...this.data, ..._data };\n        const result = this.config.render.apply(this, [{ ...this.App.View.data, ...this.data }]);\n        this.renderedContent = result;\n        let renderFollowIDEnd = this.followingIDs.length;\n        if (renderFollowIDEnd >= renderFollowIDStart) {\n            this.followingRenderIDs.push(...this.followingIDs.slice(renderFollowIDStart));\n        }\n\n        if (typeof result === 'string' && result.trim() !== '' && this.isHtmlString(result)) {\n            this.renderedContent = this.addXRefViewToRootElements(result);\n        }\n        return this.renderedContent;\n    }\n\n    /**\n     * Virtual render the view with data (Scan version)\n     * @param {Object} _data - Additional data to merge\n     * @returns {string|Object} Virtual rendered content\n     */\n    virtualRender(_data = {}) {\n        this.isVirtualRendering = true;\n        let renderFollowIDStart = this.followingIDs.length;\n        this.data = { ...this.data, ..._data };\n        const result = this.config.virtualRender.apply(this, [{ ...this.App.View.data, ...this.data }]);\n        let renderFollowIDEnd = this.followingIDs.length;\n        if (renderFollowIDEnd >= renderFollowIDStart) {\n            this.followingRenderIDs.push(...this.followingIDs.slice(renderFollowIDStart));\n        }\n        this.isVirtualRendering = false;\n\n        return result;\n    }\n\n\n\n\n    /**\n     * Prerender the view with data\n     * @param {Object} _data - Additional data to merge\n     * @returns {string|Object} Prerendered content\n     */\n    prerender(_data = {}) {\n        let renderFollowIDStart = this.followingIDs.length;\n        this.data = { ...this.data, ..._data };\n        const result = this.config.prerender.apply(this, [{ ...this.App.View.data, ...this.data }]);\n        let renderFollowIDEnd = this.followingIDs.length;\n        if (renderFollowIDEnd >= renderFollowIDStart) {\n            this.followingPrerenderIDs.push(...this.followingIDs.slice(renderFollowIDStart));\n        }\n        if (typeof result === 'string' && result.trim() !== '' && this.isHtmlString(result)) {\n            return this.addXRefViewToRootElements(result);\n        }\n        return result;\n    }\n\n    /**\n     * Virtual prerender the view with data (Scan version)\n     * @param {Object} _data - Additional data to merge\n     * @returns {string|Object} Virtual prerendered content\n     */\n    virtualPrerender(_data = {}) {\n        this.isVirtualRendering = true;\n        let renderFollowIDStart = this.followingIDs.length;\n        this.data = { ...this.data, ..._data };\n        const result = this.config.virtualPrerender.apply(this, [{ ...this.App.View.data, ...this.data }]);\n        let renderFollowIDEnd = this.followingIDs.length;\n        if (renderFollowIDEnd >= renderFollowIDStart) {\n            this.followingPrerenderIDs.push(...this.followingIDs.slice(renderFollowIDStart));\n        }\n        this.isVirtualRendering = false;\n        return result;\n    }\n\n\n\n\n    /**\n     * Replace view content with new HTML\n     * @param {string} htmlString - New HTML content\n     * @returns {boolean} True if replaced successfully\n     */\n    replaceView(htmlString) {\n        if (this.isHtmlString(htmlString)) {\n            const container = document.createElement('div');\n            container.innerHTML = htmlString;\n            const frag = container.content;\n            const oldElements = document.querySelectorAll(`[x-ref-view=\"${this.id}\"]`);\n            const elemtntCount = oldElements.length;\n            for (let i = elemtntCount - 1; i > 0; i--) {\n                const oldElement = oldElements[i];\n                const newElement = frag.childNodes[i];\n                oldElement.parentNode.replaceChild(newElement, oldElement);\n            }\n            const oldElement = oldElements[0];\n            oldElement.parentNode.replaceChild(frag, oldElement);\n            return true;\n        }\n        return false;\n    }\n\n\n    /** lifecycle methods */\n\n    /**\n     * Lifecycle: Called before view is created (gi nguyn tn t code gc)\n     */\n\n    beforeCreate() {\n        if (typeof this.userDefined.beforeCreate === 'function') {\n            this.userDefined.beforeCreate.call(this);\n        }\n    }\n    /**\n     * Lifecycle: Called after view is created (gi nguyn tn t code gc)\n     */\n    created() {\n        if (typeof this.userDefined.created === 'function') {\n            this.userDefined.created.call(this);\n        }\n    }\n\n    /**\n     * Lifecycle: Called before view is updated (gi nguyn tn t code gc)\n     */\n    beforeUpdate() {\n        if (typeof this.userDefined.beforeUpdate === 'function') {\n            this.userDefined.beforeUpdate.call(this);\n        }\n    }\n    /**\n     * Lifecycle: Called after view is updated (gi nguyn tn t code gc)\n     */\n    updated() {\n        if (typeof this.userDefined.updated === 'function') {\n            this.userDefined.updated.call(this);\n        }\n    }\n\n    beforeInit() {\n        if (typeof this.userDefined.beforeInit === 'function') {\n            this.userDefined.beforeInit.call(this);\n        }\n    }\n    init() {\n        if (typeof this.userDefined.init === 'function') {\n            this.userDefined.init.call(this);\n        }\n    }\n    afterInit() {\n        if (typeof this.userDefined.afterInit === 'function') {\n            this.userDefined.afterInit.call(this);\n        }\n    }\n    /**\n     * Lifecycle: Called before view is destroyed (gi nguyn tn t code gc)\n     */\n    beforeDestroy() {\n        if (typeof this.userDefined.beforeDestroy === 'function') {\n            this.userDefined.beforeDestroy.call(this);\n        }\n    }\n    /**\n     * Lifecycle: Called after view is destroyed (gi nguyn tn t code gc)\n     */\n    destroyed() {\n        if (typeof this.userDefined.destroyed === 'function') {\n            this.userDefined.destroyed.call(this);\n        }\n    }\n    /**\n     * Lifecycle: Called before view is mounted (gi nguyn tn t code gc)\n     */\n    beforeMount() {\n        if (typeof this.userDefined.beforeMount === 'function') {\n            this.userDefined.beforeMount.call(this);\n        }\n    }\n\n\n    /**\n     * Lifecycle: Called when view is mounted (gi nguyn tn t code gc)  \n     */\n    mounted() {\n        if (!this.isMounted) {\n            if (typeof this.userDefined.mounted === 'function') {\n                this.userDefined.mounted.call(this);\n            }\n\n            this.startEventListener();\n            this.isMounted = true;\n        }\n\n        if (this.originalView && this.originalView instanceof ViewEngine) {\n            this.originalView.onSuperViewMounted();\n        }\n        if (this.children && this.children.length > 0) {\n            this.children.forEach(child => {\n                if (child && child instanceof ViewEngine) {\n                    child.onParentMounted();\n                }\n            });\n        }\n        if (this.followingBlocks && this.followingBlocks.size > 0) {\n            this.followingBlocks.forEach(block => {\n                block.mounted();\n            });\n        }\n    }\n\n    /**\n     * Lifecycle: Called before view is unmounted (gi nguyn tn t code gc)\n     */\n    beforeUnmount() {\n        if (typeof this.userDefined.beforeUnmounted === 'function') {\n            this.userDefined.beforeUnmounted.call(this);\n        }\n    }\n\n    /**\n     * Lifecycle: Called when view is unmounted (gi nguyn tn t code gc)\n     */\n    unmounted() {\n        if (this.isMounted) {\n            if (typeof this.userDefined.unmounted === 'function') {\n                this.userDefined.unmounted.call(this);\n            }\n            this.stopEventListener();\n            this.isMounted = false;\n        }\n        if (this.originalView && this.originalView instanceof ViewEngine) {\n            this.originalView.onSuperViewUnmounted();\n        }\n        if (this.children && this.children.length > 0) {\n            this.children.forEach(child => {\n                if (child && child instanceof ViewEngine) {\n                    child.onParentUnmounted();\n                }\n            });\n        }\n        if (this.followingBlocks && this.followingBlocks.size > 0) {\n            this.followingBlocks.forEach(block => {\n                block.unmounted();\n            });\n        }\n    }\n\n\n    /**\n     * Lifecycle: Called when view is destroyed (gi nguyn tn t code gc)\n     */\n    destroy() {\n        // Mark as destroyed to prevent processing after destroy\n        this.isDestroyed = true;\n        \n        // Reset pending flag to prevent processing after destroy\n        this._stateChangePending = false;\n        \n        // Clear state change collections\n        if(this.changedStateKeys){\n            this.changedStateKeys.clear();\n        }\n        this.changeStateQueueCount = 0;\n        \n        this.unmounted();\n        if(this.originalView && this.originalView instanceof ViewEngine) {\n            this.originalView.destroy();\n        }\n        if(this.children && this.children.length > 0) {\n            this.children.forEach(child => child.destroy());\n        }\n        if(this.followingBlocks && this.followingBlocks.size > 0) {\n            this.followingBlocks.forEach(block => block.destroy());\n            this.followingBlocks.clear();\n        }\n        if(this.refElements && this.refElements.length > 0) {\n            this.refElements.forEach(element => element.parentNode && element.parentNode.removeChild(element));\n            this.refElements = [];\n        }\n    }\n\n    refresh(){\n        this.isRefreshing = true;\n        // TH1: c super view\n        if(this.parent && this.parent instanceof ViewEngine) {\n            this.parent.refresh();\n        }\n        // TH2: nu l super view\n        // TH3: nu l page view\n        // TH4: nu l child view\n    }\n    /**\n     * Lifecycle: Called when super view is mounted (gi nguyn tn t code gc)\n     */\n    onSuperViewMounted() {\n        this.mounted();\n    }\n\n    /**\n     * Lifecycle: Called when super view is unmounted (gi nguyn tn t code gc)\n     */\n    onSuperViewUnmounted() {\n\n    }\n\n    /**\n     * Lifecycle: Called when parent view is mounted (gi nguyn tn t code gc)\n     */\n    onParentMounted() {\n        this.mounted();\n    }\n    /**\n     * Lifecycle: Called when parent view is unmounted (gi nguyn tn t code gc)\n     */\n    onParentUnmounted() {\n        // Placeholder for when parent view is unmounted\n    }\n\n\n\n    /**\n     * Hm parse string HTML thnh DOM, thm thuc tnh x-ref-view cho cc phn t con level 0, tr v string HTML mi.\n     * @param {string} htmlString - Chui HTML u vo\n     * @param {string|number} id - Gi tr cho thuc tnh x-ref-view\n     * @returns {string} Chui HTML  thm thuc tnh x-ref-view cho cc phn t level 0\n     */\n    addXRefViewToRootElements(htmlString) {\n        // To mt container o  parse HTML\n        const container = document.createElement('div');\n        container.innerHTML = htmlString;\n\n        // Lp qua cc phn t con trc tip (level 0)\n        Array.from(container.children).forEach(child => {\n            child.setAttribute('x-ref-view', this.id);\n        });\n\n        // Tr v HTML  c thm thuc tnh\n        return container.innerHTML;\n    }\n\n    /**\n     * Check if string is HTML\n     * @param {string} str - String to check\n     * @returns {boolean} True if HTML string\n     * @private\n     */\n    isHtmlString(str) {\n        return /<[a-z][\\s\\S]*>/i.test(str);\n    }\n\n\n\n    renderPlaceholder() {\n        return `<div class=\"${ATTR.className('placeholder')}\" ${ATTR.KEYS.VIEW_ID}=\"${this.id}\"></div>`;\n    }\n\n    showError(error) {\n        if (this.isSuperView) {\n            return `<div class=\"${ATTR.className('ERROR_VIEW')}\">${error}</div>`;\n        }\n        else if (this.hasSuperView) {\n            if (this.renderLongSections.length > 0) {\n                return this.renderLongSections.map(section => {\n                    return this.App.View.section(section, `<div class=\"${ATTR.className('section-error')}\" ${ATTR.KEYS.VIEW_SECTION_REF}=\"${this.id}\">${error}</div>`, 'html');\n                }).join('');\n            }\n            else {\n                return `<div class=\"${ATTR.className('ERROR_VIEW')}\" ${ATTR.KEYS.VIEW_ID}=\"${this.id}\">${error}</div>`;\n            }\n        }\n        else {\n            if (this.renderLongSections.length > 0) {\n                return this.renderLongSections.map(section => {\n                    return this.App.View.section(section, `<div class=\"${ATTR.className('section-error')}\" ${ATTR.KEYS.VIEW_SECTION_REF}=\"${this.id}\">${error}</div>`, 'html');\n                }).join('');\n            }\n            return `<div class=\"${ATTR.className('ERROR_VIEW')}\" ${ATTR.KEYS.VIEW_ID}=\"${this.id}\">${error}</div>`;\n        }\n    }\n\n    showErrorScan(error) {\n        return null;\n    }\n\n    \n    resetOriginalView() {\n        if(this.originalView && this.originalView instanceof ViewEngine) {\n            this.originalView.destroy();\n        }\n    }\n\n    ejectOriginalView() {\n        if(this.originalView && this.originalView instanceof ViewEngine) {\n            this.originalView = null;\n            this.originalViewId = null;\n            this.originalViewPath = null;\n        }\n    }\n\n    /**\n     * Remove this view and all children\n     * @returns {AppViewEngine} This instance for chaining\n     */\n    remove() {\n        this.master?.removeChild(this);\n        this.children.forEach(child => child.remove());\n        this.master = null;\n        this.children = [];\n        return this;\n    }\n\n    /**\n     * Insert resources into DOM\n     */\n    insertResources() {\n        this.resources.forEach(resource => {\n            if (document.querySelector(`[data-resource-uuid=\"${resource.uuid}\"]`)) {\n                return;\n            }\n            const element = document.createElement(resource.tag);\n            Object.entries(resource.attrs).forEach(([key, value]) => {\n                element.setAttribute(key, value);\n            });\n            element.setAttribute('data-resource-uuid', resource.uuid);\n            if (resource.tag === 'script') {\n                document.body.appendChild(element);\n            }\n            else if (resource.tag === 'link') {\n                document.head.appendChild(element);\n            }\n            else if (resource.tag === 'style') {\n                document.head.appendChild(element);\n            }\n            document.head.appendChild(element);\n        });\n    }\n\n    /**\n     * Remove resources from DOM\n     */\n    removeResources() {\n        this.resources.forEach(resource => {\n            const element = document.querySelector(`[data-resource-uuid=\"${resource.uuid}\"]`);\n            if (element) {\n                element.remove();\n            }\n        });\n    }\n\n\n    __showError(error) {\n        logger.error(`ViewEngine Error [${this.path}]: ${error}`);\n        return this.showError(error);\n    }\n    \n\n\n    __section(name, content, type) {\n        this.cachedSections[name] = content;\n        return this.App.View.section(name, content, type);\n    }\n\n    __yield(name, defaultValue = '') {\n        return this.App.View.yield(name, defaultValue);\n    }\n\n    __yieldContent(name, defaultValue = '') {\n        return this.App.View.yieldContent(name, defaultValue);\n    }\n\n    __include(path, data = {}) {\n        const parentData = this.data ? this.data : {};\n        if (parentData.__SSR_VIEW_ID__) {\n            parentData.__SSR_VIEW_ID__ = null;\n            delete parentData.__SSR_VIEW_ID__;\n        }\n        const viewInstance = this.App.View.include(path, { ...parentData, ...data });\n        if (!viewInstance) {\n            return null;\n        }\n        viewInstance.setParent(this);\n        this.addChild(viewInstance, data);\n        return viewInstance;\n    }\n\n    __includeif(path, data = {}) {\n        if (!this.App.View.exists(path)) {\n            return null;\n        }\n        return this.__include(path, data);\n    }\n\n    __includewhen(condition, path, data = {}) {\n        if (!condition) {\n            return null;\n        }\n        return this.__include(path, data);\n    }\n\n    __extends(path, data = {}) {\n        const originData = this.data ? this.data : {};\n        if (originData.__SSR_VIEW_ID__) {\n            originData.__SSR_VIEW_ID__ = null;\n            delete originData.__SSR_VIEW_ID__;\n        }\n        const viewInstance = this.App.View.extendView(path, { ...originData, ...data });\n        if (!viewInstance) {\n            return null;\n        }\n        this.superViewPath = path;\n        this.setSuperView(viewInstance);\n        viewInstance.setOriginalView(this);\n        return viewInstance;\n    }\n\n\n    __setLoopContext(length) {\n        let parent = this.loopContext;\n        this.loopContext = new LoopContext(parent);\n        this.loopContext.setCount(length);\n        return this.loopContext;\n    }\n\n    __resetLoopContext() {\n        if(this.loopContext && this.loopContext.parent) {\n            let parent = this.loopContext.parent;\n            this.loopContext.parent = null;\n            Object.freeze(this.loopContext);\n            this.loopContext = parent;\n        } else if (this.loopContext) {\n            Object.freeze(this.loopContext);\n            this.loopContext = null;\n        } else {\n            this.loopContext = null;\n        }\n        return this.loopContext;\n    }\n\n    /**\n     * Lp qua danh sch hoc i tng v gi callback cho mi phn t hoc key\n     * @param {Array|Object} list danh sch cn lp hoc i tng cn lp\n     * @param {function(item: any, defaultKeyName: string, index: number, loopContext: LoopContext): string} callback hm callback  x l mi phn t hoc key ca i tng\n     * @returns {string} kt qu ca vic lp\n     * @example\n     * <AppViewEngine>.foreach([1, 2, 3], (item, defaultKeyName, index, loopContext) => {\n     *     return `<div>${defaultKeyName}: ${item}</div>`;\n     * });\n     * // returns '<div>1</div><div>2</div><div>3</div>'\n     * <AppViewEngine>.foreach({a: 1, b: 2, c: 3}, (value, key, index, loopContext) => {\n     *     return `<div>${key}: ${value}</div>`;\n     * });\n     */\n    __foreach(list, callback) {\n        if (!list) {\n            return '';\n        }\n        if (!(list && typeof list === 'object' && !Array.isArray(list))) {\n            return '';\n        }\n        let result = '';\n        if (Array.isArray(list)) {\n            let loopContext = this.__setupLoopContext(list);\n            loopContext.setType('increment');\n            list.forEach((item, index) => {\n                loopContext.setCurrentTimes(index);\n                result += callback(item, index, index, loopContext);\n            });\n            this.__resetLoopContext();\n        } else {\n            let count = Object.keys(list).length;\n            let loopContext = this.__setupLoopContext(count);\n            loopContext.setType('increment');\n            Object.entries(list).forEach(([key, value]) => {\n                loopContext.setCurrentTimes(index);\n                result += callback(value, key, index, loopContext);\n                index++;\n            });\n            this.__resetLoopContext();\n        }\n        return result;\n    }\n\n\n    /**\n     * Scan and hydrate server-rendered view\n     * This method:\n     * 1. Finds DOM elements for this view\n     * 2. Attaches event handlers from server data\n     * 3. Sets up state subscriptions\n     * 4. Stores children and following block references\n     *\n     * @param {Object} config - Server-side view configuration\n     * @param {string} config.viewId - View instance ID\n     * @param {Object} config.data - View data from server\n     * @param {Object} config.events - Event handlers to attach\n     * @param {Array} config.following - Following blocks to setup\n     * @param {Array} config.children - Child views to scan\n     * @param {Object} config.parent - Parent view reference\n     */\n    __scan(config) {\n        if (this.isScanned) {\n            return;\n        }\n        this.isScanned = true;\n        const { viewId, data, events, following, children, parent } = config;\n        if (data && typeof data === 'object') {\n            // this.data = { ...this.data, ...data };\n            this.updateVariableData(data);\n        }\n\n\n        if (typeof viewId !== 'string' || viewId === '') {\n            logger.warn(' ViewEngine.__scan: Invalid viewId', viewId);\n            return null;\n        }\n\n        logger.log(` ViewEngine.__scan: Scanning view ${this.path} (${viewId})`);\n\n        // ========================================================================\n        // STEP 1: Find DOM Elements\n        // ========================================================================\n\n        this.__scanDOMElements(viewId);\n\n        // ========================================================================\n        // STEP 2: Attach Event Handlers\n        // ========================================================================\n\n        if (events && typeof events === 'object') {\n            this.__attachEventHandlers(events, viewId);\n\n        }\n\n        // ========================================================================\n        // STEP 3: Setup State Subscriptions (Following Blocks)\n        // ========================================================================\n\n        if (following && following.length > 0) {\n            this.__setupFollowingBlocks(following, viewId);\n        }\n\n        // ========================================================================\n        // STEP 4: Store Children References\n        // ========================================================================\n\n        if (children && children.length > 0) {\n            this.__storeChildrenReferences(children);\n        }\n\n        // ========================================================================\n        // STEP 5: Store Parent Reference\n        // ========================================================================\n\n        // if (parent) {\n        //     this.parentView = parent;\n        // }\n\n        logger.log(` ViewEngine.__scan: Scan complete for ${this.path} (${viewId})`);\n    }\n\n    /**\n     * Find and store DOM elements for this view\n     * @private\n     * @param {string} viewId - View instance ID\n     */\n    __scanDOMElements(viewId) {\n        if (this.hasSuperView) {\n            logger.log(` ViewEngine.__scanDOMElements: Skipping element scan for ${this.path} (${viewId}) due to super view`);\n            return;\n        }\n        if (this.wrapperConfig.enable) {\n            if (this.wrapperConfig.tag) {\n                // Custom wrapper tag\n                let elements = document.querySelectorAll(\n                    `${this.wrapperConfig.tag}[data-wrap-view=\"${this.path}\"][${ATTR.KEYS.VIEW_WRAPPER}=\"${viewId}\"]`\n                );\n                if (elements.length > 0) {\n                    this.refElements = Array.from(elements).map((el) => {\n                        el.setAttribute('x-ref-view', viewId);\n                        return el;\n                    });\n                    logger.log(` ViewEngine.__scanDOMElements: Found ${elements.length} custom wrapper elements`);\n                }\n            } else {\n                // Use OneMarkup to find view boundary\n                const markup = OneMarkup.first('view', { name: this.path, id: viewId });\n                if (markup) {\n                    this.markup = markup;\n                    this.refElements = markup.nodes.filter(node => node.nodeType === Node.ELEMENT_NODE);\n                    logger.log(` ViewEngine.__scanDOMElements: Found view boundary with ${this.refElements.length} elements`);\n                }\n            }\n        } else {\n            // Standard view wrapper\n            let elements = document.querySelectorAll(`[data-view-wrapper=\"${viewId}\"]`);\n            if (elements.length > 0) {\n                this.refElements = Array.from(elements).map((el) => {\n                    el.setAttribute('x-ref-view', viewId);\n                    return el;\n                });\n                logger.log(` ViewEngine.__scanDOMElements: Found ${elements.length} standard wrapper elements`);\n            }\n        }\n\n        if (!this.refElements || this.refElements.length === 0) {\n            logger.warn(` ViewEngine.__scanDOMElements: No elements found for ${this.path} (${viewId})`);\n        }\n    }\n\n    /**\n     * Attach event handlers to DOM elements from server data\n     * @private\n     * @param {Object} events - Event map from server\n     * @param {string} viewId - View instance ID\n     */\n    __attachEventHandlers(events, viewId) {\n        let attachedCount = 0;\n        this.events = events;\n        return;\n\n        logger.log(` ViewEngine.__attachEventHandlers: Attached ${attachedCount} event handlers`);\n    }\n\n    /**\n     * Setup following blocks for reactive state updates\n     * @private\n     * @param {Array} following - Following block configurations\n     * @param {string} viewId - View instance ID\n     */\n    __setupFollowingBlocks(following, viewId) {\n        following.forEach(followConfig => {\n            const { id, stateKeys } = followConfig;\n\n            // Store config\n            this.followingConfig.push({\n                id,\n                stateKeys,\n            });\n            return;\n            // Find follow block in DOM using OneMarkup\n            const followBlocks = OneMarkup.find('follow', { id }, {}, false);\n\n            if (followBlocks.length === 0) {\n                logger.warn(` ViewEngine.__setupFollowingBlocks: Follow block ${id} not found in DOM`);\n                return;\n            }\n\n            const followBlock = followBlocks[0];\n\n            // Subscribe to state changes\n            stateKeys.forEach(stateKey => {\n                this.states.on(stateKey, (newValue, oldValue) => {\n                    logger.log(` ViewEngine: State ${stateKey} changed, re-rendering follow block ${id}`);\n                    // TODO: Re-render this follow block\n                    // This requires storing the render function for each follow block\n                    this.__rerenderFollowBlock(id, followBlock);\n                });\n            });\n        });\n\n        logger.log(` ViewEngine.__setupFollowingBlocks: Setup ${following.length} following blocks`);\n    }\n\n    /**\n     * Re-render a specific follow block\n     * @private\n     * @param {string} followId - Follow block ID\n     * @param {Object} followBlock - Follow block DOM reference\n     */\n    __rerenderFollowBlock(followId, followBlock) {\n        // TODO: Implement follow block re-rendering\n        // This needs to:\n        // 1. Call the render function for this follow block\n        // 2. Replace DOM content between comment markers\n        // 3. Re-attach event handlers if needed\n        logger.log(` ViewEngine.__rerenderFollowBlock: Re-rendering follow block ${followId}`);\n    }\n\n    /**\n     * Store children view references for hydration\n     * @private\n     * @param {Array} children - Child view configurations\n     */\n    __storeChildrenReferences(children) {\n        children.forEach(child => {\n            const { name, id } = child;\n            this.childrenConfig.push({\n                name,\n                id,\n            });\n        });\n\n        // logger.log(` ViewEngine.__storeChildrenReferences: Stored ${children.length} children references`);\n    }\n\n\n\n    __sectionScan(name, content, type) {\n        this.cachedSections[name] = content;\n        return null;\n    }\n\n    __includeScan(name, data = {}) {\n        const childParams = this.childrenConfig[this.childrenIndex];\n        if (!(childParams && childParams.name === name)) {\n            return null;\n        }\n        this.childrenIndex++;\n        const childConfig = this.App.View.ssrViewManager.getInstance(childParams.name, childParams.id);\n        if (!childConfig) {\n            return null;\n        }\n        const childData = { ...data, ...childConfig.data, __SSR_VIEW_ID__: childParams.id };\n        const child = this.__include(childParams.name, childData);\n        if (!child) {\n            return null;\n        }\n        child.__scan(childConfig);\n        return child;\n    }\n    __includeifScan(name, data = {}) {\n        if (!this.App.View.exists(name)) {\n            return null;\n        }\n        return this.__includeScan(name, data);\n    }\n    __includewhenScan(condition, name, data = {}) {\n        if (!condition) {\n            return null;\n        }\n        return this.__include(name, data);\n    }\n    __extendsScan(name, data = {}) {\n        if (!this.App.View.exists(name)) {\n            return null;\n        }\n\n        let superViewConfig = null;\n\n        let superViewOfChildren = this.childrenConfig.find((child, index) => child.name === name && index == this.childrenConfig.length - 1);\n        if (superViewOfChildren) {\n            superViewConfig = this.App.View.ssrViewManager.getInstance(superViewOfChildren.name, superViewOfChildren.id);\n        } else {\n            superViewConfig = this.App.View.ssrViewManager.scan(name);\n        }\n\n\n\n        if (!superViewConfig) {\n            return null;\n        }\n        const superViewData = { ...data, ...superViewConfig.data, __SSR_VIEW_ID__: superViewConfig.viewId };\n        const superView = this.__extends(name, superViewData);\n        if (!superView) {\n            return null;\n        }\n        superView.__scan(superViewConfig);\n        return superView;\n    }\n\n    __showErrorScan(error) {\n        logger.error(`ViewEngine Scan Error [${this.path}]: ${error}`);\n        return null;\n    }\n    \n    __foreachScan(list, callback) {\n        return null;\n    }\n    __execute(...args) {\n        return this.App.View.execute(...args);\n    }\n    subscribeScan(...args) {\n        // return this.subscribe(...args);\n    }\n\n    __subscribe(...args) {\n        return this.subscribe(...args);\n    }\n\n    __subscribeScan(...args) {\n        return this.subscribeScan(...args);\n    }\n\n    __text(...args) {\n        return this.App.View.text(...args);\n    }\n\n    __textScan(...args) {\n        return ''// this.App.View.textScan(...args);\n    }\n\n\n\n    /**\n     * Add event stack for specific event type and ID\n     * @param {string} eventType - Type of event\n     * @param {string} eventID - ID of event\n     * @param {Array} handlers - Array of handler objects\n     * @returns {string} Event attribute string\n     */\n    addEventStack(eventType, eventID, handlers) {\n        if (typeof eventID !== 'string' || eventID === '') {\n            return;\n        }\n        if (typeof handlers !== 'object' || handlers === null) {\n            return;\n        }\n        if (typeof this.events[eventType] === 'undefined') {\n            this.events[eventType] = {};\n        }\n        if (typeof this.events[eventType][eventID] === 'undefined') {\n            this.events[eventType][eventID] = []\n        }\n        this.events[eventType][eventID].push(...handlers);\n\n        return ` data-${eventType}-id=\"${eventID}\"`;\n    }\n\n    addEventStackScan(eventType, eventID, handlers) {\n        return this.addEventStack(eventType, eventID, handlers);\n    }\n\n\n    addEventConfigScan(eventType, handlers) {\n        // return this.addEventConfig(eventType, handlers);\n    }\n\n    __addEventConfig(eventType, handlers) {\n        return this.addEventConfig(eventType, handlers);\n    }\n    __addEventConfigScan(eventType, handlers) {\n        return this.addEventConfigScan(eventType, handlers);\n    }\n\n\n    __addEventQuickHandle(eventType, handlers) {\n        return this.addEventQuickHandle(eventType, handlers);\n    }\n    __addEventQuickHandleScan(eventType, handlers) {\n        return this.addEventQuickHandleScan(eventType, handlers);\n    }\n\n    /**\n     * Set event configuration for view engine\n     * @param {Object} events - Event configuration object\n     */\n    setEventConfig(events) {\n        if (typeof events !== 'object' || events === null) {\n            return;\n        }\n        Object.entries(events).forEach((eventType, eventObjectList) => {\n            if (typeof eventObjectList !== 'object' || eventObjectList === null) {\n                return;\n            }\n            Object.entries(eventObjectList).forEach((eventID, handlers) => {\n                this.addEventStack(eventType, eventID, handlers);\n            });\n        });\n    }\n\n    addEventQuickHandle(eventType, handlers) {\n        if (typeof eventType !== 'string' || eventType === '' || Array.isArray(handlers) || handlers.length !==  handlers.filter(handler => typeof handler === 'function').length) {\n            return;\n        }\n        let index = this.eventQuickHandles.length;\n        const id = `${this.id}-${eventType}-${index}`;\n        this.eventQuickHandles.push({ id, type: eventType, handlers });\n        return ` data-${eventType}-id=\"${id}\"`;\n    }\n\n    addEventQuickHandleScan(eventType, handlers) {\n        return this.addEventQuickHandle(eventType, handlers);\n    }\n\n    setEventConfigScan(events) {\n        return this.setEventConfig(events);\n    }\n\n\n    startEventListener() {\n        const needDeleted = [];\n        Object.entries(this.events).forEach(([eventType, eventMap]) => {\n            Object.entries(eventMap).forEach(([eventID, handlers]) => {\n                const selector = `[data-${eventType}-id=\"${eventID}\"]`;\n                const elements = document.querySelectorAll(selector);\n                const parsedHandlers = this.parseEventHandlerFunctions(handlers);\n                if (parsedHandlers.length !== 0 && elements.length > 0) {\n                    elements.forEach(element => {\n                        const handler = (event) => {\n                            let returnValue = null;\n                            for (let i = 0; i < parsedHandlers.length; i++) {\n                                const handlerFn = parsedHandlers[i];\n                                returnValue = handlerFn(event);\n                                if (returnValue === false || event.defaultPrevented) {\n                                    event.preventDefault();\n                                    event.stopPropagation();\n                                    break;\n                                }\n                            }\n                            if (returnValue === false || returnValue === true) {\n                                return returnValue;\n                            }\n                        }\n                        element.addEventListener(eventType, handler);\n                        this.eventListeners.push({ element, eventType, handler });\n                    });\n                } else {\n                    logger.warn(` ViewEngine.startEventListener: No elements found for selector ${selector} or no handlers defined`);\n                    needDeleted.push({ eventType, eventID });\n                }\n            });\n        });\n        needDeleted.forEach(({ eventType, eventID }) => {\n            delete this.events[eventType][eventID];\n            // If no more event handlers for this eventType, remove the entire eventType\n            if (Object.keys(this.events[eventType]).length === 0) {\n                delete this.events[eventType];\n            }\n        });\n        this.eventListenerStatus = true;\n    }\n\n    stopEventListener() {\n        this.eventListeners.forEach(({ element, eventType, handler }) => {\n            element.removeEventListener(eventType, handler);\n        });\n        this.eventListeners = [];\n        this.eventListenerStatus = false;\n    }\n\n    /**\n     * Clear all event data when elements are not found\n     * This helps prevent memory leaks from orphaned event handlers\n     */\n    clearOrphanedEventData() {\n        const needDeleted = [];\n        Object.entries(this.events).forEach(([eventType, eventMap]) => {\n            Object.entries(eventMap).forEach(([eventID, handlers]) => {\n                const selector = `[data-${eventType}-id=\"${eventID}\"]`;\n                const elements = document.querySelectorAll(selector);\n                if (elements.length === 0) {\n                    needDeleted.push({ eventType, eventID });\n                }\n            });\n        });\n\n        needDeleted.forEach(({ eventType, eventID }) => {\n            delete this.events[eventType][eventID];\n            // If no more event handlers for this eventType, remove the entire eventType\n            if (Object.keys(this.events[eventType]).length === 0) {\n                delete this.events[eventType];\n            }\n        });\n\n        if (needDeleted.length > 0) {\n            logger.log(` ViewEngine.clearOrphanedEventData: Cleaned up ${needDeleted.length} orphaned event handlers`);\n        }\n    }\n\n    parseEventHandlerFunctions(handlers) {\n        let parsedHandlers = [];\n        handlers.forEach(handlerObj => {\n            const handlerName = handlerObj.handler;\n            const params = handlerObj.params || [];\n            let fn = null;\n            if (typeof this.userDefined[handlerName] === 'function') {\n                fn = event => this.userDefined[handlerName].apply(this, this.parseEventHandlerParams(event, params));\n            }\n            else if (typeof this[handlerName] === 'function') {\n                fn = event => this[handlerName].apply(this, this.parseEventHandlerParams(event, params));\n            }\n            else if (window && typeof window[handlerName] === 'function') {\n                fn = event => window[handlerName].apply(this, this.parseEventHandlerParams(event, params));\n            }\n            else {\n                fn = event => console.warn(` Event handler ${handlerName} is not defined`, event);\n            }\n            parsedHandlers.push(fn);\n        });\n        return parsedHandlers;\n    }\n\n    parseEventHandlerParams(event, params = []) {\n        return params.map(param => {\n            if (param === '@EVENT') {\n                return event;\n            }\n            else if (typeof param === 'object' && param !== null) {\n                return this.parseEventHandlerObject(event, param);\n            }\n            else if (Array.isArray(param)) {\n                return this.parseEventHandlerParams(event, param);\n            }\n            return param;\n        });\n    }\n\n    parseEventHandlerObject(event, object = {}) {\n        let parsedObject = {};\n        Object.entries(object).forEach(([key, value]) => {\n            if (value === '@EVENT') {\n                parsedObject[key] = event;\n            }\n            else if (typeof value === 'object' && value !== null) {\n                parsedObject[key] = this.parseEventHandlerObject(event, value);\n            }\n            else if (Array.isArray(value)) {\n                parsedObject[key] = this.parseEventHandlerParams(event, value);\n            }\n            else {\n                parsedObject[key] = value;\n            }\n        });\n        return parsedObject;\n    }\n\n\n\n\n\n    wrapattr() {\n        return ` ${ATTR.KEYS.VIEW_WRAPPER}=\"${this.id}\"`;\n    }\n\n    startWrapper(tag = null, attributes = {}) {\n        this.wrapTag = null;\n        if (typeof tag === 'string') {\n            this.wrapTag = tag;\n        }\n        else if (typeof tag === 'object') {\n            this.wrapTag = tag.tag || 'div';\n            delete tag.tag;\n            attributes = { ...attributes, ...tag.attributes };\n            tag = null;\n        }\n        if (typeof attributes === 'string' || !attributes) {\n            attributes = {};\n        }\n        if (this.wrapTag) {\n            return `<${this.wrapTag} data-wrap-view=\"${this.path}\" data-wrap-id=\"${this.id}\" ${Object.entries(attributes).map(([key, value]) => `${key}=\"${value}\"`).join(' ')}>`;\n        }\n        return `<!-- [one:view name=\"${this.path}\" id=\"${this.id}\"] -->`;\n\n    }\n    endWrapper() {\n        if (this.wrapTag) {\n            this.wrapTag = null;\n            return `</${this.wrapTag}>`;\n        }\n        this.wrapTag = null;\n        return `<!-- [/one:view] -->`;\n    }\n\n    addBlock(name, attributes = {}, content) {\n        if (typeof name !== 'string' || name === '') {\n            return;\n        }\n        console.log('Add block:', name, attributes, content);\n        return this.App.View.section(\"block.\" + name, `<!-- [one:block name=\"${this.path}\" ref=\"${this.id}\"] -->${content}<!-- [/one:block] -->`, 'html');\n    }\n\n    addBlockScan(name, attributes = {}, content) {\n\n        if (typeof name !== 'string' || name === '') {\n            return;\n        }\n        return this.App.View.section(\"block.\" + name, `<!-- [one:block name=\"${this.path}\" ref=\"${this.id}\"] -->${content}<!-- [/one:block] -->`, 'html');\n    }\n\n    __block(name, attributes = {}, content) {\n        return this.addBlock(name, attributes, content);\n    }\n\n    __blockScan(name, attributes = {}, content) {\n        return this.addBlockScan(name, attributes, content);\n    }\n\n    useBlock(name, defaultValue = '') {\n        if (typeof name !== 'string' || name === '') {\n            return;\n        }\n        return \"<!-- [one:subscribe type=\\\"block\\\" key=\\\"\" + name + \"\\\"] -->\" + this.App.View.yield(\"block.\" + name, defaultValue) + \"<!-- [/one:subscribe] -->\";\n    }\n\n    useBlockScan(name, defaultValue = '') {\n        if (typeof name !== 'string' || name === '') {\n            return;\n        }\n        return `<!-- [one:subscribe type=\"block\" key=\"${name}\"] -->${this.App.View.yield(\"block.\" + name, defaultValue)}<!-- [/one:subscribe] -->`;\n    }\n\n    mountBlock(name, defaultValue = '') {\n        return this.useBlock(name, defaultValue);\n    }\n\n    subscribeBlock(name, defaultValue = '') {\n        return \" data-subscribe-block=\\\"\" + name + \"\\\"\";\n    }\n\n    renderFollowingBlock(stateKeys = [], renderBlock = () => '') {\n        if (!Array.isArray(stateKeys) || stateKeys.length === 0) {\n            return '';\n        }\n\n        if (typeof renderBlock !== 'function') {\n            return '';\n        }\n        const followBlock = new FollowingBlock({ stateKeys, renderBlock, engine: this, states: this.states, App: this.App });\n        // this.followingBlocks.push(followBlock);\n        this.followingIDs.push(followBlock.id);\n        this.followingBlocks.set(followBlock.id, followBlock);\n        const result = followBlock.render();\n        return result;\n    }\n\n    renderFollowingBlockScan(stateKeys = [], renderBlock = () => '') {\n        if (!Array.isArray(stateKeys) || stateKeys.length === 0) {\n\n            return '';\n        }\n\n        if (typeof renderBlock !== 'function') {\n            return '';\n        }\n        let followingIndex = this.followingScanIndex;\n        let followingConfig = this.followingConfig[followingIndex];\n        if (!(followingConfig || (followingConfig.stateKeys == stateKeys) || (followingConfig.stateKeys.length == stateKeys.length && followingConfig.stateKeys.every(value => stateKeys.includes(value))))) {\n            return '';\n        }\n        const { id: renderID } = followingConfig;\n        const followBlock = new FollowingBlock({ renderID, stateKeys, renderBlock, engine: this, states: this.states, App: this.App });\n        followBlock.scan();\n        // this.followingBlocks.push(followBlock);\n        this.followingIDs.push(followBlock.id);\n        this.followingBlocks.set(followBlock.id, followBlock);\n        this.followingScanIndex++;\n        return ``;\n    }\n\n    __follow(stateKeys = [], renderBlock = () => '') {\n        return this.renderFollowingBlock(stateKeys, renderBlock);\n    }\n\n    __followScan(stateKeys = [], renderBlock = () => '') {\n        return this.renderFollowingBlockScan(stateKeys, renderBlock);\n    }\n\n\n    onFollowUpdating() {\n        this.stopEventListener();\n        setTimeout(() => {\n            if (!this.eventListenerStatus) {\n                this.startEventListener();\n            }\n        }, 10);\n    }\n\n    onFollowUpdated() {\n        if (!this.eventListenerStatus) {\n            this.startEventListener();\n        }\n    }\n\n    onStateChange(key, value, oldValue){\n        // Use Set to automatically handle duplicates\n        this.changedStateKeys.add(key);\n        \n        // Increment queue count (for tracking/statistics if needed)\n        this.changeStateQueueCount++;\n        \n        // Schedule batch processing using Promise for async execution\n        // Promise.resolve().then() runs in microtask queue, faster than setTimeout\n        // and works even when tab is hidden (unlike requestAnimationFrame)\n        // The _stateChangePending flag ensures only one Promise is scheduled at a time\n        // All subsequent changes will be batched into the Set\n        if(!this._stateChangePending){\n            this._stateChangePending = true;\n            \n            // Use Promise.resolve().then() for microtask queue (fastest, works in background)\n            Promise.resolve().then(() => {\n                // Clear pending flag before processing\n                this._stateChangePending = false;\n                this._processStateChanges();\n            });\n        }\n    }\n    \n    /**\n     * Process batched state changes efficiently\n     * @private\n     */\n    _processStateChanges(){\n        // Skip if view is destroyed\n        if(this.isDestroyed){\n            return;\n        }\n        \n        // Get all changed keys as array for processing\n        const changedKeys = Array.from(this.changedStateKeys);\n        \n        // Reset collections\n        this.changedStateKeys.clear();\n        this.changeStateQueueCount = 0;\n        \n        // If no keys changed, skip processing\n        if(changedKeys.length === 0){\n            return;\n        }\n        \n        // Process state changes - trigger view updates\n        // Already in microtask queue (from Promise.resolve().then()), so execute directly\n        this._notifyStateChanges(changedKeys);\n    }\n    \n    /**\n     * Notify views about state changes\n     * @param {Array<string>} changedKeys - Array of changed state keys\n     * @private\n     */\n    _notifyStateChanges(changedKeys){\n        // Trigger refresh for views that subscribe to these keys\n        // This will be called after all synchronous operations complete\n        if(this.isRefreshing){\n            return; // Prevent recursive refresh\n        }\n        \n        // Check if this view subscribes to any of the changed keys\n        if(this.subscribe && Array.isArray(this.subscribe) && this.subscribe.length > 0){\n            const shouldRefresh = changedKeys.some(key => this.subscribe.includes(key));\n            if(shouldRefresh){\n                this.refresh();\n            }\n        }\n        \n        // Notify children that subscribe to changed keys\n        if(this.children && this.children.length > 0){\n            this.children.forEach(childScope => {\n                if(childScope.subscribe && Array.isArray(childScope.subscribe)){\n                    const shouldRefresh = changedKeys.some(key => childScope.subscribe.includes(key));\n                    if(shouldRefresh && childScope.view){\n                        childScope.view._notifyStateChanges(changedKeys);\n                    }\n                }\n            });\n        }\n    }\n\n    onStateDataChanges(){\n        const data = this.stateChangeData;\n        this.stateChangeData = null;\n    }\n\n    /**\n     * Set App instance\n     * @param {Object} app - App instance\n     * @returns {AppViewEngine} This instance for chaining\n     */\n    setApp(app) {\n        this.App = app;\n        return this;\n    }\n\n    setUrlPath(urlPath) {\n        this.urlPath = urlPath;\n        return this;\n    }\n    /**\n     * Set super view\n     * @param {AppViewEngine} superView - Super view instance\n     * @returns {AppViewEngine} This instance for chaining\n     */\n    setSuperView(superView) {\n        this.superView = superView;\n        return this;\n    }\n\n    /**\n     * Set parent view\n     * @param {AppViewEngine} parent - Parent view instance\n     * @returns {AppViewEngine} This instance for chaining\n     */\n    setParent(parent) {\n        this.parent = parent;\n        return this;\n    }\n\n\n    setOriginalView(originalView) {\n        this.originalView = originalView;\n        this.originalViewPath = originalView.path;\n        this.originalViewId = originalView.id;\n        return this;\n    }\n\n    /**\n     * Add child view\n     * @param {ViewEngine} child - Child view to add\n     * @param {Object} data - Data to add to the child view\n     * @returns {ViewEngine} This instance for chaining\n     */\n    addChild(child, data = {}) {\n        let index = this.children.length;\n        let scope = {\n            name: child.path,\n            id: child.id,\n            index,\n            view: child,\n            data,\n            subscribe: [],\n        }\n        child.setScope(scope);\n        this.children.push(scope);\n        return this;\n    }\n\n\n    /**\n     * Remove child view\n     * @param {AppViewEngine} child - Child view to remove\n     * @returns {AppViewEngine} This instance for chaining\n     */\n    removeChild(child) {\n        this.children = this.children.filter(c => c !== child);\n        return this;\n    }\n\n    /**\n     * Update data\n     * @param {Object} __data - New data to merge\n     * @returns {AppViewEngine} This instance for chaining\n     */\n    updateData(__data = {}) {\n        this.data = { ...this.data, ...__data };\n        // this.states.__reset();\n\n        return this;\n    }\n\n    updateVariableData(data = {}) {\n        if(typeof this.config.updateVariableData === 'function'){\n            this.config.updateVariableData.call(this, data);\n            this.isCommitedConstructorData = true;\n        }\n\n        return this;\n    }\n\n    updateVariableItem(key, value) {\n        if(typeof this.config.updateVariableItemData === 'function'){\n            this.config.updateVariableItemData.call(this, key, value);\n        }\n        return this;\n    }\n\n    /**\n     * Set isSuperView flag\n     * @param {boolean} isSuperView - Super view flag\n     * @returns {AppViewEngine} This instance for chaining\n     */\n    setIsSuperView(isSuperView) {\n        this.isSuperView = isSuperView;\n        return this;\n    }\n\n    /** Events */\n\n\n    /**\n     * Reset view engine\n     */\n    reset() {\n        // Implementation placeholder\n    }\n\n}","/**\n * API Module\n * ES6 Module for Blade Compiler\n */\n\n// Import App from global init\nimport { HttpService } from './services/HttpService.js';\n\nexport class AppAPI {\n    constructor() {\n        this.http = new HttpService();\n        this.http.setHeader('Content-Type', 'application/json');\n        this.http.setHeader('Accept', 'application/json');\n        this.http.setHeader('X-Requested-With', 'XMLHttpRequest');\n        // Conditional document access for Node.js compatibility\n        if (typeof document !== 'undefined') {\n            const csrfToken = document.querySelector('meta[name=\"csrf-token\"]');\n            if (csrfToken) {\n                this.http.setHeader('X-CSRF-TOKEN', csrfToken.getAttribute('content'));\n            }\n        }\n        this.http.setHeader('X-DATA-TYPE', 'json');\n        this.endpoints = typeof window !== 'undefined' ? window.APP_CONFIGS?.api?.endpoints || {} : {};\n    }\n    async getViewData(uri) {\n        try {\n            const response = await this.http.get(uri).then(response => {\n                return response.status ? response.data : {};\n            }).catch(error => {\n                console.error(' AppAPI: Error getting view data:', error);\n                return {};\n            });\n\n            return response;\n        } catch (error) {\n            console.error(' AppAPI: Error getting view data:', error);\n            return {};\n        }\n\n    }\n    async getSystemConfig() {\n        return {};\n        return this.http.get('/api/system/config').then(response => {\n            return response.status ? response.data : {};\n        }).catch(error => {\n            console.error(' AppAPI: Error getting system config:', error);\n            return {};\n        });\n    }\n    async getSystemData() {\n        let endpoint = this.endpoints?.system?.data;\n        if (!endpoint) {\n            return {};\n        }\n        return this.http.get(endpoint).then(response => {\n            return response.status ? response.data : {};\n        }).catch(error => {\n            console.error(' AppAPI: Error getting system data:', error);\n            return {};\n        });\n    }\n\n    async getURIDAta() {\n        const uri = typeof window !== 'undefined' ? window.location.pathname + window.location.search : '/';\n        return this.getViewData(uri);\n    }\n\n}\n\nexport const API = new AppAPI();\n\nexport default API;","/**\n * router Module\n * ES6 Module for Blade Compiler\n */\n\n// import { Application } from \"../app.js\";\nimport { ViewEngine } from \"./ViewEngine.js\";\n\nclass ActiveRoute {\n    constructor(route, urlPath, params, query = {}, fragment = {}) {\n        this.$route = route;\n        this.$urlPath = urlPath;\n        this.$params = params || {};\n        this.$query = query || {};\n        this.$fragment = fragment || {};\n        this.$paramKeys = [...Object.keys(params || {})];\n        Object.keys(params).forEach(key => {\n            Object.defineProperty(this, key, {\n                get: () => this.$params[key],\n                set: (value) => {\n                    this.$params[key] = value;\n                },\n                enumerable: true,\n                configurable: false,\n            });\n        });\n    }\n\n\n\n    getPath() {\n        return this.$urlPath || null;\n    }\n    getUrlPath() {\n        return this.$urlPath || null;\n    }\n\n    getParams() {\n        return this.$params || {};\n    }\n    getParam(name) {\n        return this.$params[name] || null;\n    }\n    getQuery() {\n        return this.$query || {};\n    }\n    getFragment() {\n        return this.$fragment || {};\n    }\n}\n\nexport class Router {\n    static activeRoute = null;\n    static containers = {};\n    constructor(App = null) {\n        /**\n         * @type {Application}\n         */\n        this.App = App;\n        this.routes = [];\n        this.currentRoute = null;\n        this.mode = 'history';\n        this.base = '';\n        this._beforeEach = null;\n        this._afterEach = null;\n        this.defaultRoute = '/';\n\n        // Bind methods\n        this.handleRoute = this.handleRoute.bind(this);\n        this.handlePopState = this.handlePopState.bind(this);\n\n        /**\n         * @type {Object<string, {path: string, view: string, params: object}>}\n         */\n        this.routeConfigs = {};\n        this.currentUri = window.location.pathname + window.location.search;\n    }\n\n    setApp(app) {\n        this.App = app;\n        return this;\n    }\n\n    addRouteConfig(routeConfig) {\n        this.routeConfigs[routeConfig.name] = routeConfig;\n    }\n\n    setAllRoutes(routes) {\n        for (const route of routes) {\n            this.addRouteConfig(route);\n        }\n    }\n\n\n    getURL(name, params = {}) {\n        const routeConfig = this.routeConfigs[name];\n        if (!routeConfig) {\n            return null;\n        }\n        let url = this.generateUrl(routeConfig.path, params);\n        if (!(url.startsWith('/') || url.startsWith('http:') || url.startsWith('https:'))) {\n            url = this.base + url;\n        }\n        return url;\n    }\n\n    addRoute(path, view, options = {}) {\n        this.routes.push({\n            path: this.normalizePath(path),\n            view: view,\n            options: options\n        });\n    }\n\n    setMode(mode) {\n        this.mode = mode;\n    }\n\n    setBase(base) {\n        this.base = base;\n    }\n\n    setDefaultRoute(route) {\n        this.defaultRoute = route;\n    }\n\n    beforeEach(callback) {\n        this._beforeEach = callback;\n    }\n\n    afterEach(callback) {\n        this._afterEach = callback;\n    }\n\n    normalizePath(path) {\n        // Remove leading slash if present, then add it back to ensure consistency\n        let normalized = path.startsWith('/') ? path : '/' + path;\n\n        // Remove trailing slash except for root path\n        if (normalized.length > 1 && normalized.endsWith('/')) {\n            normalized = normalized.slice(0, -1);\n        }\n\n        // Handle empty path as root\n        if (normalized === '') {\n            normalized = '/';\n        }\n\n        return normalized;\n    }\n\n    /**\n     * So snh xem chui str c khp vi format khng.\n     * @param {string} str - Chui u vo cn kim tra\n     * @param {string} format - nh dng, v d: {abc}, {abc}-def, demo-{key}, test-demo-{key}.xyz, ...\n     * @returns {boolean} true nu khp, false nu khng\n     */\n    matchFormat(str, format) {\n        // Chuyn format thnh regex\n        // Thay th {param} thnh ([^\\/\\-.]+)  match 1 on khng cha /, -, .\n        // Gi li cc k t c bit nh -, ., ...\n        let regexStr = format.replace(/([.*+?^=!:${}()|\\[\\]\\/\\\\])/g, '\\\\$1'); // escape k t c bit\n        regexStr = regexStr.replace(/\\{[a-zA-Z0-9_]+\\}/g, '([^\\\\/\\\\-.]+)');\n        // Cho php match ton b chui\n        regexStr = '^' + regexStr + '$';\n        const regex = new RegExp(regexStr);\n        return regex.test(str);\n    }\n\n    hasParameter(path) {\n        return /\\{[a-zA-Z0-9_]+\\}/.test(path);\n    }\n\n    isAnyParameter(path) {\n        return path.includes('*') || path.toLowerCase() === '{any}';\n    }\n\n    /**\n     * Ly tn tham s u tin trong path c format {param}\n     * m bo hot ng trn tt c cc trnh duyt (khng dng lookbehind/lookahead)\n     * @param {string} format - Chui path, v d: \"abc-{name}.html\"\n     * @returns {string|null} - Tr v tn param u tin nu c, ngc li tr v null\n     */\n    getParameterName(format) {\n        // Dng RegExp n gin, khng lookbehind/lookahead  tng thch trnh duyt c\n        var regex = /\\{([a-zA-Z0-9_]+)\\}/;\n        var match = regex.exec(format);\n        if (match && match[1]) {\n            return match[1];\n        }\n        return null;\n    }\n\n    /**\n     * Ly gi tr tham s u tin trong path theo format {param}\n     * @param {string} format - Chui format, v d: \"{id}\"\n     * @param {string} path - Chui path thc t, v d: \"1\"\n     * @returns {string|null} - Gi tr param nu tm thy, ngc li tr v null\n     */\n    getParameterValue(format, path) {\n        if (typeof path !== 'string' || typeof format !== 'string') return null;\n\n        // Nu format ch l {param} th tr v path\n        if (format.match(/^\\{[a-zA-Z0-9_]+\\}$/)) {\n            return path;\n        }\n\n        // Escape cc k t c bit trong format (tr {param})\n        let regexStr = format.replace(/([.*+?^=!:${}()|\\[\\]\\/\\\\])/g, '\\\\$1');\n        // Thay th {param} thnh nhm bt\n        regexStr = regexStr.replace(/\\{[a-zA-Z0-9_]+\\}/g, '([^\\\\/\\\\-.]+)');\n        // To regex\n        const regex = new RegExp('^' + regexStr + '$');\n        const match = regex.exec(path);\n        if (match && match[1]) {\n            return match[1];\n        }\n        return null;\n    }\n\n    getAnyParameterValue(format, path) {\n        // Nu format cha du * th xem nh l {any}\n        if (typeof format === 'string' && format.includes('*')) {\n            format = format.replace(/\\*/g, '{any}');\n        }\n        if (typeof path !== 'string' || typeof format !== 'string') return null;\n        // Escape cc k t c bit trong format (tr {param})\n        let regexStr = format.replace(/([.*+?^=!:${}()|\\[\\]\\/\\\\])/g, '\\\\$1');\n        // Thay th tng {param} thnh nhm bt\n        regexStr = regexStr.replace(/\\{[a-zA-Z0-9_]+\\}/g, '([^\\\\/\\\\-.]+)');\n        const regex = new RegExp('^' + regexStr + '$');\n        const valueMatch = regex.exec(path);\n        if (!valueMatch) return null;\n        // Tr v gi tr u tin (hoc null nu khng c)\n        return valueMatch[1] || null;\n    }\n\n    /**\n     * Check if a route with parameters matches the given path\n     * @param {object<{path: string, view: string, params: object}>} route - The route pattern (e.g., \"/web/users/{id}\")\n     * @param {string} urlPath - The actual path to match (e.g., \"/web/users/1\")\n     * @returns {Object|null} - Returns {params} if match, null if no match\n     */\n    checkParameterRoute(route, urlPath) {\n        const routePathParts = this.App.Helper.trim(route.path, '/').split('/');\n        const urlPathParts = this.App.Helper.trim(urlPath, '/').split('/');\n        // Must have same number of segments\n        if (routePathParts.length !== urlPathParts.length) {\n            console.log(' Different number of segments');\n            return null;\n        }\n\n        const lastRoutePathIndex = routePathParts.length - 1;\n        const params = {};\n\n\n\n\n        for (let i = 0; i < routePathParts.length; i++) {\n            const routePathPart = routePathParts[i];\n            const urlPathPart = urlPathParts[i];\n\n            if (this.isAnyParameter(routePathPart)) {\n                const paramValue = this.getAnyParameterValue(routePathPart, urlPathPart);\n                params.any = paramValue;\n                if (i === lastRoutePathIndex && i === 0) {\n                    return params;\n                }\n            } else if (this.hasParameter(routePathPart)) {\n                const paramName = this.getParameterName(routePathPart);\n                const paramValue = this.getParameterValue(routePathPart, urlPathPart);\n                if (paramValue === null) {\n                    console.log(' Parameter value is null');\n                    return null;\n                }\n                params[paramName] = paramValue;\n            }\n            else {\n                // Regular route part - exact match required\n                if (routePathPart !== urlPathPart) {\n                    console.log(' Exact match failed');\n                    return null;\n                }\n            }\n        }\n\n        return params;\n    }\n\n    matchRoute(path) {\n        const normalizedPath = this.normalizePath(path);\n\n        // Process routes in order - first match wins\n        for (const route of this.routes) {\n            const routePath = route.path;\n\n            // Check if route has parameters\n            const hasParameters = routePath.split('/').some(part => this.hasParameter(part) || this.isAnyParameter(part));\n\n            if (hasParameters) {\n                // Handle parameter route\n                const params = this.checkParameterRoute(route, normalizedPath);\n                if (params !== null) {\n                    return { route, params, path: normalizedPath };\n                }\n            } else {\n                // Handle exact route match\n                if (routePath === normalizedPath) {\n                    return { route, params: {}, path: normalizedPath };\n                }\n            }\n        }\n\n        return null;\n    }\n\n    async handleRoute(path, ignoreSetActiveRoute = false) {\n        // Remove query string for route matching\n        const pathForMatching = path.split('?')[0];\n        const match = this.matchRoute(pathForMatching);\n\n        if (!match) {\n            console.warn(`No route found for: ${path}`);\n            return;\n        }\n\n        const { route, params } = match;\n\n        // Call beforeEach hook\n        if (this._beforeEach) {\n            const result = await this._beforeEach(route, params);\n            if (result === false) {\n                return; // Navigation cancelled\n            }\n        }\n        const URLParts = Router.getUrlParts();\n        const query = URLParts.query;\n        const fragment = URLParts.hash;\n\n        if (!ignoreSetActiveRoute) {\n            Router.addActiveRoute(route, match.path, params, query, fragment);\n        }\n\n        // Update current route\n        this.currentRoute = { ...route, $params: params, $query: query, $fragment: fragment, $urlPath: match.path };\n\n        // Render view\n        if (this.App.View && (route.view || route.component)) {\n            this.App.View.mountView(route.view || route.component, params, Router.getActiveRoute());\n        }\n\n        // Call afterEach hook\n        if (this._afterEach) {\n            this._afterEach(route, params);\n        }\n    }\n\n\n    /**\n     * Hydrate server-rendered views\n     * Scans SSR HTML and attaches JavaScript behavior without re-rendering\n     *\n     * Flow:\n     * 1. Get active route (from Router.activeRoute)\n     * 2. Call beforeEach hook\n     * 3. Call View.scanView() to:\n     *    - Scan page view + all parent layouts\n     *    - Setup view hierarchy (virtualRender)\n     *    - Attach event handlers to existing DOM\n     *    - Setup state subscriptions\n     *    - Mount all views bottom-up\n     * 4. Call afterEach hook\n     * 5. Mark hydration complete\n     */\n    async hydrateViews() {\n        console.log(' Router.hydrateViews: Starting hydration of server-rendered views...');\n\n        if (!this.App?.View) {\n            console.error(' Router.hydrateViews: App.View not available');\n            return;\n        }\n\n        // Get active route info\n        const activeRoute = Router.activeRoute || this.currentRoute;\n\n        if (!activeRoute) {\n            console.error(' Router.hydrateViews: No active route found');\n            return;\n        }\n\n        const { $route: route, $params: params, $urlPath: urlPath, $query: query, $fragment: fragment } = activeRoute;\n\n        // Call beforeEach hook (if exists)\n        if (this._beforeEach) {\n            const result = await this._beforeEach(route, params, urlPath);\n            if (result === false) {\n                console.log(' Router.hydrateViews: Cancelled by beforeEach hook');\n                return;\n            }\n        }\n\n        // Handle view hydration\n        if (route.view || route.component) {\n            try {\n                const viewName = route.view || route.component;\n\n                this.App.View.mountViewScan(viewName, params, activeRoute);\n                // Call afterEach hook\n                if (this._afterEach) {\n                    this._afterEach(route, params);\n                }\n\n\n            } catch (error) {\n                console.error(' Router.hydrateViews: Error during hydration:', error);\n            }\n        }\n    }\n\n\n    handlePopState(event) {\n        const path = window.location.pathname + window.location.search;\n        this.handleRoute(path);\n    }\n\n    navigate(path) {\n\n        if (this.mode === 'history') {\n            window.history.pushState({}, '', path);\n            try {\n                this.handleRoute(path);\n                this.currentUri = path;\n            } catch (error) {\n                console.error(' Router.navigate handleRoute error:', error);\n            }\n        } else {\n            // Hash mode\n            window.location.hash = path;\n            try {\n                this.handleRoute(path);\n                this.currentUri = path;\n            } catch (error) {\n                console.error(' Router.navigate handleRoute (hash mode) error:', error);\n            }\n        }\n    }\n\n    /**\n     * Generate URL with file extension\n     * @param {string} route - Route pattern (e.g., '/users/{id}')\n     * @param {object} params - Parameters to fill in\n     * @param {string} extension - File extension (e.g., '.html', '.php')\n     * @returns {string} Generated URL\n     */\n    generateUrl(route, params = {}, extension = '') {\n        let url = route;\n\n        // Replace parameters\n        for (const [key, value] of Object.entries(params)) {\n            url = url.replace(`{${key}}`, value);\n        }\n\n        // Add extension if provided\n        if (extension && !url.endsWith(extension)) {\n            url += extension;\n        }\n\n        return url;\n    }\n\n    /**\n     * Navigate to route with file extension\n     * @param {string} route - Route pattern\n     * @param {object} params - Parameters\n     * @param {string} extension - File extension\n     */\n    navigateTo(route, params = {}, extension = '') {\n        const url = this.generateUrl(route, params, extension);\n        this.navigate(url);\n    }\n\n    start(skipInitial = false) {\n        // Detect if page has server-rendered content\n        const isServerRendered = this.App?.View?.detectServerRendered?.() || false;\n        const URLParts = Router.getUrlParts();\n        const initialPath = this.mode === 'history' ? (window.location.pathname + window.location.search) : (window.location.hash.substring(1) || this.defaultRoute);\n\n        console.log(' Router.start: Detected SSR:', isServerRendered);\n\n        this.setActiveRouteForCurrentPath(initialPath);\n\n        // Add event listeners\n        if (this.mode === 'history') {\n            window.addEventListener('popstate', this.handlePopState);\n        } else {\n            window.addEventListener('hashchange', this.handlePopState);\n        }\n\n        // Choose initial rendering strategy\n        if (isServerRendered) {\n            // SSR: Hydrate existing HTML\n            console.log(' Router.start: Starting SSR hydration...');\n            this.hydrateViews();\n        } else if (!skipInitial) {\n            // CSR: Render from scratch\n            console.log(' Router.start: Starting CSR rendering...');\n            this.handleRoute(initialPath);\n        } else {\n            console.log(' Router.start: Skipping initial route handling' + (this.mode === 'history' ? '' : '( hash)') + ' but activeRoute is set');\n        }\n\n        this.setupAutoNavigation();\n\n    }\n\n    stop() {\n        if (this.mode === 'history') {\n            window.removeEventListener('popstate', this.handlePopState);\n        } else {\n            window.removeEventListener('hashchange', this.handlePopState);\n        }\n        // Remove auto-navigation listener\n        document.removeEventListener('click', this._autoNavHandler);\n    }\n\n    /**\n     * Set activeRoute for current path without rendering view\n     * Used when starting router with skipInitial = true\n     */\n    setActiveRouteForCurrentPath(path) {\n        // console.log(' setActiveRouteForCurrentPath called with:', path);\n        // Remove query string for route matching\n        const pathForMatching = path.split('?')[0];\n        const match = this.matchRoute(pathForMatching);\n\n        if (match) {\n            const { route, params } = match;\n            const URLParts = Router.getUrlParts();\n            const query = URLParts.query;\n            const fragment = URLParts.hash;\n            // console.log(' Setting activeRoute for current path:', route.path, 'with params:', params);\n\n            // Set activeRoute without rendering\n            Router.addActiveRoute(route, match.path, params, query, fragment);\n            this.currentRoute = { ...route, $params: params, $query: query, $fragment: fragment, $urlPath: match.path };\n\n            // console.log(' activeRoute set successfully:', Router.activeRoute);\n        } else {\n            console.log(' No matching route found for current path:', path);\n        }\n    }\n\n    /**\n     * Setup auto-detect navigation for internal links\n     */\n    setupAutoNavigation() {\n        console.log(' setupAutoNavigation called');\n        // Store reference to handler for removal\n        this._autoNavHandler = this.handleAutoNavigation.bind(this);\n        document.addEventListener('click', this._autoNavHandler);\n        console.log(' Auto-navigation setup complete - event listener added');\n    }\n\n    /**\n     * Handle auto-detect navigation\n     * @param {Event} e - Click event\n     */\n    handleAutoNavigation(e) {\n        // console.log(' handleAutoNavigation called for:', e.target);\n\n        // Check for data-nav-link attribute first (highest priority)\n        const oneNavElement = e.target.closest('[data-nav-link]');\n\n        if (oneNavElement) {\n            // Check if navigation is disabled\n            if (oneNavElement.hasAttribute('data-nav-disabled')) {\n                console.log(' Skipping disabled data-nav-link element');\n                return;\n            }\n\n            const navPath = oneNavElement.getAttribute('data-nav-link');\n            console.log(' navPath:', navPath);\n\n            if (navPath && navPath.trim() !== '') {\n                console.log(' Auto-navigating via data-nav-link attribute:', navPath);\n                e.preventDefault();\n                if (navPath === this.currentUri) {\n                    console.log(' Same path - no navigation needed:', navPath);\n                    return;\n                }\n                this.navigate(navPath);\n                return;\n            }\n        }\n\n        // Fallback to traditional <a> tag handling\n        const link = e.target.closest('a[href]');\n        if (!link) return;\n\n        // Skip if link has target=\"_blank\"\n        if (link.target === '_blank') {\n            console.log(' Skipping external link with target=\"_blank\":', link.href);\n            return;\n        }\n\n        // Skip if link has data-nav=\"disabled\" or on-nav=\"false\"\n        if (link.dataset.nav === 'disabled' || link.getAttribute('data-nav') === 'false') {\n            console.log(' Skipping disabled link:', link.href);\n            return;\n        }\n\n        // Skip if link has data-nav=\"false\" (explicitly disabled)\n        if (link.dataset.nav === 'false') {\n            console.log(' Skipping explicitly disabled link:', link.href);\n            return;\n        }\n\n        // Skip mailto, tel, and other special protocols\n        if (link.href.startsWith('mailto:') || link.href.startsWith('tel:') || link.href.startsWith('javascript:')) {\n            console.log(' Skipping special protocol link:', link.href);\n            return;\n        }\n\n        const href = link.href;\n\n        // Check if it's an external URL (different domain)\n        try {\n            const linkUrl = new URL(href);\n            const currentUrl = new URL(window.location.href);\n\n            // If different host, skip (external link)\n            if (linkUrl.host !== currentUrl.host) {\n                console.log(' Skipping external domain link:', href);\n                return;\n            }\n        } catch (error) {\n            // If URL parsing fails, treat as internal link\n            console.log(' URL parsing failed, treating as internal:', href);\n        }\n\n        // Check if it's a full URL with same domain (and not same path - already checked above)\n        if (href.startsWith('http://') || href.startsWith('https://')) {\n            try {\n                const linkUrl = new URL(href);\n                const currentUrl = new URL(window.location.href);\n\n                if (linkUrl.host === currentUrl.host) {\n                    // Same domain, extract path with query string for navigation\n                    const path = linkUrl.pathname + linkUrl.search;\n                    console.log(' Auto-navigating to same domain URL:', path);\n                    e.preventDefault();\n                    if (path === this.currentUri) {\n                        console.log(' Same path - no navigation needed:', path);\n                        return;\n                    }\n                    this.navigate(path);\n                    return;\n                }\n            } catch (error) {\n                console.log(' URL parsing failed for full URL:', href);\n            }\n        }\n\n        // Handle relative URLs (and not same path - already checked above)\n        if (href && !href.startsWith('http') && !href.startsWith('//')) {\n            console.log(' Auto-navigating to relative URL:', href);\n            e.preventDefault();\n            if (href === this.currentUri) {\n                console.log(' Same path - no navigation needed:', href);\n                return;\n            }\n            this.navigate(href);\n            return;\n        }\n\n        // If we get here, it's likely an external link or unsupported format\n        console.log(' Skipping unsupported link format:', href);\n    }\n    static getUrlParts() {\n        const { location } = window;\n        const { search, hash, pathname } = location;\n        return {\n            url: location.href,\n            protocol: location.protocol,\n            search: search.startsWith('?') ? search.substring(1) : search,\n            path: pathname,\n            query: Object.fromEntries(new URLSearchParams(search)),\n            hash: hash.startsWith('#') ? hash.substring(1) : hash\n        };\n    }\n\n    static addActiveRoute(route, urlPath, params, query = {}, fragment = null) {\n        if (!route.path) {\n            return;\n        }\n        if (!Router.containers[route.path]) {\n            Router.containers[route.path] = new ActiveRoute(route, urlPath, params, query, fragment);\n            Router.activeRoute = Router.containers[route.path];\n        } else {\n            Router.containers[route.path].$urlPath = urlPath;\n            Router.containers[route.path].$params = params;\n            Router.containers[route.path].$query = query;\n            Router.containers[route.path].$fragment = fragment;\n            Router.activeRoute = Router.containers[route.path];\n        }\n    }\n\n    static getCachedRoute(routePath) {\n        return Router.containers[routePath] || null;\n    }\n\n    static getCurrentRoute() {\n        return Router.activeRoute || null;\n    }\n    static getActiveRoute() {\n        return Router.activeRoute || null;\n    }\n    static getCurrentPath() {\n        return window.location.pathname;\n    }\n    static getCurrentUri() {\n        return this.mode === 'history' ? Router.getCurrentPath() : Router.getCurrentHash();\n    }\n    static getCurrentHash() {\n        const fragmentString = window.location.hash.substring(1) || '';\n        return fragmentString;\n    }\n    static getCurrentUrl() {\n        return this.mode === 'history' ? Router.getCurrentPath() + window.location.search : Router.getCurrentHash();\n    }\n    static getCurrentQuery() {\n        const query = Object.fromEntries(new URLSearchParams(window.location.search));\n        return query;\n    }\n    static getCurrentFragment() {\n        const fragmentString = window.location.hash.substring(1) || '';\n        return fragmentString;\n    }\n}\n\nexport default Router;\n\nexport const useRoute = () => Router.getCurrentRoute();\nexport const useParams = () => useRoute()?.getParams() || {};\nexport const useQuery = () => Router.getCurrentQuery() || {};\nexport const useFragment = () => Router.getCurrentFragment() || {};","import logger from \"./services/LoggerService.js\";\n\nexport class ViewState {\n    constructor(view) {\n        // Private properties using naming convention for browser compatibility\n        this._viewRef = view;\n        this._states = [];\n        this._stateIndex = 0;\n        this._canUpdateStateByKey = true;\n        /**\n         * @type {Map<string, Array<Function>>}\n         */\n        this.__listeners = new Map();\n\n        /**\n         * @type {Array<string>}\n         */\n        this.__ownProperties = ['_states', '_stateIndex', '_stateMap', '_canUpdateStateByKey', '_viewRef', '__listeners', '__ownProperties', '__ownMethods'];\n        /**\n         * @type {Array<string>}\n         */\n        this.__ownMethods = ['__commitStateChange', '__setState', '__useState', '__updateStateByKey', '__register', '__lockUpdateRealState', '__subscribe', '__toJSON', 'toJSON', 'toString'];\n\n        Object.defineProperty(this, 'on', {\n            value: (key, callback) => this.__subscribe(key, callback),\n            writable: true,\n            configurable: true,\n            enumerable: false,\n        });\n        Object.defineProperty(this, 'off', {\n            value: (key, callback) => this.__unsubscribe(key, callback),\n            writable: true,\n            configurable: true,\n            enumerable: false,\n        });\n    }\n    // Define public methods using Object.defineProperties for backward compatibility\n\n    // Private methods using naming convention\n    __commitStateChange(index, oldValue, stateKey = null) {\n        // Implementation placeholder\n        let key = stateKey?stateKey:index;\n        const listeners = this.__listeners.get(this._stateMap[index]);\n        if (listeners) {\n            listeners.forEach(callback => callback(this._states[index][0], oldValue));\n        }\n        if(this._viewRef){\n\n        }\n\n    }\n\n    /**\n     * set state ni b\n     * @param {number} index index\n     * @param {*} value gi tr \n     * @param {function} setValue hm set gi tr\n     * @param {string} key key ca state\n     * @returns {[*, function, string]}\n     */\n    __setState(index, value, setValue = () => { }, key = null) {\n        this._states[index] = [value, setValue, key??index];\n        return [value, setValue, key??index];\n    }\n\n    /**\n     * tng t useState\n     * @param {*} value gi tr ca state\n     * @param {string} key key ca state (khng bt buc)\n     * @returns {Array<[*, function, string]>}\n     */\n    __useState(value, key = null) {\n        const index = this._stateIndex++;\n        const stateKey = key ?? index;\n        const setValue = (value) => {\n            const oldValue = this._states[index][0];\n            this._states[index][0] = value;\n            this.__commitStateChange(index, oldValue, stateKey);\n        };\n        this.__setState(index, value, setValue, stateKey);\n        \n        if (!this.__ownProperties.includes(stateKey) && !this.__ownMethods.includes(stateKey)) {\n\n            Object.defineProperty(this, stateKey, {\n                get: () => {\n                    return this._states[index][0];\n                },\n                set: (value) => {\n                    logger.log(\"Bn khng th thit lp gi tr cho \" + stateKey + \" theo cch ny\");\n                },\n                configurable: false,\n                enumerable: true,\n            });\n\n        }\n        return [value, setValue, stateKey];\n    }\n\n    /**\n     * cp nht state value theo key\n     * @param {string} key key ca state\n     * @param {*} value gi tr\n     * @returns {*}\n     */\n    __updateStateByKey(key, value) {\n        const index = this._states.findIndex(state => state[2] === key);\n        if (index !== -1) {\n            if (!this._canUpdateStateByKey) {\n                return this._states[index][0];\n            }\n\n            this._states[index][0] = value;\n            this.__commitStateChange(index);\n        }\n        return value;\n    }\n\n    /**\n     * ng k key - value cho state - tr v hm setValue cho key tng ng\n     * @param {string} key key ca state\n     * @param {*} value gi tr\n     * @returns {function}\n     */\n    __register(key, value) {\n        return this.__useState(value, key)[1];\n    }\n\n    __lockUpdateRealState() {\n        this._canUpdateStateByKey = false;\n    }\n\n    __subscribe(key, callback) {\n        if (typeof key !== 'string' || this.__ownProperties.includes(key) || this.__ownMethods.includes(key)) {\n            return false\n        }\n        if (callback && typeof callback !== 'function') {\n            throw new Error('Callback must be a function');\n        }\n        if (!this.__listeners.has(key)) {\n            this.__listeners.set(key, []);\n        }\n        this.__listeners.get(key).push(callback);\n        let index = this.__listeners.get(key).length - 1;\n        return () => {\n            this.__listeners.get(key).splice(index, 1);\n            if (this.__listeners.get(key).length === 0) {\n                this.__listeners.delete(key);\n            }\n        };\n    }\n\n    __unsubscribe(key, callback = null) {\n        if (typeof key !== 'string' || this.__ownProperties.includes(key) || this.__ownMethods.includes(key)) {\n            return;\n        }\n        if (callback && typeof callback !== 'function') {\n            return;\n        }\n        if (callback) {\n            let index = this.__listeners.get(key).indexOf(callback);\n            if (index !== -1) {\n                this.__listeners.get(key).splice(index, 1);\n                if (this.__listeners.get(key).length === 0) {\n                    this.__listeners.delete(key);\n                }\n            }\n        } else {\n            this.__listeners.delete(key);\n        }\n    }\n\n\n    __reset() {\n        this._stateIndex = 0;\n        this._canUpdateStateByKey = true;\n        this.__listeners.clear();\n    }\n\n\n\n\n\n\n\n    __toJSON() {\n        const data = {};\n        this._states.forEach((state, index) => {\n            data[this._stateMap[index]] = state[0];\n        });\n        return data;\n    }\n\n    // Public methods\n    toJSON() {\n        return this.__toJSON();\n    }\n\n    toString() {\n        return JSON.stringify(this.__toJSON());\n    }\n\n\n\n\n}\n\n","/**\n * Class qun l vic parse v tm kim cc cp comment tags\n * H tr tm kim theo pattern vi wildcard (*)\n * \n * @example\n * const parser = new TemplateDetectorService(document.body);\n * const pairs = parser.find('one-template:*');\n * parser.display(pairs);\n */\nexport class TemplateDetectorService {\n    /**\n     * Khi to parser vi element gc\n     * @param {Element} rootElement - Element gc  tm kim (mc nh: document.body)\n     */\n    constructor(rootElement = document.body) {\n        this.rootElement = rootElement;\n        this.cachedComments = null;\n    }\n\n    /**\n     * t element gc mi\n     * @param {Element} element - Element gc mi\n     */\n    setRootElement(element) {\n        this.rootElement = element;\n        this.cachedComments = null;\n        return this;\n    }\n\n    /**\n     * Ly tt c comment nodes t rootElement\n     * @param {boolean} useCache - S dng cache hay khng\n     * @returns {Array<Comment>}\n     */\n    getAllComments(useCache = true) {\n        if (useCache && this.cachedComments) {\n            return this.cachedComments;\n        }\n\n        const comments = [];\n        const walker = document.createTreeWalker(\n            this.rootElement,\n            NodeFilter.SHOW_COMMENT,\n            null,\n            false\n        );\n\n        let node;\n        while (node = walker.nextNode()) {\n            comments.push(node);\n        }\n\n        if (useCache) {\n            this.cachedComments = comments;\n        }\n\n        return comments;\n    }\n\n    /**\n     * Parse mt comment node  ly thng tin\n     * @param {Comment} commentNode - Comment node cn parse\n     * @returns {Object|null} - Thng tin tag hoc null nu khng phi tag hp l\n     */\n    parseComment(commentNode) {\n        const text = commentNode.nodeValue.trim();\n\n        // Pattern tng qut: [prefix:name] hoc [prefix]\n        // Kim tra tag m: <!-- [prefix:name attribute=\"...\"] -->\n        const openMatch = text.match(/^\\[([^\\/\\]]+?)(?:\\s+(.+))?\\]$/);\n        if (openMatch) {\n            const fullName = openMatch[1];\n            const attributes = {};\n\n            if (openMatch[2]) {\n                // Parse cc attributes nh subscribe=\"userState,items\"\n                const attrMatch = openMatch[2].match(/(\\w+)=\"([^\"]+)\"/g);\n                if (attrMatch) {\n                    attrMatch.forEach(attr => {\n                        const [key, value] = attr.split('=');\n                        attributes[key] = value.replace(/\"/g, '');\n                    });\n                }\n            }\n\n            return {\n                type: 'open',\n                fullName: fullName,\n                attributes: attributes,\n                node: commentNode\n            };\n        }\n\n        // Kim tra tag ng: <!-- [/prefix:name] -->\n        const closeMatch = text.match(/^\\[\\/([^\\/\\]]+?)\\]$/);\n        if (closeMatch) {\n            return {\n                type: 'close',\n                fullName: closeMatch[1],\n                node: commentNode\n            };\n        }\n\n        return null;\n    }\n\n    /**\n     * Ly tt c cc siblings gia hai node (cng parent)\n     * @param {Node} startNode - Node bt u\n     * @param {Node} endNode - Node kt thc\n     * @returns {Array<Node>|null} - Mng nodes hoc null nu khng cng parent\n     */\n    getNodesBetween(startNode, endNode) {\n        // Kim tra xem c cng parent khng\n        if (startNode.parentNode !== endNode.parentNode) {\n            return null;\n        }\n\n        const nodes = [];\n        let current = startNode.nextSibling;\n\n        while (current && current !== endNode) {\n            nodes.push(current);\n            current = current.nextSibling;\n        }\n\n        return nodes;\n    }\n\n    /**\n     * Chuyn i pattern thnh regex\n     * @param {string} pattern - Pattern vi wildcard (*)\n     * @returns {RegExp}\n     * \n     * @example\n     * patternToRegex('*:*')              // Match tt c\n     * patternToRegex('one-*')            // Match \"one-template\", \"one-component\"\n     * patternToRegex('one-template:*')   // Match \"one-template:profile\", etc.\n     */\n    patternToRegex(pattern) {\n        if (!pattern || pattern === '*' || pattern === '*:*') {\n            return /.*/;\n        }\n\n        // Escape cc k t c bit trong regex (tr *)\n        let regexStr = pattern\n            .replace(/[.+?^${}()|[\\]\\\\]/g, '\\\\$&')  // Escape regex special chars\n            .replace(/\\*/g, '.*');                    // Convert * thnh .*\n\n        // Thm ^ v $  match chnh xc ton b string\n        regexStr = '^' + regexStr + '$';\n\n        return new RegExp(regexStr);\n    }\n\n    /**\n     * Kim tra xem mt tn c khp vi pattern khng\n     * @param {string} fullName - Tn y  ca tag\n     * @param {string} pattern - Pattern  so khp\n     * @returns {boolean}\n     */\n    matchPattern(fullName, pattern) {\n        const regex = this.patternToRegex(pattern);\n        return regex.test(fullName);\n    }\n\n    /**\n     * Tm tt c cc cp tags theo pattern\n     * @param {string} pattern - Pattern  lc (mc nh: '*:*')\n     * @param {Object} options - Ty chn b sung\n     * @param {boolean} options.useCache - S dng cache comments\n     * @returns {Array<Object>} - Mng cc cp tags tm c\n     * \n     * @example\n     * parser.find('*:*')                   // Tm tt c\n     * parser.find('one-template:*')        // Ch tm one-template\n     * parser.find('one-template:profile')  // Tm chnh xc profile\n     */\n    find(pattern = '*:*', options = {}) {\n        const { useCache = true } = options;\n\n        const comments = this.getAllComments(useCache);\n        const parsed = comments.map(c => this.parseComment(c)).filter(p => p !== null);\n\n        const pairs = [];\n        const stack = [];\n\n        for (let i = 0; i < parsed.length; i++) {\n            const current = parsed[i];\n\n            // Kim tra xem c khp vi pattern khng\n            if (!this.matchPattern(current.fullName, pattern)) {\n                continue;\n            }\n\n            if (current.type === 'open') {\n                // y tag m vo stack\n                stack.push({\n                    ...current,\n                    index: i\n                });\n            } else if (current.type === 'close') {\n                // Tm tag m tng ng t stack\n                let foundIndex = -1;\n                for (let j = stack.length - 1; j >= 0; j--) {\n                    if (stack[j].fullName === current.fullName) {\n                        foundIndex = j;\n                        break;\n                    }\n                }\n\n                if (foundIndex !== -1) {\n                    const openTag = stack[foundIndex];\n\n                    // Ly cc nodes nm gia\n                    const nodesBetween = this.getNodesBetween(openTag.node, current.node);\n\n                    // Ch thm vo nu cng parent\n                    if (nodesBetween !== null) {\n                        pairs.push({\n                            fullName: current.fullName,\n                            openTag: openTag.node,\n                            closeTag: current.node,\n                            attributes: openTag.attributes,\n                            nodes: nodesBetween,\n                            parent: openTag.node.parentNode\n                        });\n                    }\n\n                    // Xa khi stack\n                    stack.splice(foundIndex, 1);\n                }\n            }\n        }\n\n        return pairs;\n    }\n\n    /**\n     * Tm mt cp tag duy nht theo pattern\n     * @param {string} pattern - Pattern  tm\n     * @returns {Object|null} - Cp tag tm c hoc null\n     */\n    findOne(pattern) {\n        const pairs = this.find(pattern);\n        return pairs.length > 0 ? pairs[0] : null;\n    }\n\n    /**\n     * Lc cc cp tags theo iu kin ty chnh\n     * @param {Function} filterFn - Hm filter (pair) => boolean\n     * @param {string} pattern - Pattern ban u\n     * @returns {Array<Object>}\n     */\n    filter(filterFn, pattern = '*:*') {\n        const pairs = this.find(pattern);\n        return pairs.filter(filterFn);\n    }\n\n    /**\n     * m s lng cp tags theo pattern\n     * @param {string} pattern - Pattern  m\n     * @returns {number}\n     */\n    count(pattern = '*:*') {\n        return this.find(pattern).length;\n    }\n\n    /**\n     * Ly danh sch tt c cc tn tags duy nht\n     * @param {string} pattern - Pattern  lc\n     * @returns {Array<string>}\n     */\n    getUniqueNames(pattern = '*:*') {\n        const pairs = this.find(pattern);\n        return [...new Set(pairs.map(p => p.fullName))];\n    }\n\n    /**\n     * Hin th kt qu tm kim trong console\n     * @param {Array<Object>|string} pairsOrPattern - Mng pairs hoc pattern string\n     * @param {Object} options - Ty chn hin th\n     */\n    display(pairsOrPattern, options = {}) {\n        const {\n            showAttributes = true,\n            showParent = true,\n            showNodes = true,\n            maxNodePreview = 3\n        } = options;\n\n        let pairs, patternInfo = '';\n\n        // Nu truyn vo l string, tm kim trc\n        if (typeof pairsOrPattern === 'string') {\n            patternInfo = ` vi pattern \"${pairsOrPattern}\"`;\n            pairs = this.find(pairsOrPattern);\n        } else {\n            pairs = pairsOrPattern;\n        }\n\n        console.log(`\\n${'='.repeat(80)}`);\n        console.log(`Tm thy ${pairs.length} cp tags${patternInfo}`);\n        console.log(`${'='.repeat(80)}\\n`);\n\n        if (pairs.length === 0) {\n            console.log(' Khng tm thy cp tags no!');\n            return;\n        }\n\n        pairs.forEach((pair, index) => {\n            console.log(`\\n Cp ${index + 1}: [${pair.fullName}]`);\n            console.log('-'.repeat(60));\n\n            if (showAttributes) {\n                console.log(' Attributes:',\n                    Object.keys(pair.attributes).length > 0\n                        ? pair.attributes\n                        : '(khng c)'\n                );\n            }\n\n            if (showParent) {\n                console.log(' Parent:', pair.parent.tagName.toLowerCase(),\n                    pair.parent.className ? `class=\"${pair.parent.className}\"` : ''\n                );\n            }\n\n            if (showNodes) {\n                console.log(` Ni dung (${pair.nodes.length} nodes):`);\n\n                const previewNodes = pair.nodes.slice(0, maxNodePreview);\n                previewNodes.forEach(node => {\n                    if (node.nodeType === Node.ELEMENT_NODE) {\n                        const className = node.className ? ` class=\"${node.className}\"` : '';\n                        console.log(`    <${node.tagName.toLowerCase()}${className}>`);\n                    } else if (node.nodeType === Node.TEXT_NODE && node.nodeValue.trim()) {\n                        const text = node.nodeValue.trim().substring(0, 50);\n                        console.log(`    Text: \"${text}${text.length >= 50 ? '...' : ''}\"`);\n                    }\n                });\n\n                if (pair.nodes.length > maxNodePreview) {\n                    console.log(`    ... v ${pair.nodes.length - maxNodePreview} nodes khc`);\n                }\n            }\n        });\n\n        console.log(`\\n${'='.repeat(80)}\\n`);\n    }\n\n    /**\n     * Xa cache  buc parse li\n     */\n    clearCache() {\n        this.cachedComments = null;\n        return this;\n    }\n}","import { __defineProp, __hasOwnProp } from '../helpers/utils.js';\nimport { TemplateDetectorService } from './services/TemplateDetectorService.js';\n\nexport class OneMarkupModel {\n    constructor(fullName, openTag, closeTag, attributes = {}, nodes = []) {\n        /**\n         * @type {Element|Comment}\n         */\n        this.__openTag = openTag;\n        /**\n         * @type {Element|Comment}\n         */\n        this.__closeTag = closeTag;\n        this.__attributes = attributes;\n        /**\n         * @type {Array<Element|Comment>}\n         */\n        this.__nodes = nodes;\n        this.__definedAttributes = [];\n        this.__tagName = fullName.split(':')[1];\n        this.__fullName = fullName;\n        this.__defineAttributes(Object.keys(attributes));\n    }\n    __update(fullName, openTag, closeTag, attributes = {}, nodes = []) {\n        this.__openTag = openTag;\n        this.__closeTag = closeTag;\n        this.__attributes = attributes;\n        this.__nodes = nodes;\n        this.__tagName = fullName.split(':')[1];\n        this.__fullName = fullName;\n        this.__defineAttributes(Object.keys(attributes));\n        return this;\n    }\n    __defineAttributes(attributeKeys = []) {\n        for (let i = 0; i < attributeKeys.length; i++) {\n            const key = attributeKeys[i];\n            this.__defineAttribute(key);\n        }\n        return this;\n    }\n    __defineAttribute(name) {\n        if (this.__definedAttributes.includes(name)) {\n            return this;\n        }\n        this.__definedAttributes.push(name);\n        __defineProp(this, name, {\n            set: (value) => {\n                this.__attributes[name] = value;\n                return value;\n            },\n            get: () => {\n                return this.__attributes[name];\n            }\n        });\n        return this;\n    }\n    get tagName() {\n        return this.__tagName;\n    }\n    set tagName(name) {\n        // this.__tagName = name;\n        return this;\n    }\n    get fullName() {\n        return this.__fullName;\n    }\n    set fullName(name) {\n        // this.__fullName = name;\n        return this;\n    }\n    get openTag() {\n        return this.__openTag;\n    }\n    get closeTag() {\n        return this.__closeTag;\n    }\n    get attributes() {\n        return this.__attributes;\n    }\n    /**\n     * Get the nodes of the markup element\n     * @returns {Array<Element|Comment>} - The nodes of the markup element\n     */\n    get nodes() {\n        return this.__nodes;\n    }\n    getAttribute(name) {\n        return this.__attributes[name];\n    }\n    setAttribute(name, value) {\n        this.__defineAttribute(name);\n        this.__attributes[name] = value;\n        return this;\n    }\n    __match(attributes = {}) {\n        let keys = Object.keys(attributes);\n        for (let i = 0; i < keys.length; i++) {\n            const key = keys[i];\n            const value = attributes[key];\n            if (key === 'tagName') {\n                if (this.__tagName !== value) {\n                    return false;\n                }\n                continue;\n            }\n            else if (key === 'openTag') {\n                if (this.__openTag !== value) {\n                    return false;\n                }\n                continue;\n            }\n            else if (key === 'closeTag') {\n                if (this.__closeTag !== value) {\n                    return false;\n                }\n                continue;\n            }\n            else if (key === 'attributes') {\n                continue;\n            }\n            else if (key === 'nodes') {\n                continue;\n            }\n            else if (this.__attributes[key] !== value) {\n                return false;\n            }\n        }\n        return true;\n    }\n    __scan() {\n        const nodes = [];\n        let currentNode = this.__openTag.nextSibling;\n        while (currentNode && currentNode !== this.__closeTag) {\n            nodes.push(currentNode);\n            currentNode = currentNode.nextSibling;\n        }\n        this.__nodes.length = 0;\n        this.__nodes.push(...nodes);\n        return this.__nodes;\n    }\n    updateNodes(nodes = []) {\n        this.__nodes = nodes;\n        return this;\n    }\n}\n\nexport class OneMarkupCollection {\n    constructor(elements = []) {\n        this.__models = elements.map(element => (element instanceof OneMarkupModel) ? element : new OneMarkupModel(element.fullName, element.openTag, element.closeTag, element.attributes, element.nodes));\n    }\n    get models() {\n        return this.__models;\n    }\n    get length() {\n        return this.__models.length;\n    }\n\n    /**\n     * Get the first model in the collection\n     * @returns {OneMarkupModel} - The first model in the collection\n     */\n    get first() {\n        return this.__models[0];\n    }\n    /**\n     * Get the last model in the collection\n     */\n    get last() {\n        return this.__models[this.__models.length - 1];\n    }\n    push(model) {\n        if (!(model instanceof OneMarkupModel)) {\n            model = new OneMarkupModel(model.fullName, model.openTag, model.closeTag, model.attributes, model.nodes);\n        }\n        this.__models.push(model);\n        return this;\n    }\n    pop() {\n        return this.__models.pop();\n    }\n    shift() {\n        return this.__models.shift();\n    }\n    unshift(model) {\n        if (!(model instanceof OneMarkupModel)) {\n            model = new OneMarkupModel(model.fullName, model.openTag, model.closeTag, model.attributes, model.nodes);\n        }\n        this.__models.unshift(model);\n        return this;\n    }\n    splice(start, deleteCount, ...items) {\n        if (!(items instanceof OneMarkupCollection)) {\n            items = new OneMarkupCollection(items);\n        }\n        this.__models.splice(start, deleteCount, ...items.__models);\n        return this;\n    }\n    slice(start, end) {\n        return this.__models.slice(start, end);\n    }\n    concat(models) {\n        if (!(models instanceof OneMarkupCollection)) {\n            models = new OneMarkupCollection(models);\n        }\n        return new OneMarkupCollection(this.__models.concat(models.__models));\n    }\n    reverse() {\n        return new OneMarkupCollection(this.__models.reverse());\n    }\n\n    /**\n     * Get the model at the given index\n     * @param {number} index - The index of the model to get\n     * @returns {OneMarkupModel} - The model at the given index\n     */\n    get(index) {\n        return this.__models[index];\n    }\n    /**\n     * Set the model at the given index\n     * @param {number} index - The index of the model to set\n     * @param {OneMarkupModel} model - The model to set at the given index\n     * @returns {OneMarkupCollection} - The collection\n     */\n    set(index, model) {\n        this.__models[index] = model;\n        return this;\n    }\n\n    /**\n     * Map the collection to a new array\n     * @param {function} callback - The callback function to map the collection\n     * @returns {Array} - The new array\n     */\n    map(callback) {\n        return this.__models.map(callback);\n    }\n    /**\n     * Filter the collection to a new array\n     * @param {function} callback - The callback function to filter the collection\n     * @returns {Array} - The new array\n     */\n    filter(callback) {\n        return this.__models.filter(callback);\n    }\n    /**\n     * Reduce the collection to a single value\n     * @param {function} callback - The callback function to reduce the collection\n     * @param {any} initialValue - The initial value to reduce the collection\n     * @returns {any} - The reduced value\n     */\n    reduce(callback, initialValue) {\n        return this.__models.reduce(callback, initialValue);\n    }\n    /**\n     * For each the collection\n     * @param {function} callback - The callback function to for each the collection\n     * @returns {OneMarkupCollection} - The collection\n     */\n    forEach(callback) {\n        return this.__models.forEach(callback);\n    }\n    /**\n     * Some the collection\n     * @param {function} callback - The callback function to some the collection\n     * @returns {boolean} - True if some of the collection matches the callback, false otherwise\n     */\n    some(callback) {\n        return this.__models.some(callback);\n    }\n    /**\n     * Every the collection\n     * @param {function} callback - The callback function to every the collection\n     * @returns {boolean} - True if every of the collection matches the callback, false otherwise\n     */\n    every(callback) {\n        return this.__models.every(callback);\n    }\n    /**\n     * Query the collection\n     * @param {object} attributes - The attributes to query the collection\n     * @returns {Array} - The filtered array\n     */\n    query(attributes = {}) {\n        return this.__models.filter(model => model.__match(attributes));\n    }\n    find(attributes = {}) {\n        return this.query(attributes)[0] || null;\n    }\n}\n\nexport class OneMarkupService {\n    constructor() {\n        /**\n         * @type {TemplateDetectorService}\n         */\n        this.detector = new TemplateDetectorService(document.documentElement);\n    }\n\n    /**\n     * Find the first element that matches the pattern and attributes\n     * @param {string} pattern - The pattern to find\n     * @param {object} attributes - The attributes to find\n     * @param {object} options - The options to find\n     * @param {number} total - The total to find\n     * @returns {OneMarkupModel|OneMarkupCollection} - The first element that matches the pattern and attributes\n     */\n    find(pattern = '*', attributes = {}, options = {}, total = false) {\n        if (!__hasOwnProp(this, 'useCache')) {\n            options.useCache = false;\n        }\n        const elements = this.detector.find(\"one:\" + pattern, options);\n        const isTotal = total && typeof total === 'number' && total > 0;\n        const isLast = total && total === -1;\n        const isFirst = total && total === 1;\n        if (elements.length === 0) {\n            if (isLast) {\n                return null;\n            }\n            else if (isTotal && total == 1) {\n                return null;\n            }\n            return new OneMarkupCollection([]);\n        }\n        if (typeof attributes !== 'object' || attributes === null || Object.keys(attributes).length === 0) {\n            if (isLast) {\n                const lastElement = elements[elements.length - 1];\n                return new OneMarkupModel(lastElement.fullName, lastElement.openTag, lastElement.closeTag, lastElement.attributes, lastElement.nodes);\n            }\n            else if (isTotal) {\n                if (total == 1) {\n                    return new OneMarkupModel(elements[0].fullName, elements[0].openTag, elements[0].closeTag, elements[0].attributes, elements[0].nodes);\n                }\n                return new OneMarkupCollection(elements.slice(0, total));\n            }\n            return new OneMarkupCollection(elements);\n        }\n        const keys = Object.keys(attributes);\n        const result = [];\n        const elementCount = elements.length;\n        const lastIndex = elementCount - 1;\n        for (let i = 0; i < elementCount; i++) {\n            if(isLast && i < lastIndex) {\n                continue;\n            }\n            const element = elements[i];\n            let isMatch = true;\n            for (let j = 0; j < keys.length; j++) {\n                const key = keys[j];\n                const value = attributes[key];\n                if (element.attributes[key] !== value) {\n                    isMatch = false;\n                    break;\n                }\n            }\n            if (!isMatch) {\n                continue;\n            }\n            if (isFirst) {\n                return new OneMarkupModel(element.fullName, element.openTag, element.closeTag, element.attributes, element.nodes);\n            }\n            if(isLast && i === lastIndex) {\n                return new OneMarkupModel(element.fullName, element.openTag, element.closeTag, element.attributes, element.nodes);\n            }\n            result.push(element);\n            if (isTotal && result.length >= total) {\n                return new OneMarkupCollection(result);\n            }\n        }\n        return new OneMarkupCollection(result);\n    }\n\n    first(pattern = '*', attributes = {}, options = {}) {\n        return this.find(pattern, attributes, options, 1);\n    }\n}\n\nexport const OneMarkup = new OneMarkupService();\nexport default OneMarkup;","const basePrefix = 'data-';\nconst ATTR = {\n    PREFIX: {\n        BASE: basePrefix,\n        YIELD: `${basePrefix}yield-`,\n        \n\n        // DOM EVENTS - Mouse Events\n        CLICK: `${basePrefix}click-`,\n        DBLCLICK: `${basePrefix}dblclick-`,\n        MOUSEDOWN: `${basePrefix}mousedown-`,\n        MOUSEUP: `${basePrefix}mouseup-`,\n        MOUSEOVER: `${basePrefix}mouseover-`,\n        MOUSEOUT: `${basePrefix}mouseout-`,\n        MOUSEMOVE: `${basePrefix}mousemove-`,\n        MOUSEENTER: `${basePrefix}mouseenter-`,\n        MOUSELEAVE: `${basePrefix}mouseleave-`,\n        WHEEL: `${basePrefix}wheel-`,\n        AUXCLICK: `${basePrefix}auxclick-`,\n\n        // Keyboard Events\n        KEYDOWN: `${basePrefix}keydown-`,\n        KEYUP: `${basePrefix}keyup-`,\n        KEYPRESS: `${basePrefix}keypress-`,\n\n        // Form Events\n        INPUT: `${basePrefix}input-`,\n        CHANGE: `${basePrefix}change-`,\n        SUBMIT: `${basePrefix}submit-`,\n        RESET: `${basePrefix}reset-`,\n        INVALID: `${basePrefix}invalid-`,\n        SEARCH: `${basePrefix}search-`,\n\n        // Focus Events\n        FOCUS: `${basePrefix}focus-`,\n        BLUR: `${basePrefix}blur-`,\n        FOCUSIN: `${basePrefix}focusin-`,\n        FOCUSOUT: `${basePrefix}focusout-`,\n\n        // Selection Events\n        SELECT: `${basePrefix}select-`,\n        SELECTSTART: `${basePrefix}selectstart-`,\n        SELECTIONCHANGE: `${basePrefix}selectionchange-`,\n\n        // Touch Events\n        TOUCHSTART: `${basePrefix}touchstart-`,\n        TOUCHMOVE: `${basePrefix}touchmove-`,\n        TOUCHEND: `${basePrefix}touchend-`,\n        TOUCHCANCEL: `${basePrefix}touchcancel-`,\n\n        // Drag & Drop Events\n        DRAGSTART: `${basePrefix}dragstart-`,\n        DRAG: `${basePrefix}drag-`,\n        DRAGEND: `${basePrefix}dragend-`,\n        DRAGENTER: `${basePrefix}dragenter-`,\n        DRAGLEAVE: `${basePrefix}dragleave-`,\n        DRAGOVER: `${basePrefix}dragover-`,\n        DROP: `${basePrefix}drop-`,\n\n        // Media Events\n        PLAY: `${basePrefix}play-`,\n        PAUSE: `${basePrefix}pause-`,\n        ENDED: `${basePrefix}ended-`,\n        LOADSTART: `${basePrefix}loadstart-`,\n        LOADEDDATA: `${basePrefix}loadeddata-`,\n        LOADEDMETADATA: `${basePrefix}loadedmetadata-`,\n        CANPLAY: `${basePrefix}canplay-`,\n        CANPLAYTHROUGH: `${basePrefix}canplaythrough-`,\n        WAITING: `${basePrefix}waiting-`,\n        SEEKING: `${basePrefix}seeking-`,\n        SEEKED: `${basePrefix}seeked-`,\n        RATECHANGE: `${basePrefix}ratechange-`,\n        DURATIONCHANGE: `${basePrefix}durationchange-`,\n        VOLUMECHANGE: `${basePrefix}volumechange-`,\n        SUSPEND: `${basePrefix}suspend-`,\n        STALLED: `${basePrefix}stalled-`,\n        PROGRESS: `${basePrefix}progress-`,\n        EMPTIED: `${basePrefix}emptied-`,\n        ENCRYPTED: `${basePrefix}encrypted-`,\n        WAKEUP: `${basePrefix}wakeup-`,\n\n        // Window Events\n        LOAD: `${basePrefix}load-`,\n        UNLOAD: `${basePrefix}unload-`,\n        BEFOREUNLOAD: `${basePrefix}beforeunload-`,\n        RESIZE: `${basePrefix}resize-`,\n        SCROLL: `${basePrefix}scroll-`,\n        ORIENTATIONCHANGE: `${basePrefix}orientationchange-`,\n        VISIBILITYCHANGE: `${basePrefix}visibilitychange-`,\n        PAGEHIDE: `${basePrefix}pagehide-`,\n        PAGESHOW: `${basePrefix}pageshow-`,\n        POPSTATE: `${basePrefix}popstate-`,\n        HASHCHANGE: `${basePrefix}hashchange-`,\n        ONLINE: `${basePrefix}online-`,\n        OFFLINE: `${basePrefix}offline-`,\n\n        // Document Events\n        DOMCONTENTLOADED: `${basePrefix}DOMContentLoaded-`,\n        READYSTATECHANGE: `${basePrefix}readystatechange-`,\n\n        // Error Events\n        ERROR: `${basePrefix}error-`,\n        ABORT: `${basePrefix}abort-`,\n\n        // Context Menu\n        CONTEXTMENU: `${basePrefix}contextmenu-`,\n\n        // Animation Events\n        ANIMATIONSTART: `${basePrefix}animationstart-`,\n        ANIMATIONEND: `${basePrefix}animationend-`,\n        ANIMATIONITERATION: `${basePrefix}animationiteration-`,\n\n        // Transition Events\n        TRANSITIONSTART: `${basePrefix}transitionstart-`,\n        TRANSITIONEND: `${basePrefix}transitionend-`,\n        TRANSITIONRUN: `${basePrefix}transitionrun-`,\n        TRANSITIONCANCEL: `${basePrefix}transitioncancel-`,\n\n        // Pointer Events (Modern browsers)\n        POINTERDOWN: `${basePrefix}pointerdown-`,\n        POINTERUP: `${basePrefix}pointerup-`,\n        POINTERMOVE: `${basePrefix}pointermove-`,\n        POINTEROVER: `${basePrefix}pointerover-`,\n        POINTEROUT: `${basePrefix}pointerout-`,\n        POINTERENTER: `${basePrefix}pointerenter-`,\n        POINTERLEAVE: `${basePrefix}pointerleave-`,\n        POINTERCANCEL: `${basePrefix}pointercancel-`,\n        GOTPOINTERCAPTURE: `${basePrefix}gotpointercapture-`,\n        LOSTPOINTERCAPTURE: `${basePrefix}lostpointercapture-`,\n\n        // Fullscreen Events\n        FULLSCREENCHANGE: `${basePrefix}fullscreenchange-`,\n        FULLSCREENERROR: `${basePrefix}fullscreenerror-`,\n\n        // Clipboard Events\n        COPY: `${basePrefix}copy-`,\n        CUT: `${basePrefix}cut-`,\n        PASTE: `${basePrefix}paste-`,\n\n        // Gamepad Events\n        GAMEPADCONNECTED: `${basePrefix}gamepadconnected-`,\n        GAMEPADDISCONNECTED: `${basePrefix}gamepaddisconnected-`,\n\n        // Battery Events\n        BATTERYCHARGINGCHANGE: `${basePrefix}batterychargingchange-`,\n        BATTERYLEVELCHANGE: `${basePrefix}batterylevelchange-`,\n\n        // Device Orientation Events\n        DEVICEORIENTATION: `${basePrefix}deviceorientation-`,\n        DEVICEMOTION: `${basePrefix}devicemotion-`,\n        DEVICELIGHT: `${basePrefix}devicelight-`,\n        DEVICEPROXIMITY: `${basePrefix}deviceproximity-`,\n\n        // WebGL Events\n        WEBGLCONTEXTLOST: `${basePrefix}webglcontextlost-`,\n        WEBGLCONTEXTRESTORED: `${basePrefix}webglcontextrestored-`,\n\n\n        // view\n        VIEW: `${basePrefix}view-`,\n    },\n    KEYS: {\n        VIEW: `${basePrefix}view`,\n        VIEW_ID: `${basePrefix}view-id`,\n        VIEW_REF: `${basePrefix}view-ref`,\n        VIEW_SECTION_REF: `${basePrefix}view-section-ref`,\n        VIEW_RESOURCE: `${basePrefix}view-resource`,\n        VIEW_STYLE: `${basePrefix}view-style`,\n        VIEW_WRAPPER: `${basePrefix}view-wrapper`,\n        // yield\n        YIELD_ATTR: `${basePrefix}yield-attr`,\n        YIELD_CONTENT: `${basePrefix}yield-content`,\n        YIELD_CHILDREN: `${basePrefix}yield-children`,\n        YIELD_SUBSCRIBE: `${basePrefix}yield-subscribe`,\n        YIELD_SUBSCRIBE_ATTR: `${basePrefix}yield-subscribe-attr`,\n        YIELD_SUBSCRIBE_CONTENT: `${basePrefix}yield-subscribe-content`,\n        YIELD_SUBSCRIBE_CHILDREN: `${basePrefix}yield-subscribe-children`,\n    },\n    CLASSNAME: {\n        BASE: basePrefix,\n        VIEW_ERROR: `${basePrefix}view-error`,\n        VIRTUAL_CONTAINER: `${basePrefix}virtual-container`,\n        SECTION_ERROR: `${basePrefix}section-error`,\n    },\n    prefix: (key) => ATTR.PREFIX[key.toUpperCase()] || basePrefix + key,\n    key: (key) => ATTR.KEYS[key.toUpperCase()] || basePrefix + key,\n    className: (key) => ATTR.CLASSNAME[key.toUpperCase()] || basePrefix + key.toLowerCase().replace(/_/g, '-'),\n\n}\n\nexport const FORBIDDEN_KEYS = [\n    'init',\n    'destroy',\n    'beforeInit',\n    'afterInit',\n    'beforeDestroy',\n    'destroyed',\n    'loadServerData',\n    'render',\n    'prerender',\n    'insertResources',\n    'removeResources',\n    'setMaster',\n    'setApp',\n    'addChild',\n    'removeChild',\n    'remove',\n    'setParent',\n    'parent',\n    'master',\n    'beforeCreate',\n    'created',\n    'beforeUpdate',\n    'updated',\n    'beforeMount',\n    'mounted',\n    'beforeUnmount',\n    'unmounted',\n    'renderLongSections',\n    'renderSections',\n    'prerenderSections',\n    'data',\n    'scope',\n    'subscribe',\n    'updateVariableItem',\n    'updateVariableData',\n];\n\nexport { ATTR };","export class OneDOM {\n    static validateElement(element) {\n        if (!(element instanceof Element || element instanceof Comment)) {\n            throw new Error('Provided value is not a valid DOM Element');\n        }\n        return true;\n    }\n    /**\n     * Convert various input types to a safe DocumentFragment\n     * Supports: string, Element, NodeList, Array<Element|string>\n     */\n    static toFragment(content) {\n        const fragment = document.createDocumentFragment();\n\n        const appendItem = (item) => {\n            if (!item) return;\n            if (typeof item === 'string') {\n                const template = document.createElement('template');\n                template.innerHTML = item.trim();\n                fragment.appendChild(template.content);\n            } else if (item instanceof Element || item instanceof DocumentFragment) {\n                fragment.appendChild(item);\n            } else if (Array.isArray(item) || item instanceof NodeList) {\n                item.forEach(appendItem);\n            } else {\n                console.warn('Unsupported content type:', item);\n            }\n        };\n\n        appendItem(content);\n        return fragment;\n    }\n\n    /**\n     * Chn ni dung trc i tng tham chiu trong DOM\n     * @param {Element|Comment} target i tng dng  tham chiu\n     * @param {*} content ni dung thm vo\n     */\n    static before(target, content) {\n        if (!(target instanceof Element || target instanceof Comment)) throw new Error('Target must be a DOM element');\n        target.parentNode.insertBefore(this.toFragment(content), target);\n    }\n\n    /**\n     * Chn ni dung sau i tng tham chiu trong DOM\n     * @param {Element|Comment} target i tng dng  tham chiu\n     * @param {*} content ni dung thm vo\n     */\n    static after(target, content) {\n        if (!(target instanceof Element || target instanceof Comment)) throw new Error('Target must be a DOM element');\n        const frag = this.toFragment(content);\n        if (target.nextSibling) target.parentNode.insertBefore(frag, target.nextSibling);\n        else target.parentNode.appendChild(frag);\n    }\n\n    /**\n     * Thay th i tng tham chiu trong DOM bng ni dung mi\n     * @param {Element|Comment} target i tng dng  tham chiu\n     * @param {*} content ni dung thay th\n     */\n    static replace(target, content) {\n        if (!(target instanceof Element || target instanceof Comment)) throw new Error('Target must be a DOM element');\n        target.replaceWith(this.toFragment(content));\n    }\n\n    /**\n     * Thm ni dung vo cui phn t tham chiu trong DOM\n     * @param {Element} target phn t dng  tham chiu\n     * @param {*} content ni dung thm vo\n     */\n    static append(target, content) {\n        if (!(target instanceof Element)) throw new Error('Target must be a DOM element');\n        target.appendChild(this.toFragment(content));\n    }\n\n    /**\n     * Thm ni dung vo u phn t tham chiu trong DOM\n     * @param {Element} target phn t dng  tham chiu\n     * @param {*} content ni dung thm vo\n     */\n    static prepend(target, content) {\n        if (!(target instanceof Element)) throw new Error('Target must be a DOM element');\n        if (!target.firstChild) {\n            target.appendChild(this.toFragment(content));\n            return;\n        }\n        target.insertBefore(this.toFragment(content), target.firstChild);\n    }\n    /**\n     * Thit lp ni dung HTML cho phn t tham chiu trong DOM\n     * @param {Element} target phn t dng  tham chiu\n     * @param {*} content ni dung thit lp\n     */\n    static setHTML(target, content) {\n        if (!(target instanceof Element)) throw new Error('Target must be a DOM element');\n        target.innerHTML = '';\n        target.appendChild(this.toFragment(content));\n    }\n\n    /**\n     * Thay th ton b ni dung ca phn t tham chiu trong DOM\n     * @param {Element} target phn t dng  tham chiu\n     * @param {*} content ni dung thay th\n     */\n    static replaceContent(target, content) {\n        if (!(target instanceof Element)) throw new Error('Target must be a DOM element');\n        target.innerHTML = '';\n        target.appendChild(this.toFragment(content));\n    }\n\n    static content(target, content) {\n        if (content === undefined) {\n            // Ly ni dung\n            if (!(target instanceof Element)) throw new Error('Target must be a DOM element');\n            return target.innerHTML;\n        } else {\n            // Thit lp ni dung\n            this.setHTML(target, content);\n        }\n    }\n\n    static children(target, children = null) {\n        if (!(target instanceof Element)) throw new Error('Target must be a DOM element');\n        if (children === null || children === undefined) {\n            return Array.from(target.children);\n        } else {\n            target.innerHTML = '';\n            target.appendChild(this.toFragment(children));\n        }\n    }\n}\n\nexport default OneDOM;"],"names":["HttpService","constructor","this","baseUrl","timeout","defaultHeaders","setBaseUrl","url","setTimeout","setDefaultHeaders","headers","setHeader","name","value","request","method","data","options","fullUrl","startsWith","config","toUpperCase","body","JSON","stringify","controller","AbortController","timeoutId","abort","response","fetch","signal","clearTimeout","responseData","json","catch","status","ok","statusCode","error","Error","get","post","put","patch","level","enabled","console","remote","setConfig","getConfig","consoleLog","args","apply","log","warn","info","debug","SEOTagConfig","tag","selector","attribute","attrs","ViewTemplates","WebTestViewtypeComponent","WebTestWrapper","WebTestViewtype","WebAwait","WebUserDetail","WebTestViewtypeLayout","WebAbout","WebSimpleHome","WebUsers","WebFetch","WebTestViewtypeTemplate","WebTestSubscribeState","WebTestAbout","WebTestPrerender","WebHome","WebContact","WebTestFetch","WebTest","AdminDashboard","LayoutsTestLayout","LayoutsBase","LayoutsBaseWithViewId","LayoutsAdmin","PartialsTestPartial","PartialsFooter","PartialsDataExample","CustomTestSetup","CustomTest","BaseHtmlDocument","TestTestUpdatestatebykey","TestTestSubscribeNewApproach","TestCompilerTest","TestTestSimpleUsestate","TestTestSubscribeArrayState","TestTestOnyieldFixed","TestTestUpdatestatebykey2","TemplatesGaJs","TemplatesSimple","TemplatesTest","StorageService","static","dynamicProperties","key","__key","__isSupport","__data","__listeners","Map","__eventQueue","__isUpdating","encryptionKey","useEncryption","__loadData","getInstance","instance","setKey","trim","getKey","support","enableEncryption","enable","__generateEncryptionKey","set","ttl","success","Object","keys","forEach","k","v","oldValue","dataItem","timestamp","Date","now","__updateData","__createDynamicProperty","emit","defaultValue","__isExpired","remove","length","__removeDynamicProperty","clear","oldData","getAll","__cleanExpiredData","result","entries","has","getAllKeys","size","isEmpty","getInfo","expiredRemoved","isSupport","events","getEvents","totalListeners","Array","from","values","reduce","sum","listeners","isUpdating","hasEncryptionKey","isExpired","remaining","Math","max","getTTLInfo","hasTTL","expiryTime","cleanExpired","import","jsonString","parse","newData","backup","restore","getStorageUsage","localStorage","getItem","Blob","isStorageFull","testKey","testValue","repeat","setItem","removeItem","on","event","callback","push","off","index","indexOf","splice","removeAllListeners","delete","getListenerCount","array","Uint8Array","crypto","getRandomValues","byte","toString","padStart","join","__encrypt","encrypted","i","charCode","charCodeAt","String","fromCharCode","btoa","__decrypt","decoded","atob","decrypted","removed","keysToRemove","decryptedData","jsonData","encryptedData","privateProperties","includes","defineProperty","configurable","filter","SSRViewData","viewData","instances","indexMap","parseViewData","maxIndex","instancesMap","next","prev","getById","id","scan","SSRViewDataCollection","views","setViews","View","App","markupService","OneMarkup","storageService","container","stateChangeListeners","currentMasterView","Engine","ViewEngine","State","templates","_sections","_changedSections","_stacks","scanMode","_once","vitualContainer","document","createElement","setAttribute","style","display","VIEW_MOUNTED_QUEUE","CURRENT_SUPER_VIEW","CURRENT_SUPER_VIEW_PATH","CURRENT_SUPER_VIEW_MOUNTED","CURRENT_VIEW","CURRENT_VIEW_PATH","CURRENT_VIEW_MOUNTED","SUPER_VIEW_STACK","ALL_VIEW_STACK","PAGE_VIEW","renderTimes","cachedViews","serverRenderData","viewMap","cachedPageData","wrapperConfig","ssrData","ssrViewManager","cachedPageView","cachedTimes","SEO","tags","updateItem","items","item","element","querySelector","head","appendChild","textContent","setApp","app","setContainer","init","_currentScope","getView","loadView","urlPath","clearOldRendering","message","hasCache","cacheKey","replace","cachedData","view","html","superView","isSuperView","needInsert","oldCacheData","path","superViewPath","ultraView","renderIndex","hasSuperView","unshift","renderView","setIsSuperView","render","scanView","route","__SSR_VIEW_ID__","viewId","$urlPath","__scan","scanRenderedView","isScanned","superViewData","nestedSuperViewData","virtualRender","mountAllViewsFromStack","then","mountView","viewName","params","currentSuperView","unmounted","viewResult","OneDOM","setHTML","emitChangedSections","mounted","mountViewScan","scanResult","_isHydrated","mountContent","htmlContent","cb","generateViewId","execute","fn","undefined","evaluate","escString","text","setSuperViewPath","addViewEngine","viewEngine","callViewEngineMounted","viewEngineId","mountAllViewsBottomUp","Promise","resolve","checkInterval","setInterval","clearInterval","queue","beforeMount","superViews","templateToDom","template","templator","innerHTML","content","firstChild","include","includeIf","exists","extendView","superViewName","registerSubscribe","attr","yieldKey","defaultContent","output","subscribeAttr","yieldContent","toLowerCase","KEYS","YIELD_CONTENT","YIELD_CHILDREN","YIELD_ATTR","renderOrScanView","variableData","mode","renderMethod","prerenderMethod","hasAwaitData","hasFetchData","updateVariableData","isPrerender","hasPrerender","API","getURIDAta","addToQueue","cache","reset","scope","viewWrapper","currentRenderTime","oldRenderTime","oldViews","isArray","unmountView","cachedKeys","slice","clearOrphanedEventData","beforeUnmount","removeEvents","destroy","resetView","section","type","oldContent","yield","renderSections","hasSection","getChangedSections","resetChangedSections","isChangedSection","escapedName","querySelectorAll","subscribeKey","getAttribute","subscribeTarget","sectionContent","yieldAttr","split","pair","paths","attrName","shift","sectionName","loadServerData","stack","once","hash","_hashContent","isAuth","guard","can","permission","model","hasError","field","firstError","csrfToken","foreach","Router","getURL","Helper","str","char","regex","RegExp","isHtmlString","test","substr","start","substring","strtolower","strtoupper","formatDate","date","format","d","isNaN","getTime","year","getFullYear","month","getMonth","day","getDate","hours","getHours","minutes","getMinutes","seconds","getSeconds","formatNumber","num","decimals","thousandsSeparator","decimalSeparator","prefix","suffix","parts","toFixed","formatCurrency","amount","currency","truncate","randomString","charAt","floor","chars","random","deepClone","obj","map","cloned","debounce","func","wait","throttle","limit","inThrottle","getSEOTagConfig","title","description","keywords","ogTitle","property","ogDescription","ogImage","updateSEOItem","attrKey","attrValue","updateTitle","updateDescription","updateKeywords","updateOGTitle","updateOGDescription","updateOGImage","image","getUrlParams","window","location","href","URL","searchParams","buildUrl","isInViewport","rect","getBoundingClientRect","top","left","bottom","innerHeight","documentElement","clientHeight","right","innerWidth","clientWidth","scrollTo","target","behavior","block","inline","offset","targetPosition","offsetTop","copyToClipboard","navigator","clipboard","writeText","downloadFile","filename","mimeType","blob","createObjectURL","link","download","click","removeChild","revokeObjectURL","getDeviceType","width","count","isNull","isString","isNumeric","parseFloat","isFinite","toISOString","today","env","ucfirst","lcfirst","str_replace","search","subject","s","r","explode","delimiter","implode","glue","pieces","in_array","needle","haystack","array_unique","arr","Set","array_merge","arrays","concat","is_array","is_string","is_numeric","empty","isset","json_encode","json_decode","isMobile","isTablet","isDesktop","FollowingBlock","engine","stateKeys","renderBlock","renderID","states","isRendered","openTag","closeTag","refElements","subscribes","isMounted","markup","stateKey","unsubscribe","__subscribe","renew","placeholder","rerender","onFollowUpdating","parentNode","before","e","onFollowUpdated","nodes","first","node","_emptyFn","parent","children","superViewId","originalViewPath","originalViewId","originalView","usesVars","hasSections","renderLongSections","hasSectionPreload","sections","addCSS","removeCSS","resources","userDefined","eventHandlers","isInitlized","follow","attributes","templateEngine","wrapTag","followingBlocks","followingConfig","followingIndex","followingScanIndex","followingIDs","followingPrerenderIDs","followingRenderIDs","subscribeStates","childrenConfig","childrenIndex","refreshChildrenIndex","isRendering","isDestroyed","isReady","eventListenerStatus","eventListeners","eventQuickHandles","isVirtualRendering","cachedSections","renderedContent","__scope","isRefreshing","changeStateQueueCount","changedStateKeys","_stateChangePending","loopContext","isCommitedConstructorData","setup","initialize","ViewState","master","processDefinedProperties","commitConstructorData","definedProps","definedMethods","__props__","prop","bind","writable","enumerable","setScope","_serverData","_data","hasData","addEventConfig","eventType","handlers","eventID","addEventStack","renderFollowIDStart","addXRefViewToRootElements","prerender","virtualPrerender","replaceView","htmlString","frag","oldElements","oldElement","newElement","childNodes","replaceChild","beforeCreate","call","created","beforeUpdate","updated","beforeInit","afterInit","beforeDestroy","destroyed","startEventListener","onSuperViewMounted","child","onParentMounted","beforeUnmounted","stopEventListener","onSuperViewUnmounted","onParentUnmounted","refresh","renderPlaceholder","className","VIEW_ID","showError","VIEW_SECTION_REF","showErrorScan","resetOriginalView","ejectOriginalView","insertResources","resource","uuid","removeResources","__showError","__section","__yield","__yieldContent","__include","parentData","viewInstance","setParent","addChild","__includeif","__includewhen","condition","__extends","originData","setSuperView","setOriginalView","__setLoopContext","LoopContext","setCount","__resetLoopContext","freeze","__foreach","list","__setupLoopContext","setType","setCurrentTimes","following","__scanDOMElements","__attachEventHandlers","__setupFollowingBlocks","__storeChildrenReferences","elements","VIEW_WRAPPER","el","nodeType","Node","ELEMENT_NODE","followConfig","__rerenderFollowBlock","followId","followBlock","__sectionScan","__includeScan","childParams","childConfig","childData","__includeifScan","__includewhenScan","__extendsScan","superViewConfig","superViewOfChildren","find","__showErrorScan","__foreachScan","__execute","subscribeScan","subscribe","__subscribeScan","__text","__textScan","addEventStackScan","addEventConfigScan","__addEventConfig","__addEventConfigScan","__addEventQuickHandle","addEventQuickHandle","__addEventQuickHandleScan","addEventQuickHandleScan","setEventConfig","eventObjectList","handler","setEventConfigScan","needDeleted","eventMap","parsedHandlers","parseEventHandlerFunctions","returnValue","handlerFn","defaultPrevented","preventDefault","stopPropagation","addEventListener","removeEventListener","handlerObj","handlerName","parseEventHandlerParams","param","parseEventHandlerObject","object","parsedObject","wrapattr","startWrapper","endWrapper","addBlock","addBlockScan","__block","__blockScan","useBlock","useBlockScan","mountBlock","subscribeBlock","renderFollowingBlock","renderFollowingBlockScan","every","__follow","__followScan","onStateChange","add","_processStateChanges","changedKeys","_notifyStateChanges","some","childScope","onStateDataChanges","stateChangeData","setUrlPath","c","updateData","updateVariableItem","updateVariableItemData","http","endpoints","APP_CONFIGS","api","getViewData","uri","getSystemConfig","getSystemData","endpoint","system","pathname","ActiveRoute","query","fragment","$route","$params","$query","$fragment","$paramKeys","getPath","getUrlPath","getParams","getParam","getQuery","getFragment","routes","currentRoute","base","_beforeEach","_afterEach","defaultRoute","handleRoute","handlePopState","routeConfigs","currentUri","addRouteConfig","routeConfig","setAllRoutes","generateUrl","addRoute","normalizePath","setMode","setBase","setDefaultRoute","beforeEach","afterEach","normalized","endsWith","matchFormat","regexStr","hasParameter","isAnyParameter","getParameterName","match","exec","getParameterValue","getAnyParameterValue","valueMatch","checkParameterRoute","routePathParts","urlPathParts","lastRoutePathIndex","routePathPart","urlPathPart","paramValue","any","paramName","matchRoute","normalizedPath","routePath","part","ignoreSetActiveRoute","pathForMatching","URLParts","getUrlParts","addActiveRoute","component","getActiveRoute","hydrateViews","activeRoute","navigate","history","pushState","extension","navigateTo","skipInitial","isServerRendered","detectServerRendered","initialPath","setActiveRouteForCurrentPath","setupAutoNavigation","stop","_autoNavHandler","handleAutoNavigation","oneNavElement","closest","hasAttribute","navPath","dataset","nav","linkUrl","currentUrl","host","protocol","fromEntries","URLSearchParams","containers","getCachedRoute","getCurrentRoute","getCurrentPath","getCurrentUri","getCurrentHash","getCurrentUrl","getCurrentQuery","getCurrentFragment","_viewRef","_states","_stateIndex","_canUpdateStateByKey","__ownProperties","__ownMethods","__unsubscribe","__commitStateChange","_stateMap","__setState","setValue","__useState","__updateStateByKey","findIndex","state","__register","__lockUpdateRealState","__reset","__toJSON","toJSON","TemplateDetectorService","rootElement","cachedComments","setRootElement","getAllComments","useCache","comments","walker","createTreeWalker","NodeFilter","SHOW_COMMENT","nextNode","parseComment","commentNode","nodeValue","openMatch","fullName","attrMatch","closeMatch","getNodesBetween","startNode","endNode","current","nextSibling","patternToRegex","pattern","matchPattern","parsed","p","pairs","foundIndex","j","nodesBetween","findOne","filterFn","getUniqueNames","pairsOrPattern","showAttributes","showParent","showNodes","maxNodePreview","patternInfo","tagName","TEXT_NODE","clearCache","OneMarkupModel","__openTag","__closeTag","__attributes","__nodes","__definedAttributes","__tagName","__fullName","__defineAttributes","__update","attributeKeys","__defineAttribute","__match","currentNode","updateNodes","OneMarkupCollection","__models","models","last","pop","deleteCount","end","reverse","initialValue","detector","total","isTotal","isLast","isFirst","lastElement","elementCount","lastIndex","isMatch","basePrefix","ATTR","PREFIX","BASE","YIELD","CLICK","DBLCLICK","MOUSEDOWN","MOUSEUP","MOUSEOVER","MOUSEOUT","MOUSEMOVE","MOUSEENTER","MOUSELEAVE","WHEEL","AUXCLICK","KEYDOWN","KEYUP","KEYPRESS","INPUT","CHANGE","SUBMIT","RESET","INVALID","SEARCH","FOCUS","BLUR","FOCUSIN","FOCUSOUT","SELECT","SELECTSTART","SELECTIONCHANGE","TOUCHSTART","TOUCHMOVE","TOUCHEND","TOUCHCANCEL","DRAGSTART","DRAG","DRAGEND","DRAGENTER","DRAGLEAVE","DRAGOVER","DROP","PLAY","PAUSE","ENDED","LOADSTART","LOADEDDATA","LOADEDMETADATA","CANPLAY","CANPLAYTHROUGH","WAITING","SEEKING","SEEKED","RATECHANGE","DURATIONCHANGE","VOLUMECHANGE","SUSPEND","STALLED","PROGRESS","EMPTIED","ENCRYPTED","WAKEUP","LOAD","UNLOAD","BEFOREUNLOAD","RESIZE","SCROLL","ORIENTATIONCHANGE","VISIBILITYCHANGE","PAGEHIDE","PAGESHOW","POPSTATE","HASHCHANGE","ONLINE","OFFLINE","DOMCONTENTLOADED","READYSTATECHANGE","ERROR","ABORT","CONTEXTMENU","ANIMATIONSTART","ANIMATIONEND","ANIMATIONITERATION","TRANSITIONSTART","TRANSITIONEND","TRANSITIONRUN","TRANSITIONCANCEL","POINTERDOWN","POINTERUP","POINTERMOVE","POINTEROVER","POINTEROUT","POINTERENTER","POINTERLEAVE","POINTERCANCEL","GOTPOINTERCAPTURE","LOSTPOINTERCAPTURE","FULLSCREENCHANGE","FULLSCREENERROR","COPY","CUT","PASTE","GAMEPADCONNECTED","GAMEPADDISCONNECTED","BATTERYCHARGINGCHANGE","BATTERYLEVELCHANGE","DEVICEORIENTATION","DEVICEMOTION","DEVICELIGHT","DEVICEPROXIMITY","WEBGLCONTEXTLOST","WEBGLCONTEXTRESTORED","VIEW","VIEW_REF","VIEW_RESOURCE","VIEW_STYLE","YIELD_SUBSCRIBE","YIELD_SUBSCRIBE_ATTR","YIELD_SUBSCRIBE_CONTENT","YIELD_SUBSCRIBE_CHILDREN","CLASSNAME","VIEW_ERROR","VIRTUAL_CONTAINER","SECTION_ERROR","FORBIDDEN_KEYS","validateElement","Element","Comment","toFragment","createDocumentFragment","appendItem","DocumentFragment","NodeList","insertBefore","after","replaceWith","append","prepend","replaceContent"],"sourceRoot":""}